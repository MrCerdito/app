import{r as le,j as Jt}from"./vendor-react-0kkXrzjt.js";var Pi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function If(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Sd(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Ls={exports:{}},Ms={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nl;function Ad(){return nl||(nl=1,function(e){function t(Y,ee){var oe=Y.length;Y.push(ee);e:for(;0<oe;){var de=oe-1>>>1,xe=Y[de];if(0<i(xe,ee))Y[de]=ee,Y[oe]=xe,oe=de;else break e}}function r(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var ee=Y[0],oe=Y.pop();if(oe!==ee){Y[0]=oe;e:for(var de=0,xe=Y.length,Ge=xe>>>1;de<Ge;){var C=2*(de+1)-1,N=Y[C],O=C+1,P=Y[O];if(0>i(N,oe))O<xe&&0>i(P,N)?(Y[de]=P,Y[O]=oe,de=O):(Y[de]=N,Y[C]=oe,de=C);else if(O<xe&&0>i(P,oe))Y[de]=P,Y[O]=oe,de=O;else break e}}return ee}function i(Y,ee){var oe=Y.sortIndex-ee.sortIndex;return oe!==0?oe:Y.id-ee.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],f=1,u=null,h=3,d=!1,m=!1,p=!1,g=!1,S=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function k(Y){for(var ee=r(c);ee!==null;){if(ee.callback===null)n(c);else if(ee.startTime<=Y)n(c),ee.sortIndex=ee.expirationTime,t(l,ee);else break;ee=r(c)}}function b(Y){if(p=!1,k(Y),!m)if(r(l)!==null)m=!0,W||(W=!0,z());else{var ee=r(c);ee!==null&&he(b,ee.startTime-Y)}}var W=!1,F=-1,I=5,R=-1;function V(){return g?!0:!(e.unstable_now()-R<I)}function H(){if(g=!1,W){var Y=e.unstable_now();R=Y;var ee=!0;try{e:{m=!1,p&&(p=!1,A(F),F=-1),d=!0;var oe=h;try{t:{for(k(Y),u=r(l);u!==null&&!(u.expirationTime>Y&&V());){var de=u.callback;if(typeof de=="function"){u.callback=null,h=u.priorityLevel;var xe=de(u.expirationTime<=Y);if(Y=e.unstable_now(),typeof xe=="function"){u.callback=xe,k(Y),ee=!0;break t}u===r(l)&&n(l),k(Y)}else n(l);u=r(l)}if(u!==null)ee=!0;else{var Ge=r(c);Ge!==null&&he(b,Ge.startTime-Y),ee=!1}}break e}finally{u=null,h=oe,d=!1}ee=void 0}}finally{ee?z():W=!1}}}var z;if(typeof T=="function")z=function(){T(H)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,_e=te.port2;te.port1.onmessage=H,z=function(){_e.postMessage(null)}}else z=function(){S(H,0)};function he(Y,ee){F=S(function(){Y(e.unstable_now())},ee)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(Y){switch(h){case 1:case 2:case 3:var ee=3;break;default:ee=h}var oe=h;h=ee;try{return Y()}finally{h=oe}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(Y,ee){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var oe=h;h=Y;try{return ee()}finally{h=oe}},e.unstable_scheduleCallback=function(Y,ee,oe){var de=e.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?de+oe:de):oe=de,Y){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=oe+xe,Y={id:f++,callback:ee,priorityLevel:Y,startTime:oe,expirationTime:xe,sortIndex:-1},oe>de?(Y.sortIndex=oe,t(c,Y),r(l)===null&&Y===r(c)&&(p?(A(F),F=-1):p=!0,he(b,oe-de))):(Y.sortIndex=xe,t(l,Y),m||d||(m=!0,W||(W=!0,z()))),Y},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(Y){var ee=h;return function(){var oe=h;h=ee;try{return Y.apply(this,arguments)}finally{h=oe}}}}(Ms)),Ms}var il;function s4(){return il||(il=1,Ls.exports=Ad()),Ls.exports}const Cd="modulepreload",Fd=function(e){return"/"+e},sl={},gn=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){let a=function(c){return Promise.all(c.map(f=>Promise.resolve(f).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=a(r.map(c=>{if(c=Fd(c),c in sl)return;sl[c]=!0;const f=c.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=f?"stylesheet":Cd,f||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),f)return new Promise((d,m)=>{h.addEventListener("load",d),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},kd=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>gn(async()=>{const{default:n}=await Promise.resolve().then(()=>wn);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Va extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Pd extends Va{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Od extends Va{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class bd extends Va{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var fa;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(fa||(fa={}));var Rd=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{c(n.next(f))}catch(u){a(u)}}function l(f){try{c(n.throw(f))}catch(u){a(u)}}function c(f){f.done?s(f.value):i(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class Dd{constructor(t,{headers:r={},customFetch:n,region:i=fa.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=kd(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Rd(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=r;let o={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const f=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:c}).catch(m=>{throw new Pd(m)}),u=f.headers.get("x-relay-error");if(u&&u==="true")throw new Od(f);if(!f.ok)throw new bd(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),d;return h==="application/json"?d=yield f.json():h==="application/octet-stream"?d=yield f.blob():h==="text/event-stream"?d=f:h==="multipart/form-data"?d=yield f.formData():d=yield f.text(),{data:d,error:null}}catch(i){return{data:null,error:i}}})}}var Ke={},Gr={},Kr={},zr={},Xr={},qr={},Id=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},vn=Id();const Ld=vn.fetch,Lf=vn.fetch.bind(vn),Mf=vn.Headers,Md=vn.Request,Nd=vn.Response,wn=Object.freeze(Object.defineProperty({__proto__:null,Headers:Mf,Request:Md,Response:Nd,default:Lf,fetch:Ld},Symbol.toStringTag,{value:"Module"})),Bd=Sd(wn);var Oi={},al;function Nf(){if(al)return Oi;al=1,Object.defineProperty(Oi,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Oi.default=e,Oi}var ol;function Bf(){if(ol)return qr;ol=1;var e=qr&&qr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(qr,"__esModule",{value:!0});const t=e(Bd),r=e(Nf());class n{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,a){return this.headers=Object.assign({},this.headers),this.headers[s]=a,this}then(s,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var f,u,h;let d=null,m=null,p=null,g=c.status,S=c.statusText;if(c.ok){if(this.method!=="HEAD"){const b=await c.text();b===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=b:m=JSON.parse(b))}const T=(f=this.headers.Prefer)===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),k=(u=c.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");T&&k&&k.length>1&&(p=parseInt(k[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(d={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,p=null,g=406,S="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const T=await c.text();try{d=JSON.parse(T),Array.isArray(d)&&c.status===404&&(m=[],d=null,g=200,S="OK")}catch{c.status===404&&T===""?(g=204,S="No Content"):d={message:T}}if(d&&this.isMaybeSingle&&(!((h=d==null?void 0:d.details)===null||h===void 0)&&h.includes("0 rows"))&&(d=null,g=200,S="OK"),d&&this.shouldThrowOnError)throw new r.default(d)}return{error:d,data:m,count:p,status:g,statusText:S}});return this.shouldThrowOnError||(l=l.catch(c=>{var f,u,h;return{error:{message:`${(f=c==null?void 0:c.name)!==null&&f!==void 0?f:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(u=c==null?void 0:c.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(h=c==null?void 0:c.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,a)}returns(){return this}overrideTypes(){return this}}return qr.default=n,qr}var ll;function Uf(){if(ll)return Xr;ll=1;var e=Xr&&Xr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Xr,"__esModule",{value:!0});const t=e(Bf());class r extends t.default{select(i){let s=!1;const a=(i??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(i,{ascending:s=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",f=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${f?`${f},`:""}${i}.${s?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:s,referencedTable:a=s}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${i}`),this}range(i,s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this.url.searchParams.set(c,`${s-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:i=!1,verbose:s=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var f;const u=[i?"analyze":null,s?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),h=(f=this.headers.Accept)!==null&&f!==void 0?f:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${h}"; options=${u};`,c==="json"?this:this}rollback(){var i;return((i=this.headers.Prefer)!==null&&i!==void 0?i:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Xr.default=r,Xr}var cl;function $a(){if(cl)return zr;cl=1;var e=zr&&zr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(zr,"__esModule",{value:!0});const t=e(Uf());class r extends t.default{eq(i,s){return this.url.searchParams.append(i,`eq.${s}`),this}neq(i,s){return this.url.searchParams.append(i,`neq.${s}`),this}gt(i,s){return this.url.searchParams.append(i,`gt.${s}`),this}gte(i,s){return this.url.searchParams.append(i,`gte.${s}`),this}lt(i,s){return this.url.searchParams.append(i,`lt.${s}`),this}lte(i,s){return this.url.searchParams.append(i,`lte.${s}`),this}like(i,s){return this.url.searchParams.append(i,`like.${s}`),this}likeAllOf(i,s){return this.url.searchParams.append(i,`like(all).{${s.join(",")}}`),this}likeAnyOf(i,s){return this.url.searchParams.append(i,`like(any).{${s.join(",")}}`),this}ilike(i,s){return this.url.searchParams.append(i,`ilike.${s}`),this}ilikeAllOf(i,s){return this.url.searchParams.append(i,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(i,s){return this.url.searchParams.append(i,`ilike(any).{${s.join(",")}}`),this}is(i,s){return this.url.searchParams.append(i,`is.${s}`),this}in(i,s){const a=Array.from(new Set(s)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(i,`in.(${a})`),this}contains(i,s){return typeof s=="string"?this.url.searchParams.append(i,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(i,`cs.{${s.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(s)}`),this}containedBy(i,s){return typeof s=="string"?this.url.searchParams.append(i,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(i,`cd.{${s.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(s)}`),this}rangeGt(i,s){return this.url.searchParams.append(i,`sr.${s}`),this}rangeGte(i,s){return this.url.searchParams.append(i,`nxl.${s}`),this}rangeLt(i,s){return this.url.searchParams.append(i,`sl.${s}`),this}rangeLte(i,s){return this.url.searchParams.append(i,`nxr.${s}`),this}rangeAdjacent(i,s){return this.url.searchParams.append(i,`adj.${s}`),this}overlaps(i,s){return typeof s=="string"?this.url.searchParams.append(i,`ov.${s}`):this.url.searchParams.append(i,`ov.{${s.join(",")}}`),this}textSearch(i,s,{config:a,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const c=a===void 0?"":`(${a})`;return this.url.searchParams.append(i,`${l}fts${c}.${s}`),this}match(i){return Object.entries(i).forEach(([s,a])=>{this.url.searchParams.append(s,`eq.${a}`)}),this}not(i,s,a){return this.url.searchParams.append(i,`not.${s}.${a}`),this}or(i,{foreignTable:s,referencedTable:a=s}={}){const o=a?`${a}.or`:"or";return this.url.searchParams.append(o,`(${i})`),this}filter(i,s,a){return this.url.searchParams.append(i,`${s}.${a}`),this}}return zr.default=r,zr}var fl;function jf(){if(fl)return Kr;fl=1;var e=Kr&&Kr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Kr,"__esModule",{value:!0});const t=e($a());class r{constructor(i,{headers:s={},schema:a,fetch:o}){this.url=i,this.headers=s,this.schema=a,this.fetch=o}select(i,{head:s=!1,count:a}={}){const o=s?"HEAD":"GET";let l=!1;const c=(i??"*").split("").map(f=>/\s/.test(f)&&!l?"":(f==='"'&&(l=!l),f)).join("");return this.url.searchParams.set("select",c),a&&(this.headers.Prefer=`count=${a}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(i,{count:s,defaultToNull:a=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(i)){const c=i.reduce((f,u)=>f.concat(Object.keys(u)),[]);if(c.length>0){const f=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",f.join(","))}}return new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}upsert(i,{onConflict:s,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){const c="POST",f=[`resolution=${a?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&f.push(this.headers.Prefer),o&&f.push(`count=${o}`),l||f.push("missing=default"),this.headers.Prefer=f.join(","),Array.isArray(i)){const u=i.reduce((h,d)=>h.concat(Object.keys(d)),[]);if(u.length>0){const h=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}update(i,{count:s}={}){const a="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),this.headers.Prefer=o.join(","),new t.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}delete({count:i}={}){const s="DELETE",a=[];return i&&a.push(`count=${i}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new t.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Kr.default=r,Kr}var Rn={},Dn={},ul;function Ud(){return ul||(ul=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.version=void 0,Dn.version="0.0.0-automated"),Dn}var hl;function jd(){if(hl)return Rn;hl=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.DEFAULT_HEADERS=void 0;const e=Ud();return Rn.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${e.version}`},Rn}var dl;function Vd(){if(dl)return Gr;dl=1;var e=Gr&&Gr.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Gr,"__esModule",{value:!0});const t=e(jf()),r=e($a()),n=jd();class i{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new t.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new i(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:f}={}){let u;const h=new URL(`${this.url}/rpc/${a}`);let d;l||c?(u=l?"HEAD":"GET",Object.entries(o).filter(([p,g])=>g!==void 0).map(([p,g])=>[p,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([p,g])=>{h.searchParams.append(p,g)})):(u="POST",d=o);const m=Object.assign({},this.headers);return f&&(m.Prefer=`count=${f}`),new r.default({method:u,url:h,headers:m,schema:this.schemaName,body:d,fetch:this.fetch,allowEmpty:!1})}}return Gr.default=i,Gr}var pl;function $d(){if(pl)return Ke;pl=1;var e=Ke&&Ke.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.PostgrestError=Ke.PostgrestBuilder=Ke.PostgrestTransformBuilder=Ke.PostgrestFilterBuilder=Ke.PostgrestQueryBuilder=Ke.PostgrestClient=void 0;const t=e(Vd());Ke.PostgrestClient=t.default;const r=e(jf());Ke.PostgrestQueryBuilder=r.default;const n=e($a());Ke.PostgrestFilterBuilder=n.default;const i=e(Uf());Ke.PostgrestTransformBuilder=i.default;const s=e(Bf());Ke.PostgrestBuilder=s.default;const a=e(Nf());return Ke.PostgrestError=a.default,Ke.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:s.default,PostgrestError:a.default},Ke}var Wd=$d();const Hd=If(Wd),{PostgrestClient:Gd,PostgrestQueryBuilder:a4,PostgrestFilterBuilder:o4,PostgrestTransformBuilder:l4,PostgrestBuilder:c4,PostgrestError:f4}=Hd,Kd="2.11.2",zd={"X-Client-Info":`realtime-js/${Kd}`},Xd="1.0.0",Vf=1e4,qd=1e3;var un;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(un||(un={}));var _t;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(_t||(_t={}));var Lt;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Lt||(Lt={}));var ua;(function(e){e.websocket="websocket"})(ua||(ua={}));var Pr;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Pr||(Pr={}));class Yd{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(t.slice(a,a+i));a=a+i;const l=n.decode(t.slice(a,a+s));a=a+s;const c=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class $f{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Oe;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Oe||(Oe={}));const ml=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,a)=>(s[a]=Jd(a,e,t,i),s),{})},Jd=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,a=r[e];return s&&!n.includes(s)?Wf(s,a):ha(a)},Wf=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return t1(t,r)}switch(e){case Oe.bool:return Zd(t);case Oe.float4:case Oe.float8:case Oe.int2:case Oe.int4:case Oe.int8:case Oe.numeric:case Oe.oid:return Qd(t);case Oe.json:case Oe.jsonb:return e1(t);case Oe.timestamp:return r1(t);case Oe.abstime:case Oe.date:case Oe.daterange:case Oe.int4range:case Oe.int8range:case Oe.money:case Oe.reltime:case Oe.text:case Oe.time:case Oe.timestamptz:case Oe.timetz:case Oe.tsrange:case Oe.tstzrange:return ha(t);default:return ha(t)}},ha=e=>e,Zd=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Qd=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},e1=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},t1=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>Wf(t,o))}return e},r1=e=>typeof e=="string"?e.replace(" ","T"):e,Hf=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Ns{constructor(t,r,n={},i=Vf){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var gl;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(gl||(gl={}));class jn{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=jn.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=jn.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=jn.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(s,(c,f)=>{a[c]||(l[c]=f)}),this.map(a,(c,f)=>{const u=s[c];if(u){const h=f.map(g=>g.presence_ref),d=u.map(g=>g.presence_ref),m=f.filter(g=>d.indexOf(g.presence_ref)<0),p=u.filter(g=>h.indexOf(g.presence_ref)<0);m.length>0&&(o[c]=m),p.length>0&&(l[c]=p)}else o[c]=f}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var c;const f=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),f.length>0){const u=t[o].map(d=>d.presence_ref),h=f.filter(d=>u.indexOf(d.presence_ref)<0);t[o].unshift(...h)}n(o,f,l)}),this.map(a,(o,l)=>{let c=t[o];if(!c)return;const f=l.map(u=>u.presence_ref);c=c.filter(u=>f.indexOf(u.presence_ref)<0),t[o]=c,i(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var vl;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(vl||(vl={}));var xl;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(xl||(xl={}));var Yt;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Yt||(Yt={}));class Wa{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=_t.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ns(this,Lt.join,this.params,this.timeout),this.rejoinTimer=new $f(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=_t.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=_t.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Lt.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new jn(this),this.broadcastEndpointURL=Hf(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(f=>t==null?void 0:t(Yt.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(Yt.CLOSED));const l={},c={broadcast:s,presence:a,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var u;if(this.socket.setAuth(),f===void 0){t==null||t(Yt.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,d=(u=h==null?void 0:h.length)!==null&&u!==void 0?u:0,m=[];for(let p=0;p<d;p++){const g=h[p],{filter:{event:S,schema:A,table:T,filter:k}}=g,b=f&&f[p];if(b&&b.event===S&&b.schema===A&&b.table===T&&b.filter===k)m.push(Object.assign(Object.assign({},g),{id:b.id}));else{this.unsubscribe(),t==null||t(Yt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,t&&t(Yt.SUBSCRIBED);return}}).receive("error",f=>{t==null||t(Yt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Yt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=_t.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Lt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new Ns(this,Lt.leave,{},t);i.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Ns(this,t,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:f}=Lt;if(n&&[o,l,c,f].indexOf(a)>=0&&n!==this._joinRef())return;let h=this._onMessage(a,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(d=>{var m,p,g;return((m=d.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(p=d.filter)===null||p===void 0?void 0:p.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(d=>d.callback(h,n)):(s=this.bindings[a])===null||s===void 0||s.filter(d=>{var m,p,g,S,A,T;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in d){const k=d.id,b=(m=d.filter)===null||m===void 0?void 0:m.event;return k&&((p=r.ids)===null||p===void 0?void 0:p.includes(k))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const k=(A=(S=d==null?void 0:d.filter)===null||S===void 0?void 0:S.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return k==="*"||k===((T=r==null?void 0:r.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===a}).map(d=>{if(typeof h=="object"&&"ids"in h){const m=h.data,{schema:p,table:g,commit_timestamp:S,type:A,errors:T}=m;h=Object.assign(Object.assign({},{schema:p,table:g,commit_timestamp:S,eventType:A,new:{},old:{},errors:T}),this._getPayloadRecords(m))}d.callback(h,n)})}_isClosed(){return this.state===_t.closed}_isJoined(){return this.state===_t.joined}_isJoining(){return this.state===_t.joining}_isLeaving(){return this.state===_t.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Wa.isEqual(i.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Lt.close,{},t)}_onError(t){this._on(Lt.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=_t.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=ml(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=ml(t.columns,t.old_record)),r}}const n1=()=>{},i1=typeof WebSocket<"u",s1=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class a1{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=zd,this.params={},this.timeout=Vf,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=n1,this.conn=null,this.sendBuffer=[],this.serializer=new Yd,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>gn(async()=>{const{default:l}=await Promise.resolve().then(()=>wn);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${t}/${ua.websocket}`,this.httpEndpoint=Hf(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,a)=>a(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new $f(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(i1){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new o1(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),gn(async()=>{const{default:t}=await Promise.resolve().then(()=>n4);return{default:t}},void 0).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Xd}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case un.connecting:return Pr.Connecting;case un.open:return Pr.Open;case un.closing:return Pr.Closing;default:return Pr.Closed}}isConnected(){return this.connectionState()===Pr.Open}channel(t,r={config:{}}){const n=new Wa(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(i=>{r&&i.updateJoinPayload({access_token:r}),i.joinedOnce&&i._isJoined()&&i._push(Lt.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(qd,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:i,payload:s,ref:a}=r;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${a&&"("+a+")"||""}`,s),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Lt.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([s1],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class o1{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=un.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class Ha extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ze(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class l1 extends Ha{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class da extends Ha{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var c1=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{c(n.next(f))}catch(u){a(u)}}function l(f){try{c(n.throw(f))}catch(u){a(u)}}function c(f){f.done?s(f.value):i(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Gf=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>gn(async()=>{const{default:n}=await Promise.resolve().then(()=>wn);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},f1=()=>c1(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield gn(()=>Promise.resolve().then(()=>wn),void 0)).Response:Response}),pa=e=>{if(Array.isArray(e))return e.map(r=>pa(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=pa(n)}),t};var Br=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{c(n.next(f))}catch(u){a(u)}}function l(f){try{c(n.throw(f))}catch(u){a(u)}}function c(f){f.done?s(f.value):i(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Bs=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),u1=(e,t,r)=>Br(void 0,void 0,void 0,function*(){const n=yield f1();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{t(new l1(Bs(i),e.status||500))}).catch(i=>{t(new da(Bs(i),i))}):t(new da(Bs(e),e))}),h1=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),r))};function gi(e,t,r,n,i,s){return Br(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,h1(t,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>u1(l,o,n))})})}function Ji(e,t,r,n){return Br(this,void 0,void 0,function*(){return gi(e,"GET",t,r,n)})}function fr(e,t,r,n,i){return Br(this,void 0,void 0,function*(){return gi(e,"POST",t,n,i,r)})}function d1(e,t,r,n,i){return Br(this,void 0,void 0,function*(){return gi(e,"PUT",t,n,i,r)})}function p1(e,t,r,n){return Br(this,void 0,void 0,function*(){return gi(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Kf(e,t,r,n,i){return Br(this,void 0,void 0,function*(){return gi(e,"DELETE",t,n,i,r)})}var pt=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{c(n.next(f))}catch(u){a(u)}}function l(f){try{c(n.throw(f))}catch(u){a(u)}}function c(f){f.done?s(f.value):i(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const m1={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},_l={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class g1{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Gf(i)}uploadOrUpdate(t,r,n,i){return pt(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},_l),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const c=this._removeEmptyFolders(r),f=this._getFinalPath(c),u=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:t,body:s,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),h=yield u.json();return u.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(ze(s))return{data:null,error:s};throw s}})}upload(t,r,n){return pt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return pt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:_l.upsert},i),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType);const u=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:f}),h=yield u.json();return u.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(ze(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return pt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield fr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new Ha("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(ze(n))return{data:null,error:n};throw n}})}update(t,r,n){return pt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return pt(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(ze(i))return{data:null,error:i};throw i}})}copy(t,r,n){return pt(this,void 0,void 0,function*(){try{return{data:{path:(yield fr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(ze(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return pt(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield fr(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(ze(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return pt(this,void 0,void 0,function*(){try{const i=yield fr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(ze(i))return{data:null,error:i};throw i}})}download(t,r){return pt(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Ji(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(ze(o))return{data:null,error:o};throw o}})}info(t){return pt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Ji(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:pa(n),error:null}}catch(n){if(ze(n))return{data:null,error:n};throw n}})}exists(t){return pt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield p1(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ze(n)&&n instanceof da){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return pt(this,void 0,void 0,function*(){try{return{data:yield Kf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(ze(r))return{data:null,error:r};throw r}})}list(t,r,n){return pt(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},m1),r),{prefix:t||""});return{data:yield fr(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(ze(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const v1="2.7.1",x1={"X-Client-Info":`storage-js/${v1}`};var Yr=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{c(n.next(f))}catch(u){a(u)}}function l(f){try{c(n.throw(f))}catch(u){a(u)}}function c(f){f.done?s(f.value):i(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class _1{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},x1),r),this.fetch=Gf(n)}listBuckets(){return Yr(this,void 0,void 0,function*(){try{return{data:yield Ji(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(ze(t))return{data:null,error:t};throw t}})}getBucket(t){return Yr(this,void 0,void 0,function*(){try{return{data:yield Ji(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(ze(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Yr(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ze(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Yr(this,void 0,void 0,function*(){try{return{data:yield d1(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ze(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Yr(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(ze(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Yr(this,void 0,void 0,function*(){try{return{data:yield Kf(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(ze(r))return{data:null,error:r};throw r}})}}class y1 extends _1{constructor(t,r={},n){super(t,r,n)}from(t){return new g1(this.url,this.headers,t,this.fetch)}}const w1="2.49.4";let Mn="";typeof Deno<"u"?Mn="deno":typeof document<"u"?Mn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Mn="react-native":Mn="node";const T1={"X-Client-Info":`supabase-js-${Mn}/${w1}`},E1={headers:T1},S1={schema:"public"},A1={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},C1={};var F1=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{c(n.next(f))}catch(u){a(u)}}function l(f){try{c(n.throw(f))}catch(u){a(u)}}function c(f){f.done?s(f.value):i(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const k1=e=>{let t;return e?t=e:typeof fetch>"u"?t=Lf:t=fetch,(...r)=>t(...r)},P1=()=>typeof Headers>"u"?Mf:Headers,O1=(e,t,r)=>{const n=k1(r),i=P1();return(s,a)=>F1(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new i(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:c}))})};var b1=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{c(n.next(f))}catch(u){a(u)}}function l(f){try{c(n.throw(f))}catch(u){a(u)}}function c(f){f.done?s(f.value):i(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function R1(e){return e.replace(/\/$/,"")}function D1(e,t){const{db:r,auth:n,realtime:i,global:s}=e,{db:a,auth:o,realtime:l,global:c}=t,f={db:Object.assign(Object.assign({},a),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),s),accessToken:()=>b1(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}const zf="2.69.1",rn=30*1e3,ma=3,Us=ma*rn,I1="http://localhost:9999",L1="supabase.auth.token",M1={"X-Client-Info":`gotrue-js/${zf}`},ga="X-Supabase-Api-Version",Xf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},N1=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,B1=6e5;class Ga extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function me(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class U1 extends Ga{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function j1(e){return me(e)&&e.name==="AuthApiError"}class qf extends Ga{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class _r extends Ga{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class or extends _r{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function V1(e){return me(e)&&e.name==="AuthSessionMissingError"}class js extends _r{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bi extends _r{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ri extends _r{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $1(e){return me(e)&&e.name==="AuthImplicitGrantRedirectError"}class yl extends _r{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class va extends _r{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Vs(e){return me(e)&&e.name==="AuthRetryableFetchError"}class wl extends _r{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Vn extends _r{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Tl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),El=` 	
\r=`.split(""),W1=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<El.length;t+=1)e[El[t].charCodeAt(0)]=-2;for(let t=0;t<Tl.length;t+=1)e[Tl[t].charCodeAt(0)]=t;return e})();function Yf(e,t,r){const n=W1[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Sl(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{K1(a,n,r)};for(let a=0;a<e.length;a+=1)Yf(e.charCodeAt(a),i,s);return t.join("")}function H1(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function G1(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}H1(n,t)}}function K1(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function z1(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Yf(e.charCodeAt(i),r,n);return new Uint8Array(t)}function X1(e){const t=[];return G1(e,r=>t.push(r)),new Uint8Array(t)}function q1(e){return Math.round(Date.now()/1e3)+e}function Y1(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const jt=()=>typeof window<"u"&&typeof document<"u",Ar={tested:!1,writable:!1},$n=()=>{if(!jt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ar.tested)return Ar.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ar.tested=!0,Ar.writable=!0}catch{Ar.tested=!0,Ar.writable=!1}return Ar.writable};function J1(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Jf=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>gn(async()=>{const{default:n}=await Promise.resolve().then(()=>wn);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Z1=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Zf=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Di=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ii=async(e,t)=>{await e.removeItem(t)};class vs{constructor(){this.promise=new vs.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}vs.promiseConstructor=Promise;function $s(e){const t=e.split(".");if(t.length!==3)throw new Vn("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!N1.test(t[n]))throw new Vn("JWT not in base64url format");return{header:JSON.parse(Sl(t[0])),payload:JSON.parse(Sl(t[1])),signature:z1(t[2]),raw:{header:t[0],payload:t[1]}}}async function Q1(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function ep(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function tp(e){return("0"+e.toString(16)).substr(-2)}function rp(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,tp).join("")}async function np(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function ip(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await np(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Jr(e,t,r=!1){const n=rp();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Zf(e,`${t}-code-verifier`,i);const s=await ip(n);return[s,n===s?"plain":"s256"]}const sp=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ap(e){const t=e.headers.get(ga);if(!t||!t.match(sp))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function op(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function lp(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var cp=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const Fr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),fp=[502,503,504];async function Al(e){var t;if(!Z1(e))throw new va(Fr(e),0);if(fp.includes(e.status))throw new va(Fr(e),e.status);let r;try{r=await e.json()}catch(s){throw new qf(Fr(s),s)}let n;const i=ap(e);if(i&&i.getTime()>=Xf["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new wl(Fr(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new or}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new wl(Fr(r),e.status,r.weak_password.reasons);throw new U1(Fr(r),e.status||500,n)}const up=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function ve(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[ga]||(s[ga]=Xf["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await hp(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function hp(e,t,r,n,i,s){const a=up(t,n,i,s);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new va(Fr(l),0)}if(o.ok||await Al(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await Al(l)}}function lr(e){var t;let r=null;gp(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=q1(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Cl(e){const t=lr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ur(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function dp(e){return{data:e,error:null}}function pp(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=cp(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function mp(e){return e}function gp(e){return e.access_token&&e.refresh_token&&e.expires_in}var vp=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class xp{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Jf(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await ve(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(me(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await ve(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ur})}catch(n){if(me(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=vp(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await ve(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:pp,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(me(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ve(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ur})}catch(r){if(me(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},f=await ve(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:mp});if(f.error)throw f.error;const u=await f.json(),h=(a=f.headers.get("x-total-count"))!==null&&a!==void 0?a:0,d=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return d.length>0&&(d.forEach(m=>{const p=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=p}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},u),c),error:null}}catch(c){if(me(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await ve(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ur})}catch(r){if(me(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await ve(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ur})}catch(n){if(me(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await ve(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ur})}catch(n){if(me(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await ve(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(me(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await ve(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(me(r))return{data:null,error:r};throw r}}}const _p={getItem:e=>$n()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{$n()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{$n()&&globalThis.localStorage.removeItem(e)}};function Fl(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function yp(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Zr={debug:!!(globalThis&&$n()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Qf extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class wp extends Qf{}async function Tp(e,t,r){Zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Zr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new wp(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Zr.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}yp();const Ep={url:I1,storageKey:L1,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:M1,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function kl(e,t,r){return await r()}class ei{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ei.nextInstanceID,ei.nextInstanceID+=1,this.instanceID>0&&jt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Ep),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new xp({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Jf(i.fetch),this.lock=i.lock||kl,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:jt()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Tp:this.lock=kl,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:$n()?this.storage=_p:(this.memoryStorage={},this.storage=Fl(this.memoryStorage)):(this.memoryStorage={},this.storage=Fl(this.memoryStorage)),jt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${zf}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=J1(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),jt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),$1(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return me(r)?{error:r}:{error:new qf("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:lr}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(me(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:f,password:u,options:h}=t;let d=null,m=null;this.flowType==="pkce"&&([d,m]=await Jr(this.storage,this.storageKey)),s=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:u,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:d,code_challenge_method:m},xform:lr})}else if("phone"in t){const{phone:f,password:u,options:h}=t;s=await ve(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:u,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:lr})}else throw new bi("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(me(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:o}=t;r=await ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Cl})}else if("phone"in t){const{phone:s,password:a,options:o}=t;r=await ve(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Cl})}else throw new bi("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new js}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(me(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await Di(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await ve(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:lr});if(await Ii(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new js}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(me(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,o=await ve(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:lr}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new js}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(me(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let c=null,f=null;this.flowType==="pkce"&&([c,f]=await Jr(this.storage,this.storageKey));const{error:u}=await ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:f},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:f}=await ve(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f}}throw new bi("You must provide either an email or phone number.")}catch(o){if(me(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await ve(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:lr});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(me(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var r,n,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await Jr(this.storage,this.storageKey)),await ve(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:dp})}catch(s){if(me(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new or;const{error:i}=await ve(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(me(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await ve(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:o}=await ve(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new bi("You must provide either an email or phone number and a type")}catch(r){if(me(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Di(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Us:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,f)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,f))})}return{data:{session:t},error:null}}const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ur}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new or}:await ve(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:ur})})}catch(r){if(me(r))return V1(r)&&(await this._removeSession(),await Ii(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new or;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Jr(this.storage,this.storageKey));const{data:c,error:f}=await ve(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:ur});if(f)throw f;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(me(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new or;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=$s(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(me(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new or;const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(me(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!jt())throw new Ri("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Ri(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new yl("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ri("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new yl("No code detected.");const{data:A,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!a||!c)throw new Ri("No session defined in URL");const f=Math.round(Date.now()/1e3),u=parseInt(o);let h=f+u;l&&(h=parseInt(l));const d=h-f;d*1e3<=rn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${u}s`);const m=h-u;f-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,h,f):f-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,h,f);const{data:p,error:g}=await this._getUser(s);if(g)throw g;const S={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:u,expires_at:h,refresh_token:a,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:S,redirectType:t.type},error:null}}catch(n){if(me(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Di(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(j1(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Ii(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=Y1(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Jr(this.storage,this.storageKey,!0));try{return await ve(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(me(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(me(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,c,f;const{data:u,error:h}=s;if(h)throw h;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await ve(this.fetch,"GET",d,{headers:this.headers,jwt:(f=(c=u.session)===null||c===void 0?void 0:c.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return jt()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(me(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await ve(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(me(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await ep(async i=>(i>0&&await Q1(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await ve(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:lr})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Vs(s)&&Date.now()+a-n<rn})}catch(n){if(this._debug(r,"error",n),me(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),jt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Di(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Us;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Us}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),Vs(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new or;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new vs;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new or;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),me(s)){const a={session:null,error:s};return Vs(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Zf(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Ii(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&jt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),rn);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/rn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${rn}ms, refresh threshold is ${ma} ticks`),i<=ma&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Qf)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!jt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await Jr(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await ve(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(me(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await ve(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(me(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:a,error:o}=await ve(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(me(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await ve(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(me(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:i},error:s}=t;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=$s(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(u=>u.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const f=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(a=>a.kid===t);if(n||(n=this.jwks.keys.find(a=>a.kid===t),n&&this.jwks_cached_at+B1>Date.now()))return n;const{data:i,error:s}=await ve(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new Vn("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),n=i.keys.find(a=>a.kid===t),!n)throw new Vn("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:d,error:m}=await this.getSession();if(m||!d.session)return{data:null,error:m};n=d.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=$s(n);if(op(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:d}=await this.getUser(n);if(d)throw d;return{data:{claims:s,header:i,signature:a},error:null}}const c=lp(i.alg),f=await this.fetchJwk(i.kid,r),u=await crypto.subtle.importKey("jwk",f,c,!0,["verify"]);if(!await crypto.subtle.verify(c,u,a,X1(`${o}.${l}`)))throw new Vn("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(me(n))return{data:null,error:n};throw n}}}ei.nextInstanceID=0;const Sp=ei;class Ap extends Sp{constructor(t){super(t)}}var Cp=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(f){try{c(n.next(f))}catch(u){a(u)}}function l(f){try{c(n.throw(f))}catch(u){a(u)}}function c(f){f.done?s(f.value):i(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class Fp{constructor(t,r,n){var i,s,a;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=R1(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:S1,realtime:C1,auth:Object.assign(Object.assign({},A1),{storageKey:l}),global:E1},f=D1(n??{},c);this.storageKey=(i=f.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(u,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=O1(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new Gd(`${o}/rest/v1`,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new Dd(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new y1(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Cp(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:s,flowType:a,lock:o,debug:l},c,f){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ap({url:this.authUrl,headers:Object.assign(Object.assign({},u),c),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,flowType:a,lock:o,debug:l,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new a1(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const u4=(e,t,r)=>new Fp(e,t,r);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Zi={};Zi.version="0.18.5";var e0=1252,kp=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],t0=function(e){kp.indexOf(e)!=-1&&(e0=e)};function Pp(){t0(1252)}var ti=function(e){t0(e)};function Op(){ti(1200),Pp()}var Li=function(t){return String.fromCharCode(t)},Pl=function(t){return String.fromCharCode(t)},Ol,hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ri(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=hr.charAt(s)+hr.charAt(a)+hr.charAt(o)+hr.charAt(l);return t}function tr(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=hr.indexOf(e.charAt(c++)),a=hr.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=hr.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=hr.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Te=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),sr=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Lr(e){return Te?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function bl(e){return Te?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Mt=function(t){return Te?sr(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function xs(e){if(typeof ArrayBuffer>"u")return Mt(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function vi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function bp(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var et=Te?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:sr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Rp(e){for(var t=[],r=0,n=e.length+250,i=Lr(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Lr(65535),n=65530)}return t.push(i.slice(0,r)),et(t)}var Wn=/\u0000/g,Mi=/[\u0001-\u0006]/g;function hn(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Nt(e,t){var r=""+e;return r.length>=t?r:Be("0",t-r.length)+r}function Ka(e,t){var r=""+e;return r.length>=t?r:Be(" ",t-r.length)+r}function Qi(e,t){var r=""+e;return r.length>=t?r:r+Be(" ",t-r.length)}function Dp(e,t){var r=""+Math.round(e);return r.length>=t?r:Be("0",t-r.length)+r}function Ip(e,t){var r=""+e;return r.length>=t?r:Be("0",t-r.length)+r}var Rl=Math.pow(2,32);function Qr(e,t){if(e>Rl||e<-Rl)return Dp(e,t);var r=Math.round(e);return Ip(r,t)}function es(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Dl=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ws=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Lp(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ue={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Il={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Mp={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ts(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,f=0,u=Math.floor(i);c<t&&(u=Math.floor(i),o=u*a+s,f=u*c+l,!(i-u<5e-8));)i=1/(i-u),s=a,a=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=s):(f=c,o=a)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function Ni(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Wp(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var r0=new Date(1899,11,31,0,0,0),Np=r0.getTime(),Bp=new Date(1900,2,1,0,0,0);function n0(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Bp&&(r+=24*60*60*1e3),(r-(Np+(e.getTimezoneOffset()-r0.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function za(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Up(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jp(e){var t=e<0?12:11,r=za(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Vp(e){var t=za(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function $p(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=jp(e):t===10?r=e.toFixed(10).substr(0,12):r=Vp(e),za(Up(r.toUpperCase()))}function xa(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):$p(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return pr(14,n0(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Wp(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Hp(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Ws[r.m-1][1];case 5:return Ws[r.m-1][0];default:return Ws[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return Dl[r.q][0];default:return Dl[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Nt(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Nt(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Nt(l,c):"";return f}function dr(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var i0=/%/g;function Gp(e,t,r){var n=t.replace(i0,""),i=t.length-n.length;return Zt(e,n,r*Math.pow(10,2*i))+Be("%",i)}function Kp(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Zt(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function s0(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+s0(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var a0=/# (\?+)( ?)\/( ?)(\d+)/;function zp(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?Be(" ",e[1].length+1+e[4].length):Ka(a,e[1].length)+e[2]+"/"+e[3]+Nt(o,e[4].length))}function Xp(e,t,r){return r+(t===0?"":""+t)+Be(" ",e[1].length+2+e[4].length)}var o0=/^#*0*\.([0#]+)/,l0=/\).*[0#]/,c0=/\(###\) ###\\?-####/;function ft(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Ll(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ml(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function qp(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Yp(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ft(e,t,r){if(e.charCodeAt(0)===40&&!t.match(l0)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ft("n",n,r):"("+Ft("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Kp(e,t,r);if(t.indexOf("%")!==-1)return Gp(e,t,r);if(t.indexOf("E")!==-1)return s0(t,r);if(t.charCodeAt(0)===36)return"$"+Ft(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Qr(l,t.length);if(t.match(/^[#?]+$/))return i=Qr(r,0),i==="0"&&(i=""),i.length>t.length?i:ft(t.substr(0,t.length-i.length))+i;if(s=t.match(a0))return zp(s,l,c);if(t.match(/^#+0+$/))return c+Qr(l,t.length-t.indexOf("0"));if(s=t.match(o0))return i=Ll(r,s[1].length).replace(/^([^\.]+)$/,"$1."+ft(s[1])).replace(/\.$/,"."+ft(s[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+Be("0",ft(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Ll(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+dr(Qr(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ft(e,t,-r):dr(""+(Math.floor(r)+qp(r,s[1].length)))+"."+Nt(Ml(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ft(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=hn(Ft(e,t.replace(/[\\-]/g,""),r)),a=0,hn(hn(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(t.match(c0))return i=Ft(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ts(l,Math.pow(10,a)-1,!1),i=""+c,f=Zt("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Qi(o[2],a),f.length<s[4].length&&(f=ft(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ts(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ka(o[1],a)+s[2]+"/"+s[3]+Qi(o[2],a):Be(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Qr(r,0),t.length<=i.length?i:ft(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var u=t.indexOf(".")-a,h=t.length-i.length-u;return ft(t.substr(0,u)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=Ml(r,s[1].length),r<0?"-"+Ft(e,t,-r):dr(Yp(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Nt(0,3-m.length):"")+m})+"."+Nt(a,s[1].length);switch(t){case"###,##0.00":return Ft(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=dr(Qr(l,0));return d!=="0"?c+d:"";case"###,###.00":return Ft(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ft(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Jp(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Zt(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Zp(e,t,r){var n=t.replace(i0,""),i=t.length-n.length;return Zt(e,n,r*Math.pow(10,2*i))+Be("%",i)}function f0(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+f0(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Vt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(l0)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Vt("n",n,r):"("+Vt("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Jp(e,t,r);if(t.indexOf("%")!==-1)return Zp(e,t,r);if(t.indexOf("E")!==-1)return f0(t,r);if(t.charCodeAt(0)===36)return"$"+Vt(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Nt(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:ft(t.substr(0,t.length-i.length))+i;if(s=t.match(a0))return Xp(s,l,c);if(t.match(/^#+0+$/))return c+Nt(l,t.length-t.indexOf("0"));if(s=t.match(o0))return i=(""+r).replace(/^([^\.]+)$/,"$1."+ft(s[1])).replace(/\.$/,"."+ft(s[1])),i=i.replace(/\.(\d*)$/,function(m,p){return"."+p+Be("0",ft(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+dr(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Vt(e,t,-r):dr(""+r)+"."+Be("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Vt(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=hn(Vt(e,t.replace(/[\\-]/g,""),r)),a=0,hn(hn(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return a<i.length?i.charAt(a++):m==="0"?"0":""}));if(t.match(c0))return i=Vt(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=ts(l,Math.pow(10,a)-1,!1),i=""+c,f=Zt("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=Qi(o[2],a),f.length<s[4].length&&(f=ft(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=ts(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ka(o[1],a)+s[2]+"/"+s[3]+Qi(o[2],a):Be(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:ft(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var u=t.indexOf(".")-a,h=t.length-i.length-u;return ft(t.substr(0,u)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Vt(e,t,-r):dr(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Nt(0,3-m.length):"")+m})+"."+Nt(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=dr(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return Vt(e,t.slice(0,t.lastIndexOf(".")),r)+ft(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Zt(e,t,r){return(r|0)===r?Vt(e,t,r):Ft(e,t,r)}function Qp(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var u0=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function h0(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":es(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(u0))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function em(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,f,u,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!es(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(u=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(u);i[i.length]={t:"t",v:s},++a;break;case"\\":var d=e.charAt(++a),m=d==="("||d===")"?d:"t";i[i.length]={t:m,v:d},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=Ni(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Ni(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var p={t:o,v:o};if(c==null&&(c=Ni(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="/"?(c!=null&&(p.v=c.H>=12?"":""),p.t="T",a+=5,h="h"):(p.t="t",++a),c==null&&p.t==="T")return"";i[i.length]=p,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(u0)){if(c==null&&(c=Ni(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",h0(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var g=0,S=0,A;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=h,l="h",g<1&&(g=1);break;case"s":(A=i[a].v.match(/\.0+$/))&&(S=Math.max(S,A[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[a].v.match(/[Hh]/)&&(g=1),g<2&&i[a].v.match(/[Mm]/)&&(g=2),g<3&&i[a].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var T="",k;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=Hp(i[a].t.charCodeAt(0),i[a].v,c,S),i[a].t="t";break;case"n":case"?":for(k=a+1;i[k]!=null&&((o=i[k].t)==="?"||o==="D"||(o===" "||o==="t")&&i[k+1]!=null&&(i[k+1].t==="?"||i[k+1].t==="t"&&i[k+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[k].v==="/"||i[k].v===" "&&i[k+1]!=null&&i[k+1].t=="?"));)i[a].v+=i[k].v,i[k]={v:"",t:";"},++k;T+=i[a].v,a=k-1;break;case"G":i[a].t="t",i[a].v=xa(t,r);break}var b="",W,F;if(T.length>0){T.charCodeAt(0)==40?(W=t<0&&T.charCodeAt(0)===45?-t:t,F=Zt("n",T,W)):(W=t<0&&n>1?-t:t,F=Zt("n",T,W),W<0&&i[0]&&i[0].t=="t"&&(F=F.substr(1),i[0].v="-"+i[0].v)),k=F.length-1;var I=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){I=a;break}var R=i.length;if(I===i.length&&F.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(k>=i[a].v.length-1?(k-=i[a].v.length,i[a].v=F.substr(k+1,i[a].v.length)):k<0?i[a].v="":(i[a].v=F.substr(0,k+1),k=-1),i[a].t="t",R=a);k>=0&&R<i.length&&(i[R].v=F.substr(0,k+1)+i[R].v)}else if(I!==i.length&&F.indexOf("E")===-1){for(k=F.indexOf(".")-1,a=I;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===I?i[a].v.indexOf(".")-1:i[a].v.length-1,b=i[a].v.substr(f+1);f>=0;--f)k>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(b=F.charAt(k--)+b);i[a].v=b,i[a].t="t",R=a}for(k>=0&&R<i.length&&(i[R].v=F.substr(0,k+1)+i[R].v),k=F.indexOf(".")+1,a=I;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==I)){for(f=i[a].v.indexOf(".")>-1&&a===I?i[a].v.indexOf(".")+1:0,b=i[a].v.substr(0,f);f<i[a].v.length;++f)k<F.length&&(b+=F.charAt(k++));i[a].v=b,i[a].t="t",R=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(W=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=Zt(i[a].t,i[a].v,W),i[a].t="t");var V="";for(a=0;a!==i.length;++a)i[a]!=null&&(V+=i[a].v);return V}var Nl=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Bl(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function tm(e,t){var r=Qp(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Nl),o=r[1].match(Nl);return Bl(t,a)?[n,r[0]]:Bl(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function pr(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ue)[e],n==null&&(n=r.table&&r.table[Il[e]]||Ue[Il[e]]),n==null&&(n=Mp[e]||"General");break}if(es(n,0))return xa(t,r);t instanceof Date&&(t=n0(t,r.date1904));var i=tm(n,t);if(es(i[1]))return xa(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return em(i[1],t,r,i[0])}function d0(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ue[r]==null){t<0&&(t=r);continue}if(Ue[r]==e){t=r;break}}t<0&&(t=391)}return Ue[t]=e,t}function _s(e){for(var t=0;t!=392;++t)e[t]!==void 0&&d0(e[t],t)}function ys(){Ue=Lp()}var p0=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function rm(e){var t=typeof e=="number"?Ue[e]:e;return t=t.replace(p0,"(\\d+)"),new RegExp("^"+t+"$")}function nm(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(p0)||[]).forEach(function(u,h){var d=parseInt(r[h+1],10);switch(u.toLowerCase().charAt(0)){case"y":n=d;break;case"d":s=d;break;case"h":a=d;break;case"s":l=d;break;case"m":a>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?f:c+"T"+f}var im=function(){var e={};e.version="1.2.0";function t(){for(var F=0,I=new Array(256),R=0;R!=256;++R)F=R,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,I[R]=F;return typeof Int32Array<"u"?new Int32Array(I):I}var r=t();function n(F){var I=0,R=0,V=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)H[V]=F[V];for(V=0;V!=256;++V)for(R=F[V],I=256+V;I<4096;I+=256)R=H[I]=R>>>8^F[R&255];var z=[];for(V=1;V!=16;++V)z[V-1]=typeof Int32Array<"u"?H.subarray(V*256,V*256+256):H.slice(V*256,V*256+256);return z}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],f=i[5],u=i[6],h=i[7],d=i[8],m=i[9],p=i[10],g=i[11],S=i[12],A=i[13],T=i[14];function k(F,I){for(var R=I^-1,V=0,H=F.length;V<H;)R=R>>>8^r[(R^F.charCodeAt(V++))&255];return~R}function b(F,I){for(var R=I^-1,V=F.length-15,H=0;H<V;)R=T[F[H++]^R&255]^A[F[H++]^R>>8&255]^S[F[H++]^R>>16&255]^g[F[H++]^R>>>24]^p[F[H++]]^m[F[H++]]^d[F[H++]]^h[F[H++]]^u[F[H++]]^f[F[H++]]^c[F[H++]]^l[F[H++]]^o[F[H++]]^a[F[H++]]^s[F[H++]]^r[F[H++]];for(V+=15;H<V;)R=R>>>8^r[(R^F[H++])&255];return~R}function W(F,I){for(var R=I^-1,V=0,H=F.length,z=0,te=0;V<H;)z=F.charCodeAt(V++),z<128?R=R>>>8^r[(R^z)&255]:z<2048?(R=R>>>8^r[(R^(192|z>>6&31))&255],R=R>>>8^r[(R^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,te=F.charCodeAt(V++)&1023,R=R>>>8^r[(R^(240|z>>8&7))&255],R=R>>>8^r[(R^(128|z>>2&63))&255],R=R>>>8^r[(R^(128|te>>6&15|(z&3)<<4))&255],R=R>>>8^r[(R^(128|te&63))&255]):(R=R>>>8^r[(R^(224|z>>12&15))&255],R=R>>>8^r[(R^(128|z>>6&63))&255],R=R>>>8^r[(R^(128|z&63))&255]);return~R}return e.table=r,e.bstr=k,e.buf=b,e.str=W,e}(),ke=function(){var t={};t.version="1.2.1";function r(v,y){for(var x=v.split("/"),_=y.split("/"),w=0,E=0,L=Math.min(x.length,_.length);w<L;++w){if(E=x[w].length-_[w].length)return E;if(x[w]!=_[w])return x[w]<_[w]?-1:1}return x.length-_.length}function n(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:n(v.slice(0,-1));var y=v.lastIndexOf("/");return y===-1?v:v.slice(0,y+1)}function i(v){if(v.charAt(v.length-1)=="/")return i(v.slice(0,-1));var y=v.lastIndexOf("/");return y===-1?v:v.slice(y+1)}function s(v,y){typeof y=="string"&&(y=new Date(y));var x=y.getHours();x=x<<6|y.getMinutes(),x=x<<5|y.getSeconds()>>>1,v.write_shift(2,x);var _=y.getFullYear()-1980;_=_<<4|y.getMonth()+1,_=_<<5|y.getDate(),v.write_shift(2,_)}function a(v){var y=v.read_shift(2)&65535,x=v.read_shift(2)&65535,_=new Date,w=x&31;x>>>=5;var E=x&15;x>>>=4,_.setMilliseconds(0),_.setFullYear(x+1980),_.setMonth(E-1),_.setDate(w);var L=y&31;y>>>=5;var j=y&63;return y>>>=6,_.setHours(y),_.setMinutes(j),_.setSeconds(L<<1),_}function o(v){wt(v,0);for(var y={},x=0;v.l<=v.length-4;){var _=v.read_shift(2),w=v.read_shift(2),E=v.l+w,L={};switch(_){case 21589:x=v.read_shift(1),x&1&&(L.mtime=v.read_shift(4)),w>5&&(x&2&&(L.atime=v.read_shift(4)),x&4&&(L.ctime=v.read_shift(4))),L.mtime&&(L.mt=new Date(L.mtime*1e3));break}v.l=E,y[_]=L}return y}var l;function c(){return l||(l={})}function f(v,y){if(v[0]==80&&v[1]==75)return rl(v,y);if((v[0]|32)==109&&(v[1]|32)==105)return xd(v,y);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var x=3,_=512,w=0,E=0,L=0,j=0,D=0,M=[],B=v.slice(0,512);wt(B,0);var X=u(B);switch(x=X[0],x){case 3:_=512;break;case 4:_=4096;break;case 0:if(X[1]==0)return rl(v,y);default:throw new Error("Major Version: Expected 3 or 4 saw "+x)}_!==512&&(B=v.slice(0,_),wt(B,28));var Q=v.slice(0,_);h(B,x);var ie=B.read_shift(4,"i");if(x===3&&ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ie);B.l+=4,L=B.read_shift(4,"i"),B.l+=4,B.chk("00100000","Mini Stream Cutoff Size: "),j=B.read_shift(4,"i"),w=B.read_shift(4,"i"),D=B.read_shift(4,"i"),E=B.read_shift(4,"i");for(var q=-1,ne=0;ne<109&&(q=B.read_shift(4,"i"),!(q<0));++ne)M[ne]=q;var pe=d(v,_);g(D,E,pe,_,M);var Re=A(pe,L,M,_);Re[L].name="!Directory",w>0&&j!==te&&(Re[j].name="!MiniFAT"),Re[M[0]].name="!FAT",Re.fat_addrs=M,Re.ssz=_;var De={},it=[],Pn=[],On=[];T(L,Re,pe,it,w,De,Pn,j),m(Pn,On,it),it.shift();var bn={FileIndex:Pn,FullPaths:On};return y&&y.raw&&(bn.raw={header:Q,sectors:pe}),bn}function u(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(_e,"Header Signature: "),v.l+=16;var y=v.read_shift(2,"u");return[v.read_shift(2,"u"),y]}function h(v,y){var x=9;switch(v.l+=2,x=v.read_shift(2)){case 9:if(y!=3)throw new Error("Sector Shift: Expected 9 saw "+x);break;case 12:if(y!=4)throw new Error("Sector Shift: Expected 12 saw "+x);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+x)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function d(v,y){for(var x=Math.ceil(v.length/y)-1,_=[],w=1;w<x;++w)_[w-1]=v.slice(w*y,(w+1)*y);return _[x-1]=v.slice(x*y),_}function m(v,y,x){for(var _=0,w=0,E=0,L=0,j=0,D=x.length,M=[],B=[];_<D;++_)M[_]=B[_]=_,y[_]=x[_];for(;j<B.length;++j)_=B[j],w=v[_].L,E=v[_].R,L=v[_].C,M[_]===_&&(w!==-1&&M[w]!==w&&(M[_]=M[w]),E!==-1&&M[E]!==E&&(M[_]=M[E])),L!==-1&&(M[L]=_),w!==-1&&_!=M[_]&&(M[w]=M[_],B.lastIndexOf(w)<j&&B.push(w)),E!==-1&&_!=M[_]&&(M[E]=M[_],B.lastIndexOf(E)<j&&B.push(E));for(_=1;_<D;++_)M[_]===_&&(E!==-1&&M[E]!==E?M[_]=M[E]:w!==-1&&M[w]!==w&&(M[_]=M[w]));for(_=1;_<D;++_)if(v[_].type!==0){if(j=_,j!=M[j])do j=M[j],y[_]=y[j]+"/"+y[_];while(j!==0&&M[j]!==-1&&j!=M[j]);M[_]=-1}for(y[0]+="/",_=1;_<D;++_)v[_].type!==2&&(y[_]+="/")}function p(v,y,x){for(var _=v.start,w=v.size,E=[],L=_;x&&w>0&&L>=0;)E.push(y.slice(L*z,L*z+z)),w-=z,L=Or(x,L*4);return E.length===0?U(0):et(E).slice(0,v.size)}function g(v,y,x,_,w){var E=te;if(v===te){if(y!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var L=x[v],j=(_>>>2)-1;if(!L)return;for(var D=0;D<j&&(E=Or(L,D*4))!==te;++D)w.push(E);g(Or(L,_-4),y-1,x,_,w)}}function S(v,y,x,_,w){var E=[],L=[];w||(w=[]);var j=_-1,D=0,M=0;for(D=y;D>=0;){w[D]=!0,E[E.length]=D,L.push(v[D]);var B=x[Math.floor(D*4/_)];if(M=D*4&j,_<4+M)throw new Error("FAT boundary crossed: "+D+" 4 "+_);if(!v[B])break;D=Or(v[B],M)}return{nodes:E,data:Kl([L])}}function A(v,y,x,_){var w=v.length,E=[],L=[],j=[],D=[],M=_-1,B=0,X=0,Q=0,ie=0;for(B=0;B<w;++B)if(j=[],Q=B+y,Q>=w&&(Q-=w),!L[Q]){D=[];var q=[];for(X=Q;X>=0;){q[X]=!0,L[X]=!0,j[j.length]=X,D.push(v[X]);var ne=x[Math.floor(X*4/_)];if(ie=X*4&M,_<4+ie)throw new Error("FAT boundary crossed: "+X+" 4 "+_);if(!v[ne]||(X=Or(v[ne],ie),q[X]))break}E[Q]={nodes:j,data:Kl([D])}}return E}function T(v,y,x,_,w,E,L,j){for(var D=0,M=_.length?2:0,B=y[v].data,X=0,Q=0,ie;X<B.length;X+=128){var q=B.slice(X,X+128);wt(q,64),Q=q.read_shift(2),ie=Za(q,0,Q-M),_.push(ie);var ne={name:ie,type:q.read_shift(1),color:q.read_shift(1),L:q.read_shift(4,"i"),R:q.read_shift(4,"i"),C:q.read_shift(4,"i"),clsid:q.read_shift(16),state:q.read_shift(4,"i"),start:0,size:0},pe=q.read_shift(2)+q.read_shift(2)+q.read_shift(2)+q.read_shift(2);pe!==0&&(ne.ct=k(q,q.l-8));var Re=q.read_shift(2)+q.read_shift(2)+q.read_shift(2)+q.read_shift(2);Re!==0&&(ne.mt=k(q,q.l-8)),ne.start=q.read_shift(4,"i"),ne.size=q.read_shift(4,"i"),ne.size<0&&ne.start<0&&(ne.size=ne.type=0,ne.start=te,ne.name=""),ne.type===5?(D=ne.start,w>0&&D!==te&&(y[D].name="!StreamData")):ne.size>=4096?(ne.storage="fat",y[ne.start]===void 0&&(y[ne.start]=S(x,ne.start,y.fat_addrs,y.ssz)),y[ne.start].name=ne.name,ne.content=y[ne.start].data.slice(0,ne.size)):(ne.storage="minifat",ne.size<0?ne.size=0:D!==te&&ne.start!==te&&y[D]&&(ne.content=p(ne,y[D].data,(y[j]||{}).data))),ne.content&&wt(ne.content,0),E[ie]=ne,L.push(ne)}}function k(v,y){return new Date((Et(v,y+4)/1e7*Math.pow(2,32)+Et(v,y)/1e7-11644473600)*1e3)}function b(v,y){return c(),f(l.readFileSync(v),y)}function W(v,y){var x=y&&y.type;switch(x||Te&&Buffer.isBuffer(v)&&(x="buffer"),x||"base64"){case"file":return b(v,y);case"base64":return f(Mt(tr(v)),y);case"binary":return f(Mt(v),y)}return f(v,y)}function F(v,y){var x=y||{},_=x.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=_+"/",v.FileIndex[0]={name:_,type:5}),x.CLSID&&(v.FileIndex[0].clsid=x.CLSID),I(v)}function I(v){var y="Sh33tJ5";if(!ke.find(v,"/"+y)){var x=U(4);x[0]=55,x[1]=x[3]=50,x[2]=54,v.FileIndex.push({name:y,type:2,content:x,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+y),R(v)}}function R(v,y){F(v);for(var x=!1,_=!1,w=v.FullPaths.length-1;w>=0;--w){var E=v.FileIndex[w];switch(E.type){case 0:_?x=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:_=!0,isNaN(E.R*E.L*E.C)&&(x=!0),E.R>-1&&E.L>-1&&E.R==E.L&&(x=!0);break;default:x=!0;break}}if(!(!x&&!y)){var L=new Date(1987,1,19),j=0,D=Object.create?Object.create(null):{},M=[];for(w=0;w<v.FullPaths.length;++w)D[v.FullPaths[w]]=!0,v.FileIndex[w].type!==0&&M.push([v.FullPaths[w],v.FileIndex[w]]);for(w=0;w<M.length;++w){var B=n(M[w][0]);_=D[B],_||(M.push([B,{name:i(B).replace("/",""),type:1,clsid:Y,ct:L,mt:L,content:null}]),D[B]=!0)}for(M.sort(function(ie,q){return r(ie[0],q[0])}),v.FullPaths=[],v.FileIndex=[],w=0;w<M.length;++w)v.FullPaths[w]=M[w][0],v.FileIndex[w]=M[w][1];for(w=0;w<M.length;++w){var X=v.FileIndex[w],Q=v.FullPaths[w];if(X.name=i(Q).replace("/",""),X.L=X.R=X.C=-(X.color=1),X.size=X.content?X.content.length:0,X.start=0,X.clsid=X.clsid||Y,w===0)X.C=M.length>1?1:-1,X.size=0,X.type=5;else if(Q.slice(-1)=="/"){for(j=w+1;j<M.length&&n(v.FullPaths[j])!=Q;++j);for(X.C=j>=M.length?-1:j,j=w+1;j<M.length&&n(v.FullPaths[j])!=n(Q);++j);X.R=j>=M.length?-1:j,X.type=1}else n(v.FullPaths[w+1]||"")==n(Q)&&(X.R=w+1),X.type=2}}}function V(v,y){var x=y||{};if(x.fileType=="mad")return _d(v,x);switch(R(v),x.fileType){case"zip":return hd(v,x)}var _=function(ie){for(var q=0,ne=0,pe=0;pe<ie.FileIndex.length;++pe){var Re=ie.FileIndex[pe];if(Re.content){var De=Re.content.length;De>0&&(De<4096?q+=De+63>>6:ne+=De+511>>9)}}for(var it=ie.FullPaths.length+3>>2,Pn=q+7>>3,On=q+127>>7,bn=Pn+ne+it+On,Sr=bn+127>>7,Is=Sr<=109?0:Math.ceil((Sr-109)/127);bn+Sr+Is+127>>7>Sr;)Is=++Sr<=109?0:Math.ceil((Sr-109)/127);var qt=[1,Is,Sr,On,it,ne,q,0];return ie.FileIndex[0].size=q<<6,qt[7]=(ie.FileIndex[0].start=qt[0]+qt[1]+qt[2]+qt[3]+qt[4]+qt[5])+(qt[6]+7>>3),qt}(v),w=U(_[7]<<9),E=0,L=0;{for(E=0;E<8;++E)w.write_shift(1,he[E]);for(E=0;E<8;++E)w.write_shift(2,0);for(w.write_shift(2,62),w.write_shift(2,3),w.write_shift(2,65534),w.write_shift(2,9),w.write_shift(2,6),E=0;E<3;++E)w.write_shift(2,0);for(w.write_shift(4,0),w.write_shift(4,_[2]),w.write_shift(4,_[0]+_[1]+_[2]+_[3]-1),w.write_shift(4,0),w.write_shift(4,4096),w.write_shift(4,_[3]?_[0]+_[1]+_[2]-1:te),w.write_shift(4,_[3]),w.write_shift(-4,_[1]?_[0]-1:te),w.write_shift(4,_[1]),E=0;E<109;++E)w.write_shift(-4,E<_[2]?_[1]+E:-1)}if(_[1])for(L=0;L<_[1];++L){for(;E<236+L*127;++E)w.write_shift(-4,E<_[2]?_[1]+E:-1);w.write_shift(-4,L===_[1]-1?te:L+1)}var j=function(ie){for(L+=ie;E<L-1;++E)w.write_shift(-4,E+1);ie&&(++E,w.write_shift(-4,te))};for(L=E=0,L+=_[1];E<L;++E)w.write_shift(-4,ee.DIFSECT);for(L+=_[2];E<L;++E)w.write_shift(-4,ee.FATSECT);j(_[3]),j(_[4]);for(var D=0,M=0,B=v.FileIndex[0];D<v.FileIndex.length;++D)B=v.FileIndex[D],B.content&&(M=B.content.length,!(M<4096)&&(B.start=L,j(M+511>>9)));for(j(_[6]+7>>3);w.l&511;)w.write_shift(-4,ee.ENDOFCHAIN);for(L=E=0,D=0;D<v.FileIndex.length;++D)B=v.FileIndex[D],B.content&&(M=B.content.length,!(!M||M>=4096)&&(B.start=L,j(M+63>>6)));for(;w.l&511;)w.write_shift(-4,ee.ENDOFCHAIN);for(E=0;E<_[4]<<2;++E){var X=v.FullPaths[E];if(!X||X.length===0){for(D=0;D<17;++D)w.write_shift(4,0);for(D=0;D<3;++D)w.write_shift(4,-1);for(D=0;D<12;++D)w.write_shift(4,0);continue}B=v.FileIndex[E],E===0&&(B.start=B.size?B.start-1:te);var Q=E===0&&x.root||B.name;if(M=2*(Q.length+1),w.write_shift(64,Q,"utf16le"),w.write_shift(2,M),w.write_shift(1,B.type),w.write_shift(1,B.color),w.write_shift(-4,B.L),w.write_shift(-4,B.R),w.write_shift(-4,B.C),B.clsid)w.write_shift(16,B.clsid,"hex");else for(D=0;D<4;++D)w.write_shift(4,0);w.write_shift(4,B.state||0),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,0),w.write_shift(4,B.start),w.write_shift(4,B.size),w.write_shift(4,0)}for(E=1;E<v.FileIndex.length;++E)if(B=v.FileIndex[E],B.size>=4096)if(w.l=B.start+1<<9,Te&&Buffer.isBuffer(B.content))B.content.copy(w,w.l,0,B.size),w.l+=B.size+511&-512;else{for(D=0;D<B.size;++D)w.write_shift(1,B.content[D]);for(;D&511;++D)w.write_shift(1,0)}for(E=1;E<v.FileIndex.length;++E)if(B=v.FileIndex[E],B.size>0&&B.size<4096)if(Te&&Buffer.isBuffer(B.content))B.content.copy(w,w.l,0,B.size),w.l+=B.size+63&-64;else{for(D=0;D<B.size;++D)w.write_shift(1,B.content[D]);for(;D&63;++D)w.write_shift(1,0)}if(Te)w.l=w.length;else for(;w.l<w.length;)w.write_shift(1,0);return w}function H(v,y){var x=v.FullPaths.map(function(D){return D.toUpperCase()}),_=x.map(function(D){var M=D.split("/");return M[M.length-(D.slice(-1)=="/"?2:1)]}),w=!1;y.charCodeAt(0)===47?(w=!0,y=x[0].slice(0,-1)+y):w=y.indexOf("/")!==-1;var E=y.toUpperCase(),L=w===!0?x.indexOf(E):_.indexOf(E);if(L!==-1)return v.FileIndex[L];var j=!E.match(Mi);for(E=E.replace(Wn,""),j&&(E=E.replace(Mi,"!")),L=0;L<x.length;++L)if((j?x[L].replace(Mi,"!"):x[L]).replace(Wn,"")==E||(j?_[L].replace(Mi,"!"):_[L]).replace(Wn,"")==E)return v.FileIndex[L];return null}var z=64,te=-2,_e="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:_e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(v,y,x){c();var _=V(v,x);l.writeFileSync(y,_)}function de(v){for(var y=new Array(v.length),x=0;x<v.length;++x)y[x]=String.fromCharCode(v[x]);return y.join("")}function xe(v,y){var x=V(v,y);switch(y&&y.type||"buffer"){case"file":return c(),l.writeFileSync(y.filename,x),x;case"binary":return typeof x=="string"?x:de(x);case"base64":return ri(typeof x=="string"?x:de(x));case"buffer":if(Te)return Buffer.isBuffer(x)?x:sr(x);case"array":return typeof x=="string"?Mt(x):x}return x}var Ge;function C(v){try{var y=v.InflateRaw,x=new y;if(x._processChunk(new Uint8Array([3,0]),x._finishFlushFlag),x.bytesRead)Ge=v;else throw new Error("zlib does not expose bytesRead")}catch(_){console.error("cannot use native zlib: "+(_.message||_))}}function N(v,y){if(!Ge)return el(v,y);var x=Ge.InflateRaw,_=new x,w=_._processChunk(v.slice(v.l),_._finishFlushFlag);return v.l+=_.bytesRead,w}function O(v){return Ge?Ge.deflateRawSync(v):Xo(v)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(v){var y=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(y>>16|y>>8|y)&255}for(var ae=typeof Uint8Array<"u",re=ae?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)re[Pe]=fe(Pe);function ye(v,y){var x=re[v&255];return y<=8?x>>>8-y:(x=x<<8|re[v>>8&255],y<=16?x>>>16-y:(x=x<<8|re[v>>16&255],x>>>24-y))}function ct(v,y){var x=y&7,_=y>>>3;return(v[_]|(x<=6?0:v[_+1]<<8))>>>x&3}function Ee(v,y){var x=y&7,_=y>>>3;return(v[_]|(x<=5?0:v[_+1]<<8))>>>x&7}function zt(v,y){var x=y&7,_=y>>>3;return(v[_]|(x<=4?0:v[_+1]<<8))>>>x&15}function Me(v,y){var x=y&7,_=y>>>3;return(v[_]|(x<=3?0:v[_+1]<<8))>>>x&31}function se(v,y){var x=y&7,_=y>>>3;return(v[_]|(x<=1?0:v[_+1]<<8))>>>x&127}function At(v,y,x){var _=y&7,w=y>>>3,E=(1<<x)-1,L=v[w]>>>_;return x<8-_||(L|=v[w+1]<<8-_,x<16-_)||(L|=v[w+2]<<16-_,x<24-_)||(L|=v[w+3]<<24-_),L&E}function Xt(v,y,x){var _=y&7,w=y>>>3;return _<=5?v[w]|=(x&7)<<_:(v[w]|=x<<_&255,v[w+1]=(x&7)>>8-_),y+3}function Tr(v,y,x){var _=y&7,w=y>>>3;return x=(x&1)<<_,v[w]|=x,y+1}function Hr(v,y,x){var _=y&7,w=y>>>3;return x<<=_,v[w]|=x&255,x>>>=8,v[w+1]=x,y+8}function zo(v,y,x){var _=y&7,w=y>>>3;return x<<=_,v[w]|=x&255,x>>>=8,v[w+1]=x&255,v[w+2]=x>>>8,y+16}function Os(v,y){var x=v.length,_=2*x>y?2*x:y+5,w=0;if(x>=y)return v;if(Te){var E=bl(_);if(v.copy)v.copy(E);else for(;w<v.length;++w)E[w]=v[w];return E}else if(ae){var L=new Uint8Array(_);if(L.set)L.set(v);else for(;w<x;++w)L[w]=v[w];return L}return v.length=_,v}function Ut(v){for(var y=new Array(v),x=0;x<v;++x)y[x]=0;return y}function Fi(v,y,x){var _=1,w=0,E=0,L=0,j=0,D=v.length,M=ae?new Uint16Array(32):Ut(32);for(E=0;E<32;++E)M[E]=0;for(E=D;E<x;++E)v[E]=0;D=v.length;var B=ae?new Uint16Array(D):Ut(D);for(E=0;E<D;++E)M[w=v[E]]++,_<w&&(_=w),B[E]=0;for(M[0]=0,E=1;E<=_;++E)M[E+16]=j=j+M[E-1]<<1;for(E=0;E<D;++E)j=v[E],j!=0&&(B[E]=M[j+16]++);var X=0;for(E=0;E<D;++E)if(X=v[E],X!=0)for(j=ye(B[E],_)>>_-X,L=(1<<_+4-X)-1;L>=0;--L)y[j|L<<X]=X&15|E<<4;return _}var bs=ae?new Uint16Array(512):Ut(512),Rs=ae?new Uint16Array(32):Ut(32);if(!ae){for(var Er=0;Er<512;++Er)bs[Er]=0;for(Er=0;Er<32;++Er)Rs[Er]=0}(function(){for(var v=[],y=0;y<32;y++)v.push(5);Fi(v,Rs,32);var x=[];for(y=0;y<=143;y++)x.push(8);for(;y<=255;y++)x.push(9);for(;y<=279;y++)x.push(7);for(;y<=287;y++)x.push(8);Fi(x,bs,288)})();var ld=function(){for(var y=ae?new Uint8Array(32768):[],x=0,_=0;x<ce.length-1;++x)for(;_<ce[x+1];++_)y[_]=x;for(;_<32768;++_)y[_]=29;var w=ae?new Uint8Array(259):[];for(x=0,_=0;x<K.length-1;++x)for(;_<K[x+1];++_)w[_]=x;function E(j,D){for(var M=0;M<j.length;){var B=Math.min(65535,j.length-M),X=M+B==j.length;for(D.write_shift(1,+X),D.write_shift(2,B),D.write_shift(2,~B&65535);B-- >0;)D[D.l++]=j[M++]}return D.l}function L(j,D){for(var M=0,B=0,X=ae?new Uint16Array(32768):[];B<j.length;){var Q=Math.min(65535,j.length-B);if(Q<10){for(M=Xt(D,M,+(B+Q==j.length)),M&7&&(M+=8-(M&7)),D.l=M/8|0,D.write_shift(2,Q),D.write_shift(2,~Q&65535);Q-- >0;)D[D.l++]=j[B++];M=D.l*8;continue}M=Xt(D,M,+(B+Q==j.length)+2);for(var ie=0;Q-- >0;){var q=j[B];ie=(ie<<5^q)&32767;var ne=-1,pe=0;if((ne=X[ie])&&(ne|=B&-32768,ne>B&&(ne-=32768),ne<B))for(;j[ne+pe]==j[B+pe]&&pe<250;)++pe;if(pe>2){q=w[pe],q<=22?M=Hr(D,M,re[q+1]>>1)-1:(Hr(D,M,3),M+=5,Hr(D,M,re[q-23]>>5),M+=3);var Re=q<8?0:q-4>>2;Re>0&&(zo(D,M,pe-K[q]),M+=Re),q=y[B-ne],M=Hr(D,M,re[q]>>3),M-=3;var De=q<4?0:q-2>>1;De>0&&(zo(D,M,B-ne-ce[q]),M+=De);for(var it=0;it<pe;++it)X[ie]=B&32767,ie=(ie<<5^j[B])&32767,++B;Q-=pe-1}else q<=143?q=q+48:M=Tr(D,M,1),M=Hr(D,M,re[q]),X[ie]=B&32767,++B}M=Hr(D,M,0)-1}return D.l=(M+7)/8|0,D.l}return function(D,M){return D.length<8?E(D,M):L(D,M)}}();function Xo(v){var y=U(50+Math.floor(v.length*1.1)),x=ld(v,y);return y.slice(0,x)}var qo=ae?new Uint16Array(32768):Ut(32768),Yo=ae?new Uint16Array(32768):Ut(32768),Jo=ae?new Uint16Array(128):Ut(128),Zo=1,Qo=1;function cd(v,y){var x=Me(v,y)+257;y+=5;var _=Me(v,y)+1;y+=5;var w=zt(v,y)+4;y+=4;for(var E=0,L=ae?new Uint8Array(19):Ut(19),j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],D=1,M=ae?new Uint8Array(8):Ut(8),B=ae?new Uint8Array(8):Ut(8),X=L.length,Q=0;Q<w;++Q)L[P[Q]]=E=Ee(v,y),D<E&&(D=E),M[E]++,y+=3;var ie=0;for(M[0]=0,Q=1;Q<=D;++Q)B[Q]=ie=ie+M[Q-1]<<1;for(Q=0;Q<X;++Q)(ie=L[Q])!=0&&(j[Q]=B[ie]++);var q=0;for(Q=0;Q<X;++Q)if(q=L[Q],q!=0){ie=re[j[Q]]>>8-q;for(var ne=(1<<7-q)-1;ne>=0;--ne)Jo[ie|ne<<q]=q&7|Q<<3}var pe=[];for(D=1;pe.length<x+_;)switch(ie=Jo[se(v,y)],y+=ie&7,ie>>>=3){case 16:for(E=3+ct(v,y),y+=2,ie=pe[pe.length-1];E-- >0;)pe.push(ie);break;case 17:for(E=3+Ee(v,y),y+=3;E-- >0;)pe.push(0);break;case 18:for(E=11+se(v,y),y+=7;E-- >0;)pe.push(0);break;default:pe.push(ie),D<ie&&(D=ie);break}var Re=pe.slice(0,x),De=pe.slice(x);for(Q=x;Q<286;++Q)Re[Q]=0;for(Q=_;Q<30;++Q)De[Q]=0;return Zo=Fi(Re,qo,286),Qo=Fi(De,Yo,30),y}function fd(v,y){if(v[0]==3&&!(v[1]&3))return[Lr(y),2];for(var x=0,_=0,w=bl(y||1<<18),E=0,L=w.length>>>0,j=0,D=0;(_&1)==0;){if(_=Ee(v,x),x+=3,_>>>1)_>>1==1?(j=9,D=5):(x=cd(v,x),j=Zo,D=Qo);else{x&7&&(x+=8-(x&7));var M=v[x>>>3]|v[(x>>>3)+1]<<8;if(x+=32,M>0)for(!y&&L<E+M&&(w=Os(w,E+M),L=w.length);M-- >0;)w[E++]=v[x>>>3],x+=8;continue}for(;;){!y&&L<E+32767&&(w=Os(w,E+32767),L=w.length);var B=At(v,x,j),X=_>>>1==1?bs[B]:qo[B];if(x+=X&15,X>>>=4,(X>>>8&255)===0)w[E++]=X;else{if(X==256)break;X-=257;var Q=X<8?0:X-4>>2;Q>5&&(Q=0);var ie=E+K[X];Q>0&&(ie+=At(v,x,Q),x+=Q),B=At(v,x,D),X=_>>>1==1?Rs[B]:Yo[B],x+=X&15,X>>>=4;var q=X<4?0:X-2>>1,ne=ce[X];for(q>0&&(ne+=At(v,x,q),x+=q),!y&&L<ie&&(w=Os(w,ie+100),L=w.length);E<ie;)w[E]=w[E-ne],++E}}}return y?[w,x+7>>>3]:[w.slice(0,E),x+7>>>3]}function el(v,y){var x=v.slice(v.l||0),_=fd(x,y);return v.l+=_[1],_[0]}function tl(v,y){if(v)typeof console<"u"&&console.error(y);else throw new Error(y)}function rl(v,y){var x=v;wt(x,0);var _=[],w=[],E={FileIndex:_,FullPaths:w};F(E,{root:y.root});for(var L=x.length-4;(x[L]!=80||x[L+1]!=75||x[L+2]!=5||x[L+3]!=6)&&L>=0;)--L;x.l=L+4,x.l+=4;var j=x.read_shift(2);x.l+=6;var D=x.read_shift(4);for(x.l=D,L=0;L<j;++L){x.l+=20;var M=x.read_shift(4),B=x.read_shift(4),X=x.read_shift(2),Q=x.read_shift(2),ie=x.read_shift(2);x.l+=8;var q=x.read_shift(4),ne=o(x.slice(x.l+X,x.l+X+Q));x.l+=X+Q+ie;var pe=x.l;x.l=q+4,ud(x,M,B,E,ne),x.l=pe}return E}function ud(v,y,x,_,w){v.l+=2;var E=v.read_shift(2),L=v.read_shift(2),j=a(v);if(E&8257)throw new Error("Unsupported ZIP encryption");for(var D=v.read_shift(4),M=v.read_shift(4),B=v.read_shift(4),X=v.read_shift(2),Q=v.read_shift(2),ie="",q=0;q<X;++q)ie+=String.fromCharCode(v[v.l++]);if(Q){var ne=o(v.slice(v.l,v.l+Q));(ne[21589]||{}).mt&&(j=ne[21589].mt),((w||{})[21589]||{}).mt&&(j=w[21589].mt)}v.l+=Q;var pe=v.slice(v.l,v.l+M);switch(L){case 8:pe=N(v,B);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+L)}var Re=!1;E&8&&(D=v.read_shift(4),D==134695760&&(D=v.read_shift(4),Re=!0),M=v.read_shift(4),B=v.read_shift(4)),M!=y&&tl(Re,"Bad compressed size: "+y+" != "+M),B!=x&&tl(Re,"Bad uncompressed size: "+x+" != "+B),Ds(_,ie,pe,{unsafe:!0,mt:j})}function hd(v,y){var x=y||{},_=[],w=[],E=U(1),L=x.compression?8:0,j=0,D=0,M=0,B=0,X=0,Q=v.FullPaths[0],ie=Q,q=v.FileIndex[0],ne=[],pe=0;for(D=1;D<v.FullPaths.length;++D)if(ie=v.FullPaths[D].slice(Q.length),q=v.FileIndex[D],!(!q.size||!q.content||ie=="Sh33tJ5")){var Re=B,De=U(ie.length);for(M=0;M<ie.length;++M)De.write_shift(1,ie.charCodeAt(M)&127);De=De.slice(0,De.l),ne[X]=im.buf(q.content,0);var it=q.content;L==8&&(it=O(it)),E=U(30),E.write_shift(4,67324752),E.write_shift(2,20),E.write_shift(2,j),E.write_shift(2,L),q.mt?s(E,q.mt):E.write_shift(4,0),E.write_shift(-4,ne[X]),E.write_shift(4,it.length),E.write_shift(4,q.content.length),E.write_shift(2,De.length),E.write_shift(2,0),B+=E.length,_.push(E),B+=De.length,_.push(De),B+=it.length,_.push(it),E=U(46),E.write_shift(4,33639248),E.write_shift(2,0),E.write_shift(2,20),E.write_shift(2,j),E.write_shift(2,L),E.write_shift(4,0),E.write_shift(-4,ne[X]),E.write_shift(4,it.length),E.write_shift(4,q.content.length),E.write_shift(2,De.length),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(4,0),E.write_shift(4,Re),pe+=E.l,w.push(E),pe+=De.length,w.push(De),++X}return E=U(22),E.write_shift(4,101010256),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(2,X),E.write_shift(2,X),E.write_shift(4,pe),E.write_shift(4,B),E.write_shift(2,0),et([et(_),et(w),E])}var ki={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function dd(v,y){if(v.ctype)return v.ctype;var x=v.name||"",_=x.match(/\.([^\.]+)$/);return _&&ki[_[1]]||y&&(_=(x=y).match(/[\.\\]([^\.\\])+$/),_&&ki[_[1]])?ki[_[1]]:"application/octet-stream"}function pd(v){for(var y=ri(v),x=[],_=0;_<y.length;_+=76)x.push(y.slice(_,_+76));return x.join(`\r
`)+`\r
`}function md(v){var y=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(M){var B=M.charCodeAt(0).toString(16).toUpperCase();return"="+(B.length==1?"0"+B:B)});y=y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),y.charAt(0)==`
`&&(y="=0D"+y.slice(1)),y=y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var x=[],_=y.split(`\r
`),w=0;w<_.length;++w){var E=_[w];if(E.length==0){x.push("");continue}for(var L=0;L<E.length;){var j=76,D=E.slice(L,L+j);D.charAt(j-1)=="="?j--:D.charAt(j-2)=="="?j-=2:D.charAt(j-3)=="="&&(j-=3),D=E.slice(L,L+j),L+=j,L<E.length&&(D+="="),x.push(D)}}return x.join(`\r
`)}function gd(v){for(var y=[],x=0;x<v.length;++x){for(var _=v[x];x<=v.length&&_.charAt(_.length-1)=="=";)_=_.slice(0,_.length-1)+v[++x];y.push(_)}for(var w=0;w<y.length;++w)y[w]=y[w].replace(/[=][0-9A-Fa-f]{2}/g,function(E){return String.fromCharCode(parseInt(E.slice(1),16))});return Mt(y.join(`\r
`))}function vd(v,y,x){for(var _="",w="",E="",L,j=0;j<10;++j){var D=y[j];if(!D||D.match(/^\s*$/))break;var M=D.match(/^(.*?):\s*([^\s].*)$/);if(M)switch(M[1].toLowerCase()){case"content-location":_=M[2].trim();break;case"content-type":E=M[2].trim();break;case"content-transfer-encoding":w=M[2].trim();break}}switch(++j,w.toLowerCase()){case"base64":L=Mt(tr(y.slice(j).join("")));break;case"quoted-printable":L=gd(y.slice(j));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+w)}var B=Ds(v,_.slice(x.length),L,{unsafe:!0});E&&(B.ctype=E)}function xd(v,y){if(de(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var x=y&&y.root||"",_=(Te&&Buffer.isBuffer(v)?v.toString("binary"):de(v)).split(`\r
`),w=0,E="";for(w=0;w<_.length;++w)if(E=_[w],!!/^Content-Location:/i.test(E)&&(E=E.slice(E.indexOf("file")),x||(x=E.slice(0,E.lastIndexOf("/")+1)),E.slice(0,x.length)!=x))for(;x.length>0&&(x=x.slice(0,x.length-1),x=x.slice(0,x.lastIndexOf("/")+1),E.slice(0,x.length)!=x););var L=(_[1]||"").match(/boundary="(.*?)"/);if(!L)throw new Error("MAD cannot find boundary");var j="--"+(L[1]||""),D=[],M=[],B={FileIndex:D,FullPaths:M};F(B);var X,Q=0;for(w=0;w<_.length;++w){var ie=_[w];ie!==j&&ie!==j+"--"||(Q++&&vd(B,_.slice(X,w),x),X=w)}return B}function _d(v,y){var x=y||{},_=x.boundary||"SheetJS";_="------="+_;for(var w=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+_.slice(2)+'"',"","",""],E=v.FullPaths[0],L=E,j=v.FileIndex[0],D=1;D<v.FullPaths.length;++D)if(L=v.FullPaths[D].slice(E.length),j=v.FileIndex[D],!(!j.size||!j.content||L=="Sh33tJ5")){L=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(pe){return"_x"+pe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(pe){return"_u"+pe.charCodeAt(0).toString(16)+"_"});for(var M=j.content,B=Te&&Buffer.isBuffer(M)?M.toString("binary"):de(M),X=0,Q=Math.min(1024,B.length),ie=0,q=0;q<=Q;++q)(ie=B.charCodeAt(q))>=32&&ie<128&&++X;var ne=X>=Q*4/5;w.push(_),w.push("Content-Location: "+(x.root||"file:///C:/SheetJS/")+L),w.push("Content-Transfer-Encoding: "+(ne?"quoted-printable":"base64")),w.push("Content-Type: "+dd(j,L)),w.push(""),w.push(ne?md(B):pd(B))}return w.push(_+`--\r
`),w.join(`\r
`)}function yd(v){var y={};return F(y,v),y}function Ds(v,y,x,_){var w=_&&_.unsafe;w||F(v);var E=!w&&ke.find(v,y);if(!E){var L=v.FullPaths[0];y.slice(0,L.length)==L?L=y:(L.slice(-1)!="/"&&(L+="/"),L=(L+y).replace("//","/")),E={name:i(y),type:2},v.FileIndex.push(E),v.FullPaths.push(L),w||ke.utils.cfb_gc(v)}return E.content=x,E.size=x?x.length:0,_&&(_.CLSID&&(E.clsid=_.CLSID),_.mt&&(E.mt=_.mt),_.ct&&(E.ct=_.ct)),E}function wd(v,y){F(v);var x=ke.find(v,y);if(x){for(var _=0;_<v.FileIndex.length;++_)if(v.FileIndex[_]==x)return v.FileIndex.splice(_,1),v.FullPaths.splice(_,1),!0}return!1}function Td(v,y,x){F(v);var _=ke.find(v,y);if(_){for(var w=0;w<v.FileIndex.length;++w)if(v.FileIndex[w]==_)return v.FileIndex[w].name=i(x),v.FullPaths[w]=x,!0}return!1}function Ed(v){R(v,!0)}return t.find=H,t.read=W,t.parse=f,t.write=xe,t.writeFile=oe,t.utils={cfb_new:yd,cfb_add:Ds,cfb_del:wd,cfb_mov:Td,cfb_gc:Ed,ReadShift:Gn,CheckField:R0,prep_blob:wt,bconcat:et,use_zlib:C,_deflateRaw:Xo,_inflateRaw:el,consts:ee},t}();function sm(e){return typeof e=="string"?xs(e):Array.isArray(e)?bp(e):e}function xi(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=xs(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?ii(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([sm(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=vi(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function nt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Ul(e,t){for(var r=[],n=nt(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function Xa(e){for(var t=[],r=nt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function ws(e){for(var t=[],r=nt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function am(e){for(var t=[],r=nt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var rs=new Date(1899,11,30,0,0,0);function vt(e,t){var r=e.getTime(),n=rs.getTime()+(e.getTimezoneOffset()-rs.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var m0=new Date,om=rs.getTime()+(m0.getTimezoneOffset()-rs.getTimezoneOffset())*6e4,jl=m0.getTimezoneOffset();function g0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+om),t.getTimezoneOffset()!==jl&&t.setTime(t.getTime()+(t.getTimezoneOffset()-jl)*6e4),t}var Vl=new Date("2017-02-19T19:06:09.000Z"),v0=isNaN(Vl.getFullYear())?new Date("2/19/17"):Vl,lm=v0.getFullYear()==2017;function dt(e,t){var r=new Date(e);if(lm)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(v0.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ts(e,t){if(Te&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function xt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=xt(e[r]));return t}function Be(e,t){for(var r="";r.length<t;)r+=e;return r}function Qt(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var cm=["january","february","march","april","may","june","july","august","september","october","november","december"];function ni(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&cm.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function ge(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Te?n=sr(r):n=Rp(r),ke.utils.cfb_add(e,t,n)}ke.utils.cfb_add(e,t,r)}else e.file(t,r)}function qa(){return ke.utils.cfb_new()}var We=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fm={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ya=Xa(fm),Ja=/[&<>'"]/g,um=/[\u0000-\u0008\u000b-\u001f]/g;function Ce(e){var t=e+"";return t.replace(Ja,function(r){return Ya[r]}).replace(um,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function $l(e){return Ce(e).replace(/ /g,"_x0020_")}var x0=/[\u0000-\u001f]/g;function hm(e){var t=e+"";return t.replace(Ja,function(r){return Ya[r]}).replace(/\n/g,"<br/>").replace(x0,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function dm(e){var t=e+"";return t.replace(Ja,function(r){return Ya[r]}).replace(x0,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function pm(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function mm(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Hs(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Wl(e){var t=Lr(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Hl(e){return sr(e,"binary").toString("utf8")}var Bi="foo bar baz",Hn=Te&&(Hl(Bi)==Hs(Bi)&&Hl||Wl(Bi)==Hs(Bi)&&Wl)||Hs,ii=Te?function(e){return sr(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},gm=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),_0=/(^\s|\s$|\n)/;function tt(e,t){return"<"+e+(t.match(_0)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function si(e){return nt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function J(e,t,r){return"<"+e+(r!=null?si(r):"")+(t!=null?(t.match(_0)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function _a(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function vm(e,t){switch(typeof e){case"string":var r=J("vt:lpwstr",Ce(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return J((e|0)==e?"vt:i4":"vt:r8",Ce(String(e)));case"boolean":return J("vt:bool",e?"true":"false")}if(e instanceof Date)return J("vt:filetime",_a(e));throw new Error("Unable to serialize "+e)}var Xe={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Tn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Tt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function xm(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function _m(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var Gl=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Kl=Te?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:sr(t)})):Gl(e)}:Gl,zl=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Nn(e,i)));return n.join("").replace(Wn,"")},Za=Te?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Wn,""):zl(e,t,r)}:zl,Xl=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},y0=Te?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Xl(e,t,r)}:Xl,ql=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(nn(e,i)));return n.join("")},_i=Te?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):ql(t,r,n)}:ql,w0=function(e,t){var r=Et(e,t);return r>0?_i(e,t+4,t+4+r-1):""},T0=w0,E0=function(e,t){var r=Et(e,t);return r>0?_i(e,t+4,t+4+r-1):""},S0=E0,A0=function(e,t){var r=2*Et(e,t);return r>0?_i(e,t+4,t+4+r-1):""},C0=A0,F0=function(t,r){var n=Et(t,r);return n>0?Za(t,r+4,r+4+n):""},k0=F0,P0=function(e,t){var r=Et(e,t);return r>0?_i(e,t+4,t+4+r):""},O0=P0,b0=function(e,t){return xm(e,t)},ns=b0,Qa=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Te&&(T0=function(t,r){if(!Buffer.isBuffer(t))return w0(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},S0=function(t,r){if(!Buffer.isBuffer(t))return E0(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},C0=function(t,r){if(!Buffer.isBuffer(t))return A0(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},k0=function(t,r){if(!Buffer.isBuffer(t))return F0(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},O0=function(t,r){if(!Buffer.isBuffer(t))return P0(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ns=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):b0(t,r)},Qa=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var nn=function(e,t){return e[t]},Nn=function(e,t){return e[t+1]*256+e[t]},ym=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Et=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Or=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},wm=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Gn(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,Te&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Nn(this,c)),c+=2;e*=2;break;case"utf8":r=_i(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Za(this,this.l,this.l+e);break;case"wstr":return Gn.call(this,e,"dbcs");case"lpstr-ansi":r=T0(this,this.l),e=4+Et(this,this.l);break;case"lpstr-cp":r=S0(this,this.l),e=4+Et(this,this.l);break;case"lpwstr":r=C0(this,this.l),e=4+2*Et(this,this.l);break;case"lpp4":e=4+Et(this,this.l),r=k0(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Et(this,this.l),r=O0(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=nn(this,this.l+e++))!==0;)s.push(Li(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=Nn(this,this.l+e))!==0;)s.push(Li(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=nn(this,c),this.l=c+1,o=Gn.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Li(Nn(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=nn(this,c),this.l=c+1,o=Gn.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Li(nn(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=nn(this,this.l),this.l++,n;case 2:return n=(t==="i"?ym:Nn)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Or:wm)(this,this.l),this.l+=4,n):(i=Et(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=ns(this,this.l):i=ns([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=y0(this,this.l,e);break}}return this.l+=e,r}var Tm=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Em=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Sm=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Am(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)Sm(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Tm(this,t,this.l);break;case 8:if(n=8,r==="f"){_m(this,t,this.l);break}case 16:break;case-4:n=4,Em(this,t,this.l);break}return this.l+=n,this}function R0(e,t){var r=y0(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function wt(e,t){e.l=t,e.read_shift=Gn,e.chk=R0,e.write_shift=Am}function Kt(e,t){e.l+=t}function U(e){var t=Lr(e);return wt(t,0),t}function gt(){var e=[],t=Te?256:2048,r=function(c){var f=U(c);return wt(f,0),f},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),et(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function G(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=xw[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Qa(r)&&e.push(r)}}function Kn(e,t,r){var n=xt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Yl(e,t,r){var n=xt(e);return n.s=Kn(n.s,t.s,r),n.e=Kn(n.e,t.s,r),n}function zn(e,t){if(e.cRel&&e.c<0)for(e=xt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=xt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Fe(e);return!e.cRel&&e.cRel!=null&&(r=km(r)),!e.rRel&&e.rRel!=null&&(r=Cm(r)),r}function Gs(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ot(e.s.c)+":"+(e.e.cRel?"":"$")+ot(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+rt(e.s.r)+":"+(e.e.rRel?"":"$")+rt(e.e.r):zn(e.s,t.biff)+":"+zn(e.e,t.biff)}function eo(e){return parseInt(Fm(e),10)-1}function rt(e){return""+(e+1)}function Cm(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Fm(e){return e.replace(/\$(\d+)$/,"$1")}function to(e){for(var t=Pm(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ot(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function km(e){return e.replace(/^([A-Z])/,"$$$1")}function Pm(e){return e.replace(/^\$([A-Z])/,"$1")}function Om(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function qe(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Fe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function St(e){var t=e.indexOf(":");return t==-1?{s:qe(e),e:qe(e)}:{s:qe(e.slice(0,t)),e:qe(e.slice(t+1))}}function $e(e,t){return typeof t>"u"||typeof t=="number"?$e(e.s,e.e):(typeof e!="string"&&(e=Fe(e)),typeof t!="string"&&(t=Fe(t)),e==t?e:e+":"+t)}function be(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Jl(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=pr(e.z,r?vt(t):t)}catch{}try{return e.w=pr((e.XF||{}).numFmtId||(r?14:0),r?vt(t):t)}catch{return""+t}}function rr(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?yi[e.v]||e.v:t==null?Jl(e,e.v):Jl(e,t))}function Ur(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function D0(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?qe(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=be(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),a==-1&&(c.e.r=a=f.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if(!(typeof t[u][h]>"u")){var d={v:t[u][h]},m=a+u,p=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),t[u][h]&&typeof t[u][h]=="object"&&!Array.isArray(t[u][h])&&!(t[u][h]instanceof Date))d=t[u][h];else if(Array.isArray(d.v)&&(d.f=t[u][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Ue[14],n.cellDates?(d.t="d",d.w=pr(d.z,vt(d.v))):(d.t="n",d.v=vt(d.v),d.w=pr(d.z,d.v))):d.t="s";if(i)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(d.z=s[m][p].z),s[m][p]=d;else{var g=Fe({c:p,r:m});s[g]&&s[g].z&&(d.z=s[g].z),s[g]=d}}}return c.s.c<1e7&&(s["!ref"]=$e(c)),s}function En(e,t){return D0(null,e,t)}function bm(e){return e.read_shift(4,"i")}function Bt(e,t){return t||(t=U(4)),t.write_shift(4,e),t}function lt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ye(e,t){var r=!1;return t==null&&(r=!0,t=U(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Rm(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Dm(e,t){return t||(t=U(4)),t.write_shift(2,0),t.write_shift(2,0),t}function ro(e,t){var r=e.l,n=e.read_shift(1),i=lt(e),s=[],a={t:i,h:i};if((n&1)!==0){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(Rm(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function Im(e,t){var r=!1;return t==null&&(r=!0,t=U(15+4*e.t.length)),t.write_shift(1,0),Ye(e.t,t),r?t.slice(0,t.l):t}var Lm=ro;function Mm(e,t){var r=!1;return t==null&&(r=!0,t=U(23+4*e.t.length)),t.write_shift(1,1),Ye(e.t,t),t.write_shift(4,1),Dm({},t),r?t.slice(0,t.l):t}function bt(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function jr(e,t){return t==null&&(t=U(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Vr(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function $r(e,t){return t==null&&(t=U(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Nm=lt,I0=Ye;function no(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function is(e,t){var r=!1;return t==null&&(r=!0,t=U(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Bm=lt,ya=no,io=is;function L0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?ns([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Or(t,0)>>2;return r?i/100:i}function M0(e,t){t==null&&(t=U(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function N0(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Um(e,t){return t||(t=U(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Wr=N0,Sn=Um;function An(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Mr(e,t){return(t||U(8)).write_shift(8,e,"f")}function jm(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=qm[i];c&&(t.rgb=lc(c));break;case 2:t.rgb=lc([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function ss(e,t){if(t||(t=U(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Vm(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function $m(e,t){t||(t=U(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var B0=2,yt=3,Ui=11,as=19,ji=64,Wm=65,Hm=71,Gm=4108,Km=4126,Qe=80,Zl={1:{n:"CodePage",t:B0},2:{n:"Category",t:Qe},3:{n:"PresentationFormat",t:Qe},4:{n:"ByteCount",t:yt},5:{n:"LineCount",t:yt},6:{n:"ParagraphCount",t:yt},7:{n:"SlideCount",t:yt},8:{n:"NoteCount",t:yt},9:{n:"HiddenCount",t:yt},10:{n:"MultimediaClipCount",t:yt},11:{n:"ScaleCrop",t:Ui},12:{n:"HeadingPairs",t:Gm},13:{n:"TitlesOfParts",t:Km},14:{n:"Manager",t:Qe},15:{n:"Company",t:Qe},16:{n:"LinksUpToDate",t:Ui},17:{n:"CharacterCount",t:yt},19:{n:"SharedDoc",t:Ui},22:{n:"HyperlinksChanged",t:Ui},23:{n:"AppVersion",t:yt,p:"version"},24:{n:"DigSig",t:Wm},26:{n:"ContentType",t:Qe},27:{n:"ContentStatus",t:Qe},28:{n:"Language",t:Qe},29:{n:"Version",t:Qe},255:{},2147483648:{n:"Locale",t:as},2147483651:{n:"Behavior",t:as},1919054434:{}},Ql={1:{n:"CodePage",t:B0},2:{n:"Title",t:Qe},3:{n:"Subject",t:Qe},4:{n:"Author",t:Qe},5:{n:"Keywords",t:Qe},6:{n:"Comments",t:Qe},7:{n:"Template",t:Qe},8:{n:"LastAuthor",t:Qe},9:{n:"RevNumber",t:Qe},10:{n:"EditTime",t:ji},11:{n:"LastPrinted",t:ji},12:{n:"CreatedDate",t:ji},13:{n:"ModifiedDate",t:ji},14:{n:"PageCount",t:yt},15:{n:"WordCount",t:yt},16:{n:"CharCount",t:yt},17:{n:"Thumbnail",t:Hm},18:{n:"Application",t:Qe},19:{n:"DocSecurity",t:yt},255:{},2147483648:{n:"Locale",t:as},2147483651:{n:"Behavior",t:as},1919054434:{}};function zm(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Xm=zm([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qm=xt(Xm),yi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ym={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Vi={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function U0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function j0(e,t){var r=am(Ym),n=[],i;n[n.length]=We,n[n.length]=J("Types",null,{xmlns:Xe.CT,"xmlns:xsd":Xe.xsd,"xmlns:xsi":Xe.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return J("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=J("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Vi[l][t.bookType]||Vi[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(c){n[n.length]=J("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Vi[l][t.bookType]||Vi[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=J("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var we={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function V0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function dn(e){var t=[We,J("Relationships",null,{xmlns:Xe.RELS})];return nt(e["!id"]).forEach(function(r){t[t.length]=J("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ae(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[we.HLINK,we.XPATH,we.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function Jm(e){var t=[We];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function ec(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Zm(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Qm(e){var t=[We];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(ec(e[r][0],e[r][1])),t.push(Zm("",e[r][0]));return t.push(ec("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function $0(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Zi.version+"</meta:generator></office:meta></office:document-meta>"}var Dr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Ks(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Ce(t),n[n.length]=r?J(e,t,r):tt(e,t))}function W0(e,t){var r=t||{},n=[We,J("cp:coreProperties",null,{"xmlns:cp":Xe.CORE_PROPS,"xmlns:dc":Xe.dc,"xmlns:dcterms":Xe.dcterms,"xmlns:dcmitype":Xe.dcmitype,"xmlns:xsi":Xe.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Ks("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:_a(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Ks("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:_a(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Dr.length;++s){var a=Dr[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Ks(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var pn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],H0=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function G0(e){var t=[],r=J;return e||(e={}),e.Application="SheetJS",t[t.length]=We,t[t.length]=J("Properties",null,{xmlns:Xe.EXT_PROPS,"xmlns:vt":Xe.vt}),pn.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Ce(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ce(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function K0(e){var t=[We,J("Properties",null,{xmlns:Xe.CUST_PROPS,"xmlns:vt":Xe.vt})];if(!e)return t.join("");var r=1;return nt(e).forEach(function(i){++r,t[t.length]=J("property",vm(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ce(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var tc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function eg(e,t){var r=[];return nt(tc).map(function(n){for(var i=0;i<Dr.length;++i)if(Dr[i][1]==n)return Dr[i];for(i=0;i<pn.length;++i)if(pn[i][1]==n)return pn[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(tt(tc[n[1]]||n[1],i))}}),J("DocumentProperties",r.join(""),{xmlns:Tt.o})}function tg(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&nt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<Dr.length;++a)if(s==Dr[a][1])return;for(a=0;a<pn.length;++a)if(s==pn[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(J($l(s),o,{"dt:dt":l}))}}),t&&nt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(J($l(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Tt.o+'">'+i.join("")+"</"+n+">"}function rg(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=U(8);return a.write_shift(4,n),a.write_shift(4,i),a}function rc(e,t){var r=U(4),n=U(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=U(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=rg(t);break;case 31:case 80:for(n=U(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return et([r,n])}var z0=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ng(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function nc(e,t,r){var n=U(8),i=[],s=[],a=8,o=0,l=U(8),c=U(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!t){c=U(8),c.write_shift(4,0),i.unshift(c);var f=[U(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var u=e[o][0];for(l=U(8+2*(u.length+1)+(u.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,u.length+1),l.write_shift(0,u,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=et(f),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(z0.indexOf(e[o][0])>-1||H0.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],d=0;if(t){d=+t[e[o][0]];var m=r[d];if(m.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}l=rc(m.t,h)}else{var g=ng(h);g==-1&&(g=31,h=String(h)),l=rc(g,h)}s.push(l),c=U(8),c.write_shift(4,t?d:2+o),i.push(c),a+=8+l.length}var S=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,S),S+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),et([n].concat(i).concat(s))}function ic(e,t,r,n,i,s){var a=U(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,ke.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=nc(e,r,n);if(o.push(l),i){var c=nc(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return et(o)}function ig(e,t){t||(t=U(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function sg(e,t){return e.read_shift(t)===1}function ut(e,t){return t||(t=U(2)),t.write_shift(2,+!!e),t}function X0(e){return e.read_shift(2,"u")}function Pt(e,t){return t||(t=U(2)),t.write_shift(2,e),t}function q0(e,t,r){return r||(r=U(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Y0(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function ag(e){var t=e.t||"",r=U(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=U(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return et(i)}function og(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function lg(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):og(e,n,r)}function cg(e,t,r){if(r.biff>5)return lg(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function J0(e,t,r){return r||(r=U(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function sc(e,t){t||(t=U(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function fg(e){var t=U(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),sc(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&sc(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Nr(e,t,r,n){return n||(n=U(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function ug(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function hg(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Z0(e,t){return t||(t=U(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function so(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=U(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function dg(e,t){var r=!t||t.biff==8,n=U(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function pg(e,t){var r=!t||t.biff>=8?2:1,n=U(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function mg(e,t){var r=U(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=ag(e[i]);var s=et([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function gg(){var e=U(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function vg(e){var t=U(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function xg(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=U(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function _g(e,t,r,n){var i=U(10);return Nr(e,t,n,i),i.write_shift(4,r),i}function yg(e,t,r,n,i){var s=!i||i.biff==8,a=U(8+ +s+(1+s)*r.length);return Nr(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function wg(e,t,r,n){var i=r&&r.biff==5;n||(n=U(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function Tg(e,t){var r=t.biff==8||!t.biff?4:2,n=U(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function ac(e,t,r,n){var i=r&&r.biff==5;n||(n=U(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function Eg(e){var t=U(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Sg(e,t,r,n,i,s){var a=U(8);return Nr(e,t,n,a),q0(r,s,a),a}function Ag(e,t,r,n){var i=U(14);return Nr(e,t,n,i),Mr(r,i),i}function Cg(e,t,r){if(r.biff<8)return Fg(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(ug(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function Fg(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Y0(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function kg(e){var t=U(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Z0(e[r],t);return t}function Pg(e){var t=U(24),r=qe(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return et([t,fg(e[1])])}function Og(e){var t=e[1].Tooltip,r=U(10+2*(t.length+1));r.write_shift(2,2048);var n=qe(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function bg(e){return e||(e=U(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Rg(e,t,r){if(!r.cellStyles)return Kt(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Dg(e,t){var r=U(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Ig(e){for(var t=U(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Lg(e,t,r){var n=U(15);return Ti(n,e,t),n.write_shift(8,r,"f"),n}function Mg(e,t,r){var n=U(9);return Ti(n,e,t),n.write_shift(2,r),n}var Ng=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Xa({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=Lr(1);switch(l.type){case"base64":f=Mt(tr(o));break;case"binary":f=Mt(o);break;case"buffer":case"array":f=o;break}wt(f,0);var u=f.read_shift(1),h=!!(u&136),d=!1,m=!1;switch(u){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,g=521;u==2&&(p=f.read_shift(2)),f.l+=3,u!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),u!=2&&(g=f.read_shift(2));var S=f.read_shift(2),A=l.codepage||1252;u!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(A=e[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var T=[],k={},b=Math.min(f.length,u==2?521:g-10-(d?264:0)),W=m?32:11;f.l<b&&f[f.l]!=13;)switch(k={},k.name=Ol.utils.decode(A,f.slice(f.l,f.l+W)).replace(/[\u0000\r\n].*$/g,""),f.l+=W,k.type=String.fromCharCode(f.read_shift(1)),u!=2&&!m&&(k.offset=f.read_shift(4)),k.len=f.read_shift(1),u==2&&(k.offset=f.read_shift(2)),k.dec=f.read_shift(1),k.name.length&&T.push(k),u!=2&&(f.l+=m?13:14),k.type){case"B":(!d||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var F=0,I=0;for(c[0]=[],I=0;I!=T.length;++I)c[0][I]=T[I].name;for(;p-- >0;){if(f[f.l]===42){f.l+=S;continue}for(++f.l,c[++F]=[],I=0,I=0;I!=T.length;++I){var R=f.slice(f.l,f.l+T[I].len);f.l+=T[I].len,wt(R,0);var V=Ol.utils.decode(A,R);switch(T[I].type){case"C":V.trim().length&&(c[F][I]=V.replace(/\s+$/,""));break;case"D":V.length===8?c[F][I]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):c[F][I]=V;break;case"F":c[F][I]=parseFloat(V.trim());break;case"+":case"I":c[F][I]=m?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":c[F][I]=!0;break;case"N":case"F":c[F][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));c[F][I]="##MEMO##"+(m?parseInt(V.trim(),10):R.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(c[F][I]=+V||0);break;case"@":c[F][I]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":c[F][I]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":c[F][I]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[F][I]=-R.read_shift(-8,"f");break;case"B":if(d&&T[I].len==8){c[F][I]=R.read_shift(8,"f");break}case"G":case"P":R.l+=T[I].len;break;case"0":if(T[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[I].type)}}}if(u!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=T,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=En(r(o,c),c);return f["!cols"]=c.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete c.DBF,f}function i(o,l){try{return Ur(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&ti(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=gt(),u=us(o,{header:1,raw:!0,cellDates:!0}),h=u[0],d=u.slice(1),m=o["!cols"]||[],p=0,g=0,S=0,A=1;for(p=0;p<h.length;++p){if(((m[p]||{}).DBF||{}).name){h[p]=m[p].DBF.name,++S;continue}if(h[p]!=null){if(++S,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var T=be(o["!ref"]),k=[],b=[],W=[];for(p=0;p<=T.e.c-T.s.c;++p){var F="",I="",R=0,V=[];for(g=0;g<d.length;++g)d[g][p]!=null&&V.push(d[g][p]);if(V.length==0||h[p]==null){k[p]="?";continue}for(g=0;g<V.length;++g){switch(typeof V[g]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=V[g]instanceof Date?"D":"C";break;default:I="C"}R=Math.max(R,String(V[g]).length),F=F&&F!=I?"C":I}R>250&&(R=250),I=((m[p]||{}).DBF||{}).type,I=="C"&&m[p].DBF.len>R&&(R=m[p].DBF.len),F=="B"&&I=="N"&&(F="N",W[p]=m[p].DBF.dec,R=m[p].DBF.len),b[p]=F=="C"||I=="N"?R:s[F]||0,A+=b[p],k[p]=F}var H=f.next(32);for(H.write_shift(4,318902576),H.write_shift(4,d.length),H.write_shift(2,296+32*S),H.write_shift(2,A),p=0;p<4;++p)H.write_shift(4,0);for(H.write_shift(4,0|(+t[e0]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var z=f.next(32),te=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,te,"sbcs"),z.write_shift(1,k[p]=="?"?"C":k[p],"sbcs"),z.write_shift(4,g),z.write_shift(1,b[p]||s[k[p]]||0),z.write_shift(1,W[p]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),g+=b[p]||s[k[p]]||0}var _e=f.next(264);for(_e.write_shift(4,13),p=0;p<65;++p)_e.write_shift(4,0);for(p=0;p<d.length;++p){var he=f.next(A);for(he.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(k[g]){case"L":he.write_shift(1,d[p][g]==null?63:d[p][g]?84:70);break;case"B":he.write_shift(8,d[p][g]||0,"f");break;case"N":var Y="0";for(typeof d[p][g]=="number"&&(Y=d[p][g].toFixed(W[g]||0)),S=0;S<b[g]-Y.length;++S)he.write_shift(1,32);he.write_shift(1,Y,"sbcs");break;case"D":d[p][g]?(he.write_shift(4,("0000"+d[p][g].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(d[p][g].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+d[p][g].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(d[p][g]!=null?d[p][g]:"").slice(0,b[g]);for(he.write_shift(1,ee,"sbcs"),S=0;S<b[g]-ee.length;++S)he.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),Bg=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+nt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,d){var m=e[d];return typeof m=="number"?Pl(m):m},n=function(h,d,m){var p=d.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?h:Pl(p)};e["|"]=254;function i(h,d){switch(d.type){case"base64":return s(tr(h),d);case"binary":return s(h,d);case"buffer":return s(Te&&Buffer.isBuffer(h)?h.toString("binary"):vi(h),d);case"array":return s(Ts(h),d)}throw new Error("Unrecognized type "+d.type)}function s(h,d){var m=h.split(/[\n\r]+/),p=-1,g=-1,S=0,A=0,T=[],k=[],b=null,W={},F=[],I=[],R=[],V=0,H;for(+d.codepage>=0&&ti(+d.codepage);S!==m.length;++S){V=0;var z=m[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),te=z.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),_e=te[0],he;if(z.length>0)switch(_e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&k.push(z.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,ee=!1,oe=!1,de=!1,xe=-1,Ge=-1;for(A=1;A<te.length;++A)switch(te[A].charAt(0)){case"A":break;case"X":g=parseInt(te[A].slice(1))-1,ee=!0;break;case"Y":for(p=parseInt(te[A].slice(1))-1,ee||(g=0),H=T.length;H<=p;++H)T[H]=[];break;case"K":he=te[A].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(Qt(he))?isNaN(ni(he).getDate())||(he=dt(he)):(he=Qt(he),b!==null&&h0(b)&&(he=g0(he))),Y=!0;break;case"E":de=!0;var C=Mv(te[A].slice(1),{r:p,c:g});T[p][g]=[T[p][g],C];break;case"S":oe=!0,T[p][g]=[T[p][g],"S5S"];break;case"G":break;case"R":xe=parseInt(te[A].slice(1))-1;break;case"C":Ge=parseInt(te[A].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+z)}if(Y&&(T[p][g]&&T[p][g].length==2?T[p][g][0]=he:T[p][g]=he,b=null),oe){if(de)throw new Error("SYLK shared formula cannot have own formula");var N=xe>-1&&T[xe][Ge];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");T[p][g][1]=Nv(N[1],{r:p-xe,c:g-Ge})}break;case"F":var O=0;for(A=1;A<te.length;++A)switch(te[A].charAt(0)){case"X":g=parseInt(te[A].slice(1))-1,++O;break;case"Y":for(p=parseInt(te[A].slice(1))-1,H=T.length;H<=p;++H)T[H]=[];break;case"M":V=parseInt(te[A].slice(1))/20;break;case"F":break;case"G":break;case"P":b=k[parseInt(te[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=te[A].slice(1).split(" "),H=parseInt(R[0],10);H<=parseInt(R[1],10);++H)V=parseInt(R[2],10),I[H-1]=V===0?{hidden:!0}:{wch:V},ao(I[H-1]);break;case"C":g=parseInt(te[A].slice(1))-1,I[g]||(I[g]={});break;case"R":p=parseInt(te[A].slice(1))-1,F[p]||(F[p]={}),V>0?(F[p].hpt=V,F[p].hpx=nu(V)):V===0&&(F[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+z)}O<1&&(b=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+z)}}return F.length>0&&(W["!rows"]=F),I.length>0&&(W["!cols"]=I),d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),[T,W]}function a(h,d){var m=i(h,d),p=m[0],g=m[1],S=En(p,d);return nt(g).forEach(function(A){S[A]=g[A]}),S}function o(h,d){return Ur(a(h,d),d)}function l(h,d,m,p){var g="C;Y"+(m+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+lo(h.f,{r:m,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(h,d){d.forEach(function(m,p){var g="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=os(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=ls(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function f(h,d){d.forEach(function(m,p){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*cs(m.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function u(h,d){var m=["ID;PWXL;N;E"],p=[],g=be(h["!ref"]),S,A=Array.isArray(h),T=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&c(m,h["!cols"]),h["!rows"]&&f(m,h["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var k=g.s.r;k<=g.e.r;++k)for(var b=g.s.c;b<=g.e.c;++b){var W=Fe({r:k,c:b});S=A?(h[k]||[])[b]:h[W],!(!S||S.v==null&&(!S.f||S.F))&&p.push(l(S,h,k,b))}return m.join(T)+T+p.join(T)+T+"E"+T}return{to_workbook:o,to_sheet:a,from_sheet:u}}(),Ug=function(){function e(s,a){switch(a.type){case"base64":return t(tr(s),a);case"binary":return t(s,a);case"buffer":return t(Te&&Buffer.isBuffer(s)?s.toString("binary"):vi(s),a);case"array":return t(Ts(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,f=0,u=[];f!==o.length;++f){if(o[f].trim()==="BOT"){u[++l]=[],c=0;continue}if(!(l<0)){var h=o[f].trim().split(","),d=h[0],m=h[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+d){case-1:if(p==="BOT"){u[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?u[l][c]=!0:p==="FALSE"?u[l][c]=!1:isNaN(Qt(m))?isNaN(ni(m).getDate())?u[l][c]=m:u[l][c]=dt(m):u[l][c]=Qt(m),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(u=u.slice(0,a.sheetRows)),u}function r(s,a){return En(e(s,a),a)}function n(s,a){return Ur(r(s,a),a)}var i=function(){var s=function(l,c,f,u,h){l.push(c),l.push(f+","+u),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,f,u){l.push(c+","+f),l.push(c==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(l){var c=[],f=be(l["!ref"]),u,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){a(c,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var p=Fe({r:d,c:m});if(u=h?(l[d]||[])[m]:l[p],!u){a(c,1,0,"");continue}switch(u.t){case"n":var g=u.w;!g&&u.v!=null&&(g=u.v),g==null?u.f&&!u.F?a(c,1,0,"="+u.f):a(c,1,0,""):a(c,0,g,"V");break;case"b":a(c,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=pr(u.z||Ue[14],vt(dt(u.v)))),a(c,0,u.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var S=`\r
`,A=c.join(S);return A}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Q0=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(u,h){for(var d=u.split(`
`),m=-1,p=-1,g=0,S=[];g!==d.length;++g){var A=d[g].trim().split(":");if(A[0]==="cell"){var T=qe(A[1]);if(S.length<=T.r)for(m=S.length;m<=T.r;++m)S[m]||(S[m]=[]);switch(m=T.r,p=T.c,A[2]){case"t":S[m][p]=e(A[3]);break;case"v":S[m][p]=+A[3];break;case"vtf":var k=A[A.length-1];case"vtc":switch(A[3]){case"nl":S[m][p]=!!+A[4];break;default:S[m][p]=+A[4];break}A[2]=="vtf"&&(S[m][p]=[S[m][p],k])}}}return h&&h.sheetRows&&(S=S.slice(0,h.sheetRows)),S}function n(u,h){return En(r(u,h),h)}function i(u,h){return Ur(n(u,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(u){if(!u||!u["!ref"])return"";for(var h=[],d=[],m,p="",g=St(u["!ref"]),S=Array.isArray(u),A=g.s.r;A<=g.e.r;++A)for(var T=g.s.c;T<=g.e.c;++T)if(p=Fe({r:A,c:T}),m=S?(u[A]||[])[T]:u[p],!(!m||m.v==null||m.t==="z")){switch(d=["cell",p,"t"],m.t){case"s":case"str":d.push(t(m.v));break;case"n":m.f?(d[2]="vtf",d[3]="n",d[4]=m.v,d[5]=t(m.f)):(d[2]="v",d[3]=m.v);break;case"b":d[2]="vt"+(m.f?"f":"c"),d[3]="nl",d[4]=m.v?"1":"0",d[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var k=vt(dt(m.v));d[2]="vtc",d[3]="nd",d[4]=""+k,d[5]=m.w||pr(m.z||Ue[14],k);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(u){return[s,a,o,a,c(u),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),jg=function(){function e(f,u,h,d,m){m.raw?u[h][d]=f:f===""||(f==="TRUE"?u[h][d]=!0:f==="FALSE"?u[h][d]=!1:isNaN(Qt(f))?isNaN(ni(f).getDate())?u[h][d]=f:u[h][d]=dt(f):u[h][d]=Qt(f))}function t(f,u){var h=u||{},d=[];if(!f||f.length===0)return d;for(var m=f.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var g=10,S=0,A=0;A<=p;++A)S=m[A].indexOf(" "),S==-1?S=m[A].length:S++,g=Math.max(g,S);for(A=0;A<=p;++A){d[A]=[];var T=0;for(e(m[A].slice(0,g).trim(),d,A,T,h),T=1;T<=(m[A].length-g)/10+1;++T)e(m[A].slice(g+(T-1)*10,g+T*10).trim(),d,A,T,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var u={},h=!1,d=0,m=0;d<f.length;++d)(m=f.charCodeAt(d))==34?h=!h:!h&&m in r&&(u[m]=(u[m]||0)+1);m=[];for(d in u)Object.prototype.hasOwnProperty.call(u,d)&&m.push([u[d],d]);if(!m.length){u=n;for(d in u)Object.prototype.hasOwnProperty.call(u,d)&&m.push([u[d],d])}return m.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[m.pop()[1]]||44}function s(f,u){var h=u||{},d="",m=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=i(f.slice(0,1024)):h&&h.FS?d=h.FS:d=i(f.slice(0,1024));var g=0,S=0,A=0,T=0,k=0,b=d.charCodeAt(0),W=!1,F=0,I=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var R=h.dateNF!=null?rm(h.dateNF):null;function V(){var H=f.slice(T,k),z={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)z.t="z";else if(h.raw)z.t="s",z.v=H;else if(H.trim().length===0)z.t="s",z.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(z.t="s",z.v=H.slice(2,-1).replace(/""/g,'"')):Bv(H)?(z.t="n",z.f=H.slice(1)):(z.t="s",z.v=H);else if(H=="TRUE")z.t="b",z.v=!0;else if(H=="FALSE")z.t="b",z.v=!1;else if(!isNaN(A=Qt(H)))z.t="n",h.cellText!==!1&&(z.w=H),z.v=A;else if(!isNaN(ni(H).getDate())||R&&H.match(R)){z.z=h.dateNF||Ue[14];var te=0;R&&H.match(R)&&(H=nm(H,h.dateNF,H.match(R)||[]),te=1),h.cellDates?(z.t="d",z.v=dt(H,te)):(z.t="n",z.v=vt(dt(H,te))),h.cellText!==!1&&(z.w=pr(z.z,z.v instanceof Date?vt(z.v):z.v)),h.cellNF||delete z.z}else z.t="s",z.v=H;if(z.t=="z"||(h.dense?(m[g]||(m[g]=[]),m[g][S]=z):m[Fe({c:S,r:g})]=z),T=k+1,I=f.charCodeAt(T),p.e.c<S&&(p.e.c=S),p.e.r<g&&(p.e.r=g),F==b)++S;else if(S=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;k<f.length;++k)switch(F=f.charCodeAt(k)){case 34:I===34&&(W=!W);break;case b:case 10:case 13:if(!W&&V())break e;break}return k-T>0&&V(),m["!ref"]=$e(p),m}function a(f,u){return!(u&&u.PRN)||u.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,u):En(t(f,u),u)}function o(f,u){var h="",d=u.type=="string"?[0,0,0,0]:Zw(f,u);switch(u.type){case"base64":h=tr(f);break;case"binary":h=f;break;case"buffer":u.codepage==65001?h=f.toString("utf8"):(u.codepage,h=Te&&Buffer.isBuffer(f)?f.toString("binary"):vi(f));break;case"array":h=Ts(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+u.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=Hn(h.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?h=Hn(h):u.type=="binary",h.slice(0,19)=="socialcalc:version:"?Q0.to_sheet(u.type=="string"?h:Hn(h),u):a(h,u)}function l(f,u){return Ur(o(f,u),u)}function c(f){for(var u=[],h=be(f["!ref"]),d,m=Array.isArray(f),p=h.s.r;p<=h.e.r;++p){for(var g=[],S=h.s.c;S<=h.e.c;++S){var A=Fe({r:p,c:S});if(d=m?(f[p]||[])[S]:f[A],!d||d.v==null){g.push("          ");continue}for(var T=(d.w||(rr(d),d.w)||"").slice(0,10);T.length<10;)T+=" ";g.push(T+(S===0?" ":""))}u.push(g.join(""))}return u.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}(),oc=function(){function e(C,N,O){if(C){wt(C,C.l||0);for(var P=O.Enum||xe;C.l<C.length;){var K=C.read_shift(2),ce=P[K]||P[65535],fe=C.read_shift(2),ae=C.l+fe,re=ce.f&&ce.f(C,fe,O);if(C.l=ae,N(re,ce,K))return}}}function t(C,N){switch(N.type){case"base64":return r(Mt(tr(C)),N);case"binary":return r(Mt(C),N);case"buffer":case"array":return r(C,N)}throw"Unsupported type "+N.type}function r(C,N){if(!C)return C;var O=N||{},P=O.dense?[]:{},K="Sheet1",ce="",fe=0,ae={},re=[],Pe=[],ye={s:{r:0,c:0},e:{r:0,c:0}},ct=O.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)O.Enum=xe,e(C,function(se,At,Xt){switch(Xt){case 0:O.vers=se,se>=4096&&(O.qpro=!0);break;case 6:ye=se;break;case 204:se&&(ce=se);break;case 222:ce=se;break;case 15:case 51:O.qpro||(se[1].v=se[1].v.slice(1));case 13:case 14:case 16:Xt==14&&(se[2]&112)==112&&(se[2]&15)>1&&(se[2]&15)<15&&(se[1].z=O.dateNF||Ue[14],O.cellDates&&(se[1].t="d",se[1].v=g0(se[1].v))),O.qpro&&se[3]>fe&&(P["!ref"]=$e(ye),ae[K]=P,re.push(K),P=O.dense?[]:{},ye={s:{r:0,c:0},e:{r:0,c:0}},fe=se[3],K=ce||"Sheet"+(fe+1),ce="");var Tr=O.dense?(P[se[0].r]||[])[se[0].c]:P[Fe(se[0])];if(Tr){Tr.t=se[1].t,Tr.v=se[1].v,se[1].z!=null&&(Tr.z=se[1].z),se[1].f!=null&&(Tr.f=se[1].f);break}O.dense?(P[se[0].r]||(P[se[0].r]=[]),P[se[0].r][se[0].c]=se[1]):P[Fe(se[0])]=se[1];break}},O);else if(C[2]==26||C[2]==14)O.Enum=Ge,C[2]==14&&(O.qpro=!0,C.l=0),e(C,function(se,At,Xt){switch(Xt){case 204:K=se;break;case 22:se[1].v=se[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(se[3]>fe&&(P["!ref"]=$e(ye),ae[K]=P,re.push(K),P=O.dense?[]:{},ye={s:{r:0,c:0},e:{r:0,c:0}},fe=se[3],K="Sheet"+(fe+1)),ct>0&&se[0].r>=ct)break;O.dense?(P[se[0].r]||(P[se[0].r]=[]),P[se[0].r][se[0].c]=se[1]):P[Fe(se[0])]=se[1],ye.e.c<se[0].c&&(ye.e.c=se[0].c),ye.e.r<se[0].r&&(ye.e.r=se[0].r);break;case 27:se[14e3]&&(Pe[se[14e3][0]]=se[14e3][1]);break;case 1537:Pe[se[0]]=se[1],se[0]==fe&&(K=se[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(P["!ref"]=$e(ye),ae[ce||K]=P,re.push(ce||K),!Pe.length)return{SheetNames:re,Sheets:ae};for(var Ee={},zt=[],Me=0;Me<Pe.length;++Me)ae[re[Me]]?(zt.push(Pe[Me]||re[Me]),Ee[Pe[Me]]=ae[Pe[Me]]||ae[re[Me]]):(zt.push(Pe[Me]),Ee[Pe[Me]]={"!ref":"A1"});return{SheetNames:zt,Sheets:Ee}}function n(C,N){var O=N||{};if(+O.codepage>=0&&ti(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var P=gt(),K=be(C["!ref"]),ce=Array.isArray(C),fe=[];Z(P,0,s(1030)),Z(P,6,l(K));for(var ae=Math.min(K.e.r,8191),re=K.s.r;re<=ae;++re)for(var Pe=rt(re),ye=K.s.c;ye<=K.e.c;++ye){re===K.s.r&&(fe[ye]=ot(ye));var ct=fe[ye]+Pe,Ee=ce?(C[re]||[])[ye]:C[ct];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")(Ee.v|0)==Ee.v&&Ee.v>=-32768&&Ee.v<=32767?Z(P,13,d(re,ye,Ee.v)):Z(P,14,p(re,ye,Ee.v));else{var zt=rr(Ee);Z(P,15,u(re,ye,zt.slice(0,239)))}}return Z(P,1),P.end()}function i(C,N){var O=N||{};if(+O.codepage>=0&&ti(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var P=gt();Z(P,0,a(C));for(var K=0,ce=0;K<C.SheetNames.length;++K)(C.Sheets[C.SheetNames[K]]||{})["!ref"]&&Z(P,27,de(C.SheetNames[K],ce++));var fe=0;for(K=0;K<C.SheetNames.length;++K){var ae=C.Sheets[C.SheetNames[K]];if(!(!ae||!ae["!ref"])){for(var re=be(ae["!ref"]),Pe=Array.isArray(ae),ye=[],ct=Math.min(re.e.r,8191),Ee=re.s.r;Ee<=ct;++Ee)for(var zt=rt(Ee),Me=re.s.c;Me<=re.e.c;++Me){Ee===re.s.r&&(ye[Me]=ot(Me));var se=ye[Me]+zt,At=Pe?(ae[Ee]||[])[Me]:ae[se];if(!(!At||At.t=="z"))if(At.t=="n")Z(P,23,V(Ee,Me,fe,At.v));else{var Xt=rr(At);Z(P,22,F(Ee,Me,fe,Xt.slice(0,239)))}}++fe}}return Z(P,1),P.end()}function s(C){var N=U(2);return N.write_shift(2,C),N}function a(C){var N=U(26);N.write_shift(2,4096),N.write_shift(2,4),N.write_shift(4,0);for(var O=0,P=0,K=0,ce=0;ce<C.SheetNames.length;++ce){var fe=C.SheetNames[ce],ae=C.Sheets[fe];if(!(!ae||!ae["!ref"])){++K;var re=St(ae["!ref"]);O<re.e.r&&(O=re.e.r),P<re.e.c&&(P=re.e.c)}}return O>8191&&(O=8191),N.write_shift(2,O),N.write_shift(1,K),N.write_shift(1,P),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(1,1),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(4,0),N}function o(C,N,O){var P={s:{c:0,r:0},e:{c:0,r:0}};return N==8&&O.qpro?(P.s.c=C.read_shift(1),C.l++,P.s.r=C.read_shift(2),P.e.c=C.read_shift(1),C.l++,P.e.r=C.read_shift(2),P):(P.s.c=C.read_shift(2),P.s.r=C.read_shift(2),N==12&&O.qpro&&(C.l+=2),P.e.c=C.read_shift(2),P.e.r=C.read_shift(2),N==12&&O.qpro&&(C.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function l(C){var N=U(8);return N.write_shift(2,C.s.c),N.write_shift(2,C.s.r),N.write_shift(2,C.e.c),N.write_shift(2,C.e.r),N}function c(C,N,O){var P=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(P[0].c=C.read_shift(1),P[3]=C.read_shift(1),P[0].r=C.read_shift(2),C.l+=2):(P[2]=C.read_shift(1),P[0].c=C.read_shift(2),P[0].r=C.read_shift(2)),P}function f(C,N,O){var P=C.l+N,K=c(C,N,O);if(K[1].t="s",O.vers==20768){C.l++;var ce=C.read_shift(1);return K[1].v=C.read_shift(ce,"utf8"),K}return O.qpro&&C.l++,K[1].v=C.read_shift(P-C.l,"cstr"),K}function u(C,N,O){var P=U(7+O.length);P.write_shift(1,255),P.write_shift(2,N),P.write_shift(2,C),P.write_shift(1,39);for(var K=0;K<P.length;++K){var ce=O.charCodeAt(K);P.write_shift(1,ce>=128?95:ce)}return P.write_shift(1,0),P}function h(C,N,O){var P=c(C,N,O);return P[1].v=C.read_shift(2,"i"),P}function d(C,N,O){var P=U(7);return P.write_shift(1,255),P.write_shift(2,N),P.write_shift(2,C),P.write_shift(2,O,"i"),P}function m(C,N,O){var P=c(C,N,O);return P[1].v=C.read_shift(8,"f"),P}function p(C,N,O){var P=U(13);return P.write_shift(1,255),P.write_shift(2,N),P.write_shift(2,C),P.write_shift(8,O,"f"),P}function g(C,N,O){var P=C.l+N,K=c(C,N,O);if(K[1].v=C.read_shift(8,"f"),O.qpro)C.l=P;else{var ce=C.read_shift(2);k(C.slice(C.l,C.l+ce),K),C.l+=ce}return K}function S(C,N,O){var P=N&32768;return N&=-32769,N=(P?C:0)+(N>=8192?N-16384:N),(P?"":"$")+(O?ot(N):rt(N))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(C,N){wt(C,0);for(var O=[],P=0,K="",ce="",fe="",ae="";C.l<C.length;){var re=C[C.l++];switch(re){case 0:O.push(C.read_shift(8,"f"));break;case 1:ce=S(N[0].c,C.read_shift(2),!0),K=S(N[0].r,C.read_shift(2),!1),O.push(ce+K);break;case 2:{var Pe=S(N[0].c,C.read_shift(2),!0),ye=S(N[0].r,C.read_shift(2),!1);ce=S(N[0].c,C.read_shift(2),!0),K=S(N[0].r,C.read_shift(2),!1),O.push(Pe+ye+":"+ce+K)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(C.read_shift(2));break;case 6:{for(var ct="";re=C[C.l++];)ct+=String.fromCharCode(re);O.push('"'+ct.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:ae=O.pop(),fe=O.pop(),O.push(["AND","OR"][re-20]+"("+fe+","+ae+")");break;default:if(re<32&&T[re])ae=O.pop(),fe=O.pop(),O.push(fe+T[re]+ae);else if(A[re]){if(P=A[re][1],P==69&&(P=C[C.l++]),P>O.length){console.error("WK1 bad formula parse 0x"+re.toString(16)+":|"+O.join("|")+"|");return}var Ee=O.slice(-P);O.length-=P,O.push(A[re][0]+"("+Ee.join(",")+")")}else return re<=7?console.error("WK1 invalid opcode "+re.toString(16)):re<=24?console.error("WK1 unsupported op "+re.toString(16)):re<=30?console.error("WK1 invalid opcode "+re.toString(16)):re<=115?console.error("WK1 unsupported function opcode "+re.toString(16)):console.error("WK1 unrecognized opcode "+re.toString(16))}}O.length==1?N[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function b(C){var N=[{c:0,r:0},{t:"n",v:0},0];return N[0].r=C.read_shift(2),N[3]=C[C.l++],N[0].c=C[C.l++],N}function W(C,N){var O=b(C);return O[1].t="s",O[1].v=C.read_shift(N-4,"cstr"),O}function F(C,N,O,P){var K=U(6+P.length);K.write_shift(2,C),K.write_shift(1,O),K.write_shift(1,N),K.write_shift(1,39);for(var ce=0;ce<P.length;++ce){var fe=P.charCodeAt(ce);K.write_shift(1,fe>=128?95:fe)}return K.write_shift(1,0),K}function I(C,N){var O=b(C);O[1].v=C.read_shift(2);var P=O[1].v>>1;if(O[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return O[1].v=P,O}function R(C,N){var O=b(C),P=C.read_shift(4),K=C.read_shift(4),ce=C.read_shift(2);if(ce==65535)return P===0&&K===3221225472?(O[1].t="e",O[1].v=15):P===0&&K===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var fe=ce&32768;return ce=(ce&32767)-16446,O[1].v=(1-fe*2)*(K*Math.pow(2,ce+32)+P*Math.pow(2,ce)),O}function V(C,N,O,P){var K=U(14);if(K.write_shift(2,C),K.write_shift(1,O),K.write_shift(1,N),P==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var ce=0,fe=0,ae=0,re=0;return P<0&&(ce=1,P=-P),fe=Math.log2(P)|0,P/=Math.pow(2,fe-31),re=P>>>0,(re&2147483648)==0&&(P/=2,++fe,re=P>>>0),P-=re,re|=2147483648,re>>>=0,P*=Math.pow(2,32),ae=P>>>0,K.write_shift(4,ae),K.write_shift(4,re),fe+=16383+(ce?32768:0),K.write_shift(2,fe),K}function H(C,N){var O=R(C);return C.l+=N-14,O}function z(C,N){var O=b(C),P=C.read_shift(4);return O[1].v=P>>6,O}function te(C,N){var O=b(C),P=C.read_shift(8,"f");return O[1].v=P,O}function _e(C,N){var O=te(C);return C.l+=N-10,O}function he(C,N){return C[C.l+N-1]==0?C.read_shift(N,"cstr"):""}function Y(C,N){var O=C[C.l++];O>N-1&&(O=N-1);for(var P="";P.length<O;)P+=String.fromCharCode(C[C.l++]);return P}function ee(C,N,O){if(!(!O.qpro||N<21)){var P=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var K=C.read_shift(N-21,"cstr");return[P,K]}}function oe(C,N){for(var O={},P=C.l+N;C.l<P;){var K=C.read_shift(2);if(K==14e3){for(O[K]=[0,""],O[K][0]=C.read_shift(2);C[C.l];)O[K][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return O}function de(C,N){var O=U(5+C.length);O.write_shift(2,14e3),O.write_shift(2,N);for(var P=0;P<C.length;++P){var K=C.charCodeAt(P);O[O.l++]=K>127?95:K}return O[O.l++]=0,O}var xe={0:{n:"BOF",f:X0},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},Ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:_e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}(),Vg=/^\s|\s$|[\t\n\r]/;function eu(e,t){if(!t.bookSST)return"";var r=[We];r[r.length]=J("sst",null,{xmlns:Tn[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Vg)&&(s+=' xml:space="preserve"'),s+=">"+Ce(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function $g(e){return[e.read_shift(4),e.read_shift(4)]}function Wg(e,t){return t||(t=U(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Hg=Im;function Gg(e){var t=gt();G(t,159,Wg(e));for(var r=0;r<e.length;++r)G(t,19,Hg(e[r]));return G(t,160),t.end()}function Kg(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function tu(e){var t=0,r,n=Kg(e),i=n.length+1,s,a,o,l,c;for(r=Lr(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=(t&16384)===0?0:1,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var zg=function(){function e(i,s){switch(s.type){case"base64":return t(tr(i),s);case"binary":return t(i,s);case"buffer":return t(Te&&Buffer.isBuffer(i)?i.toString("binary"):vi(i),s);case"array":return t(Ts(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,u){Array.isArray(o)&&(o[u]=[]);for(var h=/\\\w+\b/g,d=0,m,p=-1;m=h.exec(f);){switch(m[0]){case"\\cell":var g=f.slice(d,h.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var S={v:g,t:"s"};Array.isArray(o)?o[u][p]=S:o[Fe({r:u,c:p})]=S}break}d=h.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=$e(c),o}function r(i,s){return Ur(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=be(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var u=Fe({r:c,c:f});o=l?(i[c]||[])[f]:i[u],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(rr(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function lc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Xg=6,er=Xg;function os(e){return Math.floor((e+Math.round(128/er)/256)*er)}function ls(e){return Math.floor((e-5)/er*100+.5)/100}function wa(e){return Math.round((e*er+5)/er*256)/256}function ao(e){e.width?(e.wpx=os(e.width),e.wch=ls(e.wpx),e.MDW=er):e.wpx?(e.wch=ls(e.wpx),e.width=wa(e.wch),e.MDW=er):typeof e.wch=="number"&&(e.width=wa(e.wch),e.wpx=os(e.width),e.MDW=er),e.customWidth&&delete e.customWidth}var qg=96,ru=qg;function cs(e){return e*96/ru}function nu(e){return e*ru/96}function Yg(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=J("numFmt",null,{numFmtId:n,formatCode:Ce(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=J("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Jg(e){var t=[];return t[t.length]=J("cellXfs",null),e.forEach(function(r){t[t.length]=J("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=J("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function iu(e,t){var r=[We,J("styleSheet",null,{xmlns:Tn[0],"xmlns:vt":Xe.vt})],n;return e.SSF&&(n=Yg(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Jg(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Zg(e,t){var r=e.read_shift(2),n=lt(e);return[r,n]}function Qg(e,t,r){r||(r=U(6+4*t.length)),r.write_shift(2,e),Ye(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function ev(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Vm(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=jm(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=lt(e),n}function tv(e,t){t||(t=U(25+4*32)),t.write_shift(2,e.sz*20),$m(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ss(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ye(e.name,t),t.length>t.l?t.slice(0,t.l):t}var rv=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],zs,nv=Kt;function cc(e,t){t||(t=U(4*3+8*7+16*1)),zs||(zs=Xa(rv));var r=zs[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(ss({auto:1},t),ss({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function iv(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function su(e,t,r){r||(r=U(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function In(e,t){return t||(t=U(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var sv=Kt;function av(e,t){return t||(t=U(51)),t.write_shift(1,0),In(null,t),In(null,t),In(null,t),In(null,t),In(null,t),t.length>t.l?t.slice(0,t.l):t}function ov(e,t){return t||(t=U(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),is(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function lv(e,t,r){var n=U(2052);return n.write_shift(4,e),is(t,n),is(r,n),n.length>n.l?n.slice(0,n.l):n}function cv(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(G(e,615,Bt(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&G(e,44,Qg(i,t[i]))}),G(e,616))}}function fv(e){var t=1;G(e,611,Bt(t)),G(e,43,tv({sz:12,color:{theme:1},name:"Calibri",family:2})),G(e,612)}function uv(e){var t=2;G(e,603,Bt(t)),G(e,45,cc({patternType:"none"})),G(e,45,cc({patternType:"gray125"})),G(e,604)}function hv(e){var t=1;G(e,613,Bt(t)),G(e,46,av()),G(e,614)}function dv(e){var t=1;G(e,626,Bt(t)),G(e,47,su({numFmtId:0},65535)),G(e,627)}function pv(e,t){G(e,617,Bt(t.length)),t.forEach(function(r){G(e,47,su(r,0))}),G(e,618)}function mv(e){var t=1;G(e,619,Bt(t)),G(e,48,ov({xfId:0,name:"Normal"})),G(e,620)}function gv(e){var t=0;G(e,505,Bt(t)),G(e,506)}function vv(e){var t=0;G(e,508,lv(t,"TableStyleMedium9","PivotStyleMedium4")),G(e,509)}function xv(e,t){var r=gt();return G(r,278),cv(r,e.SSF),fv(r),uv(r),hv(r),dv(r),pv(r,t.cellXfs),mv(r),gv(r),vv(r),G(r,279),r.end()}function au(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[We];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function _v(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:lt(e)}}function yv(e){var t=U(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ye(e.name,t),t.slice(0,t.l)}function wv(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Tv(e){var t=U(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Ev(e,t){var r=U(8+2*t.length);return r.write_shift(4,e),Ye(t,r),r.slice(0,r.l)}function Sv(e){return e.l+=4,e.read_shift(4)!=0}function Av(e,t){var r=U(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Cv(){var e=gt();return G(e,332),G(e,334,Bt(1)),G(e,335,yv({name:"XLDAPR",version:12e4,flags:3496657072})),G(e,336),G(e,339,Ev(1,"XLDAPR")),G(e,52),G(e,35,Bt(514)),G(e,4096,Bt(0)),G(e,4097,Pt(1)),G(e,36),G(e,53),G(e,340),G(e,337,Av(1)),G(e,51,Tv([[1,0]])),G(e,338),G(e,333),e.end()}function ou(){var e=[We];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Fv(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Fe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var sn=1024;function lu(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[J("xml",null,{"xmlns:v":Tt.v,"xmlns:o":Tt.o,"xmlns:x":Tt.x,"xmlns:mv":Tt.mv}).replace(/\/>/,">"),J("o:shapelayout",J("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),J("v:shapetype",[J("v:stroke",null,{joinstyle:"miter"}),J("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];sn<e*1e3;)sn+=1e3;return t.forEach(function(s){var a=qe(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?J("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=J("v:fill",l,o),f={on:"t",obscured:"t"};++sn,i=i.concat(["<v:shape"+si({id:"_x0000_s"+sn,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,J("v:shadow",null,f),J("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",tt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),tt("x:AutoFill","False"),tt("x:Row",String(a.r)),tt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function cu(e){var t=[We,J("comments",null,{xmlns:Tn[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Ce(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Ce(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(tt("t",Ce(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(tt("t",Ce(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function kv(e,t,r){var n=[We,J("ThreadedComments",null,{xmlns:Xe.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(J("threadedComment",tt("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function Pv(e){var t=[We,J("personList",null,{xmlns:Xe.TCMNT,"xmlns:x":Tn[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(J("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Ov(e){var t={};t.iauthor=e.read_shift(4);var r=Wr(e);return t.rfx=r.s,t.ref=Fe(r.s),e.l+=16,t}function bv(e,t){return t==null&&(t=U(36)),t.write_shift(4,e[1].iauthor),Sn(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Rv=lt;function Dv(e){return Ye(e.slice(0,54))}function Iv(e){var t=gt(),r=[];return G(t,628),G(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),G(t,632,Dv(i.a)))})}),G(t,631),G(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:qe(n[0]),e:qe(n[0])};G(t,635,bv([s,i])),i.t&&i.t.length>0&&G(t,637,Mm(i)),G(t,636),delete i.iauthor})}),G(t,634),G(t,629),t.end()}function Lv(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&ke.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var fu=["xlsb","xlsm","xlam","biff8","xla"],Mv=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,i+(o?"":"$")+ot(f)+(l?"":"$")+rt(c)}return function(i,s){return t=s,i.replace(e,r)}}(),oo=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,lo=function(){return function(t,r){return t.replace(oo,function(n,i,s,a,o,l){var c=to(a)-(s?0:r.c),f=eo(l)-(o?0:r.r),u=f==0?"":o?f+1:"["+f+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+u+"C"+h})}}();function Nv(e,t){return e.replace(oo,function(r,n,i,s,a,o){return n+(i=="$"?i+s:ot(to(s)+t.c))+(a=="$"?a+o:rt(eo(o)+t.r))})}function Bv(e){return e.length!=1}function Ve(e){e.l+=1}function mr(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function uu(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return hu(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=mr(e),o=mr(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function hu(e){var t=mr(e),r=mr(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function Uv(e,t,r){if(r.biff<8)return hu(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=mr(e),a=mr(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function du(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return jv(e);var n=e.read_shift(r&&r.biff==12?4:2),i=mr(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function jv(e){var t=mr(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Vv(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $v(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Wv(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function Wv(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function Hv(e,t,r){var n=(e[e.l++]&96)>>5,i=uu(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Gv(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=uu(e,s,r);return[n,i,a]}function Kv(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function zv(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function Xv(e,t,r){var n=(e[e.l++]&96)>>5,i=Uv(e,t-1,r);return[n,i]}function qv(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function fc(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Yv(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Jv(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Zv(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Qv(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function ex(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function pu(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function tx(e){return e.read_shift(2),pu(e)}function rx(e){return e.read_shift(2),pu(e)}function nx(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=du(e,0,r);return[n,i]}function ix(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=$v(e,0,r);return[n,i]}function sx(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=du(e,0,r);return[n,i,s]}function ax(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[a_[i],vu[i],n]}function ox(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:lx(e);return[i,(s[0]===0?vu:s_)[s[1]]]}function lx(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function cx(e,t,r){e.l+=r&&r.biff==2?3:4}function fx(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function ux(e){return e.l++,yi[e.read_shift(1)]}function hx(e){return e.l++,e.read_shift(2)}function dx(e){return e.l++,e.read_shift(1)!==0}function px(e){return e.l++,An(e)}function mx(e,t,r){return e.l++,Y0(e,t-1,r)}function gx(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=sg(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=yi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=An(e);break;case 2:r[1]=cg(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function vx(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Wr:hg)(e));return i}function xx(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=gx(e,r.biff);return a}function _x(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function yx(e,t,r){if(r.biff==5)return wx(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function wx(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Tx(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Ex(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Sx(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Ax(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var Cx=Kt,Fx=Kt,kx=Kt;function wi(e,t,r){return e.l+=2,[Vv(e)]}function co(e){return e.l+=6,[]}var Px=wi,Ox=co,bx=co,Rx=wi;function mu(e){return e.l+=2,[X0(e),e.read_shift(2)&1]}var Dx=wi,Ix=mu,Lx=co,Mx=wi,Nx=wi,Bx=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Ux(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=Bx[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function jx(e){return e.l+=2,[e.read_shift(4)]}function Vx(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function $x(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Wx(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Hx(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Gx(e){return e.l+=4,[0,0]}var uc={1:{n:"PtgExp",f:fx},2:{n:"PtgTbl",f:kx},3:{n:"PtgAdd",f:Ve},4:{n:"PtgSub",f:Ve},5:{n:"PtgMul",f:Ve},6:{n:"PtgDiv",f:Ve},7:{n:"PtgPower",f:Ve},8:{n:"PtgConcat",f:Ve},9:{n:"PtgLt",f:Ve},10:{n:"PtgLe",f:Ve},11:{n:"PtgEq",f:Ve},12:{n:"PtgGe",f:Ve},13:{n:"PtgGt",f:Ve},14:{n:"PtgNe",f:Ve},15:{n:"PtgIsect",f:Ve},16:{n:"PtgUnion",f:Ve},17:{n:"PtgRange",f:Ve},18:{n:"PtgUplus",f:Ve},19:{n:"PtgUminus",f:Ve},20:{n:"PtgPercent",f:Ve},21:{n:"PtgParen",f:Ve},22:{n:"PtgMissArg",f:Ve},23:{n:"PtgStr",f:mx},26:{n:"PtgSheet",f:Vx},27:{n:"PtgEndSheet",f:$x},28:{n:"PtgErr",f:ux},29:{n:"PtgBool",f:dx},30:{n:"PtgInt",f:hx},31:{n:"PtgNum",f:px},32:{n:"PtgArray",f:qv},33:{n:"PtgFunc",f:ax},34:{n:"PtgFuncVar",f:ox},35:{n:"PtgName",f:_x},36:{n:"PtgRef",f:nx},37:{n:"PtgArea",f:Hv},38:{n:"PtgMemArea",f:Tx},39:{n:"PtgMemErr",f:Cx},40:{n:"PtgMemNoMem",f:Fx},41:{n:"PtgMemFunc",f:Ex},42:{n:"PtgRefErr",f:Sx},43:{n:"PtgAreaErr",f:Kv},44:{n:"PtgRefN",f:ix},45:{n:"PtgAreaN",f:Xv},46:{n:"PtgMemAreaN",f:Wx},47:{n:"PtgMemNoMemN",f:Hx},57:{n:"PtgNameX",f:yx},58:{n:"PtgRef3d",f:sx},59:{n:"PtgArea3d",f:Gv},60:{n:"PtgRefErr3d",f:Ax},61:{n:"PtgAreaErr3d",f:zv},255:{}},Kx={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},zx={1:{n:"PtgElfLel",f:mu},2:{n:"PtgElfRw",f:Mx},3:{n:"PtgElfCol",f:Px},6:{n:"PtgElfRwV",f:Nx},7:{n:"PtgElfColV",f:Rx},10:{n:"PtgElfRadical",f:Dx},11:{n:"PtgElfRadicalS",f:Lx},13:{n:"PtgElfColS",f:Ox},15:{n:"PtgElfColSV",f:bx},16:{n:"PtgElfRadicalLel",f:Ix},25:{n:"PtgList",f:Ux},29:{n:"PtgSxName",f:jx},255:{}},Xx={0:{n:"PtgAttrNoop",f:Gx},1:{n:"PtgAttrSemi",f:ex},2:{n:"PtgAttrIf",f:Zv},4:{n:"PtgAttrChoose",f:Yv},8:{n:"PtgAttrGoto",f:Jv},16:{n:"PtgAttrSum",f:cx},32:{n:"PtgAttrBaxcel",f:fc},33:{n:"PtgAttrBaxcel",f:fc},64:{n:"PtgAttrSpace",f:tx},65:{n:"PtgAttrSpaceSemi",f:rx},128:{n:"PtgAttrIfError",f:Qv},255:{}};function qx(e,t,r,n){if(n.biff<8)return Kt(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=xx(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=vx(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(Kt(e,t)),s}function Yx(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=uc[s]||uc[Kx[s]],(s===24||s===25)&&(i=(s===24?zx:Xx)[e[e.l+1]]),!i||!i.f?Kt(e,t):a.push([i.n,i.f(e,t,r)]);return a}function Jx(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Zx={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Qx(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function gu(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function hc(e,t,r){var n=gu(e,t,r);return n=="#REF"?n:Qx(n,r)}function xn(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,f,u=0,h=0,d,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",S=0,A=e[0].length;S<A;++S){var T=e[0][S];switch(T[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Be(" ",e[0][p][1][1]);break;case 1:g=Be("\r",e[0][p][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+g,p=-1}o.push(c+Zx[T[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Kn(T[1][1],a,i),o.push(zn(f,s));break;case"PtgRefN":f=r?Kn(T[1][1],r,i):T[1][1],o.push(zn(f,s));break;case"PtgRef3d":u=T[1][1],f=Kn(T[1][2],a,i),m=hc(n,u,i),o.push(m+"!"+zn(f,s));break;case"PtgFunc":case"PtgFuncVar":var k=T[1][0],b=T[1][1];k||(k=0),k&=127;var W=k==0?[]:o.slice(-k);o.length-=k,b==="User"&&(b=W.shift()),o.push(b+"("+W.join(",")+")");break;case"PtgBool":o.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(T[1]);break;case"PtgNum":o.push(String(T[1]));break;case"PtgStr":o.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(T[1]);break;case"PtgAreaN":d=Yl(T[1][1],r?{s:r}:a,i),o.push(Gs(d,i));break;case"PtgArea":d=Yl(T[1][1],a,i),o.push(Gs(d,i));break;case"PtgArea3d":u=T[1][1],d=T[1][2],m=hc(n,u,i),o.push(m+"!"+Gs(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=T[1][2];var F=(n.names||[])[h-1]||(n[0]||[])[h],I=F?F.Name:"SH33TJSNAME"+String(h);I&&I.slice(0,6)=="_xlfn."&&!i.xlfn&&(I=I.slice(6)),o.push(I);break;case"PtgNameX":var R=T[1][1];h=T[1][2];var V;if(i.biff<=5)R<0&&(R=-R),n[R]&&(V=n[R][h]);else{var H="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][h]&&n[R][h].itab>0&&(H=n.SheetNames[n[R][h].itab-1]+"!"):H=n.SheetNames[h-1]+"!"),n[R]&&n[R][h])H+=n[R][h].Name;else if(n[0]&&n[0][h])H+=n[0][h].Name;else{var z=(gu(n,R,i)||"").split(";;");z[h-1]?H=z[h-1]:H+="SH33TJSERRX"}o.push(H);break}V||(V={Name:"SH33TJSERRY"}),o.push(V.Name);break;case"PtgParen":var te="(",_e=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:te=Be(" ",e[0][p][1][1])+te;break;case 3:te=Be("\r",e[0][p][1][1])+te;break;case 4:_e=Be(" ",e[0][p][1][1])+_e;break;case 5:_e=Be("\r",e[0][p][1][1])+_e;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(te+o.pop()+_e);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:T[1][1],r:T[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[Fe(f)]){var Y=n.sharedf[Fe(f)];o.push(xn(Y,a,he,n,i))}else{var ee=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(xn(c[1],a,he,n,i)),ee=!0;break}ee||o.push(T[1])}break;case"PtgArray":o.push("{"+Jx(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&oe.indexOf(e[0][S][0])==-1){T=e[0][p];var de=!0;switch(T[1][0]){case 4:de=!1;case 0:g=Be(" ",T[1][1]);break;case 5:de=!1;case 1:g=Be("\r",T[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}o.push((de?g:"")+o.pop()+(de?"":g)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function e_(e){if(e==null){var t=U(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Mr(e);return Mr(0)}function t_(e,t,r,n,i){var s=Nr(t,r,i),a=e_(e.v),o=U(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=U(e.bf.length),f=0;f<e.bf.length;++f)c[f]=e.bf[f];var u=et([s,a,o,c]);return u}function Es(e,t,r){var n=e.read_shift(4),i=Yx(e,n,r),s=e.read_shift(4),a=s>0?qx(e,s,i,r):null;return[i,a]}var r_=Es,Ss=Es,n_=Es,i_=Es,s_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vu={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},a_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function o_(e){var t="of:="+e.replace(oo,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function l_(e){return e.replace(/\./,"!")}var Xn=typeof Map<"u";function fo(e,t,r){var n=0,i=e.length;if(r){if(Xn?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Xn?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Xn?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function As(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(er=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ls(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=wa(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function xu(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function yr(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){d0(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function c_(e,t,r){if(e&&e["!ref"]){var n=be(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function f_(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+$e(e[r])+'"/>';return t+"</mergeCells>"}function u_(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=ii(Ce(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+J("outlinePr",null,c)}!s&&!o||(i[i.length]=J("sheetPr",o,a))}var h_=["objects","scenarios","selectLockedCells","selectUnlockedCells"],d_=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function p_(e){var t={sheet:1};return h_.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),d_.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=tu(e.password).toString(16).toUpperCase()),J("sheetProtection",null,t)}function m_(e){return xu(e),J("pageMargins",null,e)}function g_(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=J("col",null,As(i,n)));return r[r.length]="</cols>",r.join("")}function v_(e,t,r,n){var i=typeof e.ref=="string"?e.ref:$e(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=St(i);a.s.r==a.e.r&&(a.e.r=St(t["!ref"]).e.r,i=$e(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),J("autoFilter",null,{ref:i})}function x_(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),J("sheetViews",J("sheetView",null,i),{})}function __(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=yi[e.v];break;case"d":n&&n.cellDates?i=dt(e.v,-1).toISOString():(e=xt(e),e.t="n",i=""+(e.v=vt(dt(e.v)))),typeof e.z>"u"&&(e.z=Ue[14]);break;default:i=e.v;break}var o=tt("v",Ce(i)),l={r:t},c=yr(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=tt("v",""+fo(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=J("f",Ce(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),J("c",o,l)}function y_(e,t,r,n){var i=[],s=[],a=be(e["!ref"]),o="",l,c="",f=[],u=0,h=0,d=e["!rows"],m=Array.isArray(e),p={r:c},g,S=-1;for(h=a.s.c;h<=a.e.c;++h)f[h]=ot(h);for(u=a.s.r;u<=a.e.r;++u){for(s=[],c=rt(u),h=a.s.c;h<=a.e.c;++h){l=f[h]+c;var A=m?(e[u]||[])[h]:e[l];A!==void 0&&(o=__(A,l,e,t))!=null&&s.push(o)}(s.length>0||d&&d[u])&&(p={r:c},d&&d[u]&&(g=d[u],g.hidden&&(p.hidden=1),S=-1,g.hpx?S=cs(g.hpx):g.hpt&&(S=g.hpt),S>-1&&(p.ht=S,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),i[i.length]=J("row",s.join(""),p))}if(d)for(;u<d.length;++u)d&&d[u]&&(p={r:u+1},g=d[u],g.hidden&&(p.hidden=1),S=-1,g.hpx?S=cs(g.hpx):g.hpt&&(S=g.hpt),S>-1&&(p.ht=S,p.customHeight=1),g.level&&(p.outlineLevel=g.level),i[i.length]=J("row","",p));return i.join("")}function _u(e,t,r,n){var i=[We,J("worksheet",null,{xmlns:Tn[0],"xmlns:r":Xe.r})],s=r.SheetNames[e],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",f=be(c);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=$e(f)}n||(n={}),l["!comments"]=[];var u=[];u_(l,r,e,t,i),i[i.length]=J("dimension",null,{ref:c}),i[i.length]=x_(l,t,e,r),t.sheetFormat&&(i[i.length]=J("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=g_(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=y_(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=p_(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=v_(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=f_(l["!merges"]));var h=-1,d,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(d={ref:p[0]},p[1].Target.charAt(0)!="#"&&(m=Ae(n,-1,Ce(p[1].Target).replace(/#.*$/,""),we.HLINK),d["r:id"]="rId"+m),(h=p[1].Target.indexOf("#"))>-1&&(d.location=Ce(p[1].Target.slice(h+1))),p[1].Tooltip&&(d.tooltip=Ce(p[1].Tooltip)),i[i.length]=J("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=m_(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=tt("ignoredErrors",J("ignoredError",null,{numberStoredAsText:1,sqref:c}))),u.length>0&&(m=Ae(n,-1,"../drawings/drawing"+(e+1)+".xml",we.DRAW),i[i.length]=J("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=u),l["!comments"].length>0&&(m=Ae(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",we.VML),i[i.length]=J("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function w_(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function T_(e,t,r){var n=U(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=cs(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var u=-1,h=-1,d=f<<10;d<f+1<<10;++d){c.c=d;var m=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Fe(c)];m&&(u<0&&(u=d),h=d)}u<0||(++o,n.write_shift(4,u),n.write_shift(4,h))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function E_(e,t,r,n){var i=T_(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&G(e,0,i)}var S_=Wr,A_=Sn;function C_(){}function F_(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Nm(e),r}function k_(e,t,r){r==null&&(r=U(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return ss({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),I0(e,r),r.slice(0,r.l)}function P_(e){var t=bt(e);return[t]}function O_(e,t,r){return r==null&&(r=U(8)),jr(t,r)}function b_(e){var t=Vr(e);return[t]}function R_(e,t,r){return r==null&&(r=U(4)),$r(t,r)}function D_(e){var t=bt(e),r=e.read_shift(1);return[t,r,"b"]}function I_(e,t,r){return r==null&&(r=U(9)),jr(t,r),r.write_shift(1,e.v?1:0),r}function L_(e){var t=Vr(e),r=e.read_shift(1);return[t,r,"b"]}function M_(e,t,r){return r==null&&(r=U(5)),$r(t,r),r.write_shift(1,e.v?1:0),r}function N_(e){var t=bt(e),r=e.read_shift(1);return[t,r,"e"]}function B_(e,t,r){return r==null&&(r=U(9)),jr(t,r),r.write_shift(1,e.v),r}function U_(e){var t=Vr(e),r=e.read_shift(1);return[t,r,"e"]}function j_(e,t,r){return r==null&&(r=U(8)),$r(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function V_(e){var t=bt(e),r=e.read_shift(4);return[t,r,"s"]}function $_(e,t,r){return r==null&&(r=U(12)),jr(t,r),r.write_shift(4,t.v),r}function W_(e){var t=Vr(e),r=e.read_shift(4);return[t,r,"s"]}function H_(e,t,r){return r==null&&(r=U(8)),$r(t,r),r.write_shift(4,t.v),r}function G_(e){var t=bt(e),r=An(e);return[t,r,"n"]}function K_(e,t,r){return r==null&&(r=U(16)),jr(t,r),Mr(e.v,r),r}function z_(e){var t=Vr(e),r=An(e);return[t,r,"n"]}function X_(e,t,r){return r==null&&(r=U(12)),$r(t,r),Mr(e.v,r),r}function q_(e){var t=bt(e),r=L0(e);return[t,r,"n"]}function Y_(e,t,r){return r==null&&(r=U(12)),jr(t,r),M0(e.v,r),r}function J_(e){var t=Vr(e),r=L0(e);return[t,r,"n"]}function Z_(e,t,r){return r==null&&(r=U(8)),$r(t,r),M0(e.v,r),r}function Q_(e){var t=bt(e),r=ro(e);return[t,r,"is"]}function ey(e){var t=bt(e),r=lt(e);return[t,r,"str"]}function ty(e,t,r){return r==null&&(r=U(12+4*e.v.length)),jr(t,r),Ye(e.v,r),r.length>r.l?r.slice(0,r.l):r}function ry(e){var t=Vr(e),r=lt(e);return[t,r,"str"]}function ny(e,t,r){return r==null&&(r=U(8+4*e.v.length)),$r(t,r),Ye(e.v,r),r.length>r.l?r.slice(0,r.l):r}function iy(e,t,r){var n=e.l+t,i=bt(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=Ss(e,n-e.l,r);a[3]=xn(o,null,i,r.supbooks,r)}else e.l=n;return a}function sy(e,t,r){var n=e.l+t,i=bt(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=Ss(e,n-e.l,r);a[3]=xn(o,null,i,r.supbooks,r)}else e.l=n;return a}function ay(e,t,r){var n=e.l+t,i=bt(e);i.r=r["!row"];var s=An(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=Ss(e,n-e.l,r);a[3]=xn(o,null,i,r.supbooks,r)}else e.l=n;return a}function oy(e,t,r){var n=e.l+t,i=bt(e);i.r=r["!row"];var s=lt(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=Ss(e,n-e.l,r);a[3]=xn(o,null,i,r.supbooks,r)}else e.l=n;return a}var ly=Wr,cy=Sn;function fy(e,t){return t==null&&(t=U(4)),t.write_shift(4,e),t}function uy(e,t){var r=e.l+t,n=Wr(e),i=no(e),s=lt(e),a=lt(e),o=lt(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function hy(e,t){var r=U(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Sn({s:qe(e[0]),e:qe(e[0])},r),io("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Ye(i||"",r),Ye(e[1].Tooltip||"",r),Ye("",r),r.slice(0,r.l)}function dy(){}function py(e,t,r){var n=e.l+t,i=N0(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=r_(e,n-e.l,r);a[1]=o}else e.l=n;return a}function my(e,t,r){var n=e.l+t,i=Wr(e),s=[i];if(r.cellFormula){var a=i_(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function gy(e,t,r){r==null&&(r=U(18));var n=As(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var yu=["left","right","top","bottom","header","footer"];function vy(e){var t={};return yu.forEach(function(r){t[r]=An(e)}),t}function xy(e,t){return t==null&&(t=U(6*8)),xu(e),yu.forEach(function(r){Mr(e[r],t)}),t}function _y(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function yy(e,t,r){r==null&&(r=U(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function wy(e){var t=U(24);return t.write_shift(4,4),t.write_shift(4,1),Sn(e,t),t}function Ty(e,t){return t==null&&(t=U(16*4+2)),t.write_shift(2,e.password?tu(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Ey(){}function Sy(){}function Ay(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=xt(t),t.z=t.z||Ue[14],t.v=vt(dt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=yr(i.cellXfs,t,i),t.l&&s["!links"].push([Fe(l),t.l]),t.c&&s["!comments"].push([Fe(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=fo(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?G(e,18,H_(t,l)):G(e,7,$_(t,l))):(l.t="str",a?G(e,17,ny(t,l)):G(e,6,ty(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?G(e,13,Z_(t,l)):G(e,2,Y_(t,l)):a?G(e,16,X_(t,l)):G(e,5,K_(t,l)),!0;case"b":return l.t="b",a?G(e,15,M_(t,l)):G(e,4,I_(t,l)),!0;case"e":return l.t="e",a?G(e,14,j_(t,l)):G(e,3,B_(t,l)),!0}return a?G(e,12,R_(t,l)):G(e,1,O_(t,l)),!0}function Cy(e,t,r,n){var i=be(t["!ref"]||"A1"),s,a="",o=[];G(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var f=i.s.r;f<=c;++f){a=rt(f),E_(e,t,i,f);var u=!1;if(f<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){f===i.s.r&&(o[h]=ot(h)),s=o[h]+a;var d=l?(t[f]||[])[h]:t[s];if(!d){u=!1;continue}u=Ay(e,d,f,h,n,t,u)}}G(e,146)}function Fy(e,t){!t||!t["!merges"]||(G(e,177,fy(t["!merges"].length)),t["!merges"].forEach(function(r){G(e,176,cy(r))}),G(e,178))}function ky(e,t){!t||!t["!cols"]||(G(e,390),t["!cols"].forEach(function(r,n){r&&G(e,60,gy(n,r))}),G(e,391))}function Py(e,t){!t||!t["!ref"]||(G(e,648),G(e,649,wy(be(t["!ref"]))),G(e,650))}function Oy(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Ae(r,-1,n[1].Target.replace(/#.*$/,""),we.HLINK);G(e,494,hy(n,i))}}),delete t["!links"]}function by(e,t,r,n){if(t["!comments"].length>0){var i=Ae(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",we.VML);G(e,551,io("rId"+i)),t["!legacy"]=i}}function Ry(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:$e(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=St(s);o.s.r==o.e.r&&(o.e.r=St(t["!ref"]).e.r,s=$e(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),G(e,161,Sn(be(s))),G(e,162)}}function Dy(e,t,r){G(e,133),G(e,137,yy(t,r)),G(e,138),G(e,134)}function Iy(e,t){t["!protect"]&&G(e,535,Ty(t["!protect"]))}function Ly(e,t,r,n){var i=gt(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=be(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],G(i,129),(r.vbaraw||a["!outline"])&&G(i,147,k_(o,a["!outline"])),G(i,148,A_(l)),Dy(i,a,r.Workbook),ky(i,a),Cy(i,a,e,t),Iy(i,a),Ry(i,a,r,e),Fy(i,a),Oy(i,a,n),a["!margins"]&&G(i,476,xy(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Py(i,a),by(i,a,e,n),G(i,130),i.end()}function My(e,t){e.l+=10;var r=lt(e);return{name:r}}var Ny=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function By(e){return!e.Workbook||!e.Workbook.WBProps?"false":mm(e.Workbook.WBProps.date1904)?"true":"false"}var Uy="][*?/\\".split("");function wu(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Uy.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function jy(e,t,r){e.forEach(function(n,i){wu(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function Vy(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];jy(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)c_(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function Tu(e){var t=[We];t[t.length]=J("workbook",null,{xmlns:Tn[0],"xmlns:r":Xe.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ny.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=J("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:Ce(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=J("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=J("definedName",Ce(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function $y(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ya(e),r.name=lt(e),r}function Wy(e,t){return t||(t=U(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),io(e.strRelID,t),Ye(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Hy(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?lt(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Gy(e,t){t||(t=U(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),I0(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Ky(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=Bm(e),a=n_(e,0,r),o=no(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function zy(e,t){G(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};G(e,156,Wy(i))}G(e,144)}function Xy(e,t){t||(t=U(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ye("SheetJS",t),Ye(Zi.version,t),Ye(Zi.version,t),Ye("7262",t),t.length>t.l?t.slice(0,t.l):t}function qy(e,t){t||(t=U(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Yy(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(G(e,135),G(e,158,qy(i)),G(e,136))}}function Jy(e,t){var r=gt();return G(r,131),G(r,128,Xy()),G(r,153,Gy(e.Workbook&&e.Workbook.WBProps||null)),Yy(r,e),zy(r,e),G(r,132),r.end()}function Zy(e,t,r){return(t.slice(-4)===".bin"?Jy:Tu)(e)}function Qy(e,t,r,n,i){return(t.slice(-4)===".bin"?Ly:_u)(e,r,n,i)}function ew(e,t,r){return(t.slice(-4)===".bin"?xv:iu)(e,r)}function tw(e,t,r){return(t.slice(-4)===".bin"?Gg:eu)(e,r)}function rw(e,t,r){return(t.slice(-4)===".bin"?Iv:cu)(e)}function nw(e){return(e.slice(-4)===".bin"?Cv:ou)()}function iw(e,t){var r=[];return e.Props&&r.push(eg(e.Props,t)),e.Custprops&&r.push(tg(e.Props,e.Custprops)),r.join("")}function sw(){return""}function aw(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(J("NumberFormat",null,{"ss:Format":Ce(Ue[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(J("Style",s.join(""),a))}),J("Styles",r.join(""))}function Eu(e){return J("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+lo(e.Ref,{r:0,c:0})})}function ow(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Eu(i)))}return J("Names",r.join(""))}function lw(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Eu(o)))}return s.join("")}function cw(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(J("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(J("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(J("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(J("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(tt("ProtectContents","True")),e["!protect"].objects&&i.push(tt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(tt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(tt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(tt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":J("WorksheetOptions",i.join(""),{xmlns:Tt.x})}function fw(e){return e.map(function(t){var r=pm(t.t||""),n=J("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return J("Comment",n,{"ss:Author":t.a})}).join("")}function uw(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ce(lo(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=qe(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ce(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ce(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=a.c||c[f].s.r!=a.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var u="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":u="Number",h=String(e.v);break;case"b":u="Boolean",h=e.v?"1":"0";break;case"e":u="Error",h=yi[e.v];break;case"d":u="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ue[14]);break;case"s":u="String",h=dm(e.v||"");break}var d=yr(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=a.c+1;var m=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+u+'">'+m+"</Data>";return(e.c||[]).length>0&&(p+=fw(e.c)),J("Cell",p,o)}function hw(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=nu(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function dw(e,t,r,n){if(!e["!ref"])return"";var i=be(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,S){ao(g);var A=!!g.width,T=As(S,g),k={"ss:Index":S+1};A&&(k["ss:Width"]=os(T.width)),g.hidden&&(k["ss:Hidden"]="1"),o.push(J("Column",null,k))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var f=[hw(c,(e["!rows"]||[])[c])],u=i.s.c;u<=i.e.c;++u){var h=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>u)&&!(s[a].s.r>c)&&!(s[a].e.c<u)&&!(s[a].e.r<c)){(s[a].s.c!=u||s[a].s.r!=c)&&(h=!0);break}if(!h){var d={r:c,c:u},m=Fe(d),p=l?(e[c]||[])[u]:e[m];f.push(uw(p,m,e,t,r,n,d))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function pw(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?lw(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?dw(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(cw(s,t,e,r)),n.join("")}function mw(e,t){t||(t={}),e.SSF||(e.SSF=xt(Ue)),e.SSF&&(ys(),_s(e.SSF),t.revssf=ws(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],yr(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(iw(e,t)),r.push(sw()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(J("Worksheet",pw(n,t,e),{"ss:Name":Ce(e.SheetNames[n])}));return r[2]=aw(e,t),r[3]=ow(e),We+J("Workbook",r.join(""),{xmlns:Tt.ss,"xmlns:o":Tt.o,"xmlns:x":Tt.x,"xmlns:ss":Tt.ss,"xmlns:dt":Tt.dt,"xmlns:html":Tt.html})}var Xs={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function gw(e,t){var r=[],n=[],i=[],s=0,a,o=Ul(Zl,"n"),l=Ul(Ql,"n");if(e.Props)for(a=nt(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=nt(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)z0.indexOf(i[s][0])>-1||H0.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&ke.utils.cfb_add(t,"/SummaryInformation",ic(n,Xs.SI,l,Ql)),(r.length||c.length)&&ke.utils.cfb_add(t,"/DocumentSummaryInformation",ic(r,Xs.DSI,o,Zl,c.length?c:null,Xs.UDI))}function vw(e,t){var r=t||{},n=ke.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ke.utils.cfb_add(n,i,Su(e,r)),r.biff==8&&(e.Props||e.Custprops)&&gw(e,n),r.biff==8&&e.vbaraw&&Lv(n,ke.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var xw={0:{f:w_},1:{f:P_},2:{f:q_},3:{f:N_},4:{f:D_},5:{f:G_},6:{f:ey},7:{f:V_},8:{f:oy},9:{f:ay},10:{f:iy},11:{f:sy},12:{f:b_},13:{f:J_},14:{f:U_},15:{f:L_},16:{f:z_},17:{f:ry},18:{f:W_},19:{f:ro},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Ky},40:{},42:{},43:{f:ev},44:{f:Zg},45:{f:nv},46:{f:sv},47:{f:iv},48:{},49:{f:bm},50:{},51:{f:wv},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Rg},62:{f:Q_},63:{f:Fv},64:{f:Ey},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_y},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:F_},148:{f:S_,p:16},151:{f:dy},152:{},153:{f:Hy},154:{},155:{},156:{f:$y},157:{},158:{},159:{T:1,f:$g},160:{T:-1},161:{T:1,f:Wr},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ly},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_v},336:{T:-1},337:{f:Sv,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ya},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Cg},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:py},427:{f:my},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vy},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:C_},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:uy},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ya},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Rv},633:{T:1},634:{T:-1},635:{T:1,f:Ov},636:{T:-1},637:{f:Lm},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:My},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Sy},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Z(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Qa(r)&&e.push(r)}}function _w(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Z(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(f=e.next(4),f.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function Ti(e,t,r){return e||(e=U(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function yw(e,t,r,n){var i=U(9);return Ti(i,e,t),q0(r,n||"b",i),i}function ww(e,t,r){var n=U(8+2*r.length);return Ti(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Tw(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?vt(dt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Z(e,2,Mg(r,n,i)):Z(e,3,Lg(r,n,i));return;case"b":case"e":Z(e,5,yw(r,n,t.v,t.t));return;case"s":case"str":Z(e,4,ww(r,n,(t.v||"").slice(0,255)));return}Z(e,1,Ti(null,r,n))}function Ew(e,t,r,n){var i=Array.isArray(t),s=be(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=$e(s)}for(var c=s.s.r;c<=s.e.r;++c){o=rt(c);for(var f=s.s.c;f<=s.e.c;++f){c===s.s.r&&(l[f]=ot(f)),a=l[f]+o;var u=i?(t[c]||[])[f]:t[a];u&&Tw(e,u,c,f)}}}function Sw(e,t){for(var r=t||{},n=gt(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Z(n,r.biff==4?1033:r.biff==3?521:9,so(e,16,r)),Ew(n,e.Sheets[e.SheetNames[i]],i,r),Z(n,10),n.end()}function Aw(e,t,r){Z(e,49,xg({sz:12,name:"Arial"},r))}function Cw(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Z(e,1054,wg(i,t[i],r))})}function Fw(e,t){var r=U(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Z(e,2151,r),r=U(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Z0(be(t["!ref"]||"A1"),r),r.write_shift(4,4),Z(e,2152,r)}function kw(e,t){for(var r=0;r<16;++r)Z(e,224,ac({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Z(e,224,ac(n,0,t))})}function Pw(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Z(e,440,Pg(n)),n[1].Tooltip&&Z(e,2048,Og(n))}delete t["!links"]}function Ow(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Z(e,125,Dg(As(i,n),i))})}}function bw(e,t,r,n,i){var s=16+yr(i.cellXfs,t,i);if(t.v==null&&!t.bf){Z(e,513,Nr(r,n,s));return}if(t.bf)Z(e,6,t_(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?vt(dt(t.v)):t.v;Z(e,515,Ag(r,n,a,s));break;case"b":case"e":Z(e,517,Sg(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=fo(i.Strings,t.v,i.revStrings);Z(e,253,_g(r,n,o,s))}else Z(e,516,yg(r,n,(t.v||"").slice(0,255),s,i));break;default:Z(e,513,Nr(r,n,s))}}function Rw(e,t,r){var n=gt(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,f,u="",h=[],d=be(s["!ref"]||"A1"),m=c?65536:16384;if(d.e.c>255||d.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,m-1)}Z(n,2057,so(r,16,t)),Z(n,13,Pt(1)),Z(n,12,Pt(100)),Z(n,15,ut(!0)),Z(n,17,ut(!1)),Z(n,16,Mr(.001)),Z(n,95,ut(!0)),Z(n,42,ut(!1)),Z(n,43,ut(!1)),Z(n,130,Pt(1)),Z(n,128,Eg()),Z(n,131,ut(!1)),Z(n,132,ut(!1)),c&&Ow(n,s["!cols"]),Z(n,512,Tg(d,t)),c&&(s["!links"]=[]);for(var p=d.s.r;p<=d.e.r;++p){u=rt(p);for(var g=d.s.c;g<=d.e.c;++g){p===d.s.r&&(h[g]=ot(g)),f=h[g]+u;var S=l?(s[p]||[])[g]:s[f];S&&(bw(n,S,p,g,t),c&&S.l&&s["!links"].push([f,S.l]))}}var A=o.CodeName||o.name||i;return c&&Z(n,574,vg((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&Z(n,229,kg(s["!merges"])),c&&Pw(n,s),Z(n,442,J0(A)),c&&Fw(n,s),Z(n,10),n.end()}function Dw(e,t,r){var n=gt(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Z(n,2057,so(e,5,r)),r.bookType=="xla"&&Z(n,135),Z(n,225,o?Pt(1200):null),Z(n,193,ig(2)),l&&Z(n,191),l&&Z(n,192),Z(n,226),Z(n,92,dg("SheetJS",r)),Z(n,66,Pt(o?1200:1252)),o&&Z(n,353,Pt(0)),o&&Z(n,448),Z(n,317,Ig(e.SheetNames.length)),o&&e.vbaraw&&Z(n,211),o&&e.vbaraw){var c=a.CodeName||"ThisWorkbook";Z(n,442,J0(c))}Z(n,156,Pt(17)),Z(n,25,ut(!1)),Z(n,18,ut(!1)),Z(n,19,Pt(0)),o&&Z(n,431,ut(!1)),o&&Z(n,444,Pt(0)),Z(n,61,gg()),Z(n,64,ut(!1)),Z(n,141,Pt(0)),Z(n,34,ut(By(e)=="true")),Z(n,14,ut(!0)),o&&Z(n,439,ut(!1)),Z(n,218,Pt(0)),Aw(n,e,r),Cw(n,e.SSF,r),kw(n,r),o&&Z(n,352,ut(!1));var f=n.end(),u=gt();o&&Z(u,140,bg()),o&&r.Strings&&_w(u,252,mg(r.Strings)),Z(u,10);var h=u.end(),d=gt(),m=0,p=0;for(p=0;p<e.SheetNames.length;++p)m+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=f.length+m+h.length;for(p=0;p<e.SheetNames.length;++p){var S=s[p]||{};Z(d,133,pg({pos:g,hs:S.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var A=d.end();if(m!=A.length)throw new Error("BS8 "+m+" != "+A.length);var T=[];return f.length&&T.push(f),A.length&&T.push(A),h.length&&T.push(h),et(T)}function Iw(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=xt(Ue)),e&&e.SSF&&(ys(),_s(e.SSF),r.revssf=ws(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,uo(r),r.cellXfs=[],yr(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=Rw(i,r,e);return n.unshift(Dw(e,n,r)),et(n)}function Su(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=St(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return Iw(e,t);case 4:case 3:case 2:return Sw(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Lw(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var f=Fe({r,c:a}),u=n.dense?(e[r]||[])[a]:e[f],h=u&&u.v!=null&&(u.h||hm(u.w||(rr(u),u.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":u&&(d["data-t"]=u&&u.t||"z",u.v!=null&&(d["data-v"]=u.v),u.z!=null&&(d["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),d.id=(n.id||"sjs")+"-"+f,s.push(J("td",h,d))}}var m="<tr>";return m+s.join("")+"</tr>"}var Mw='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Nw="</body></html>";function Bw(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Au(e,t){var r=t||{},n=r.header!=null?r.header:Mw,i=r.footer!=null?r.footer:Nw,s=[n],a=St(e["!ref"]);r.dense=Array.isArray(e),s.push(Bw(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(Lw(e,a,o,r));return s.push("</table>"+i),s.join("")}function Cu(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?qe(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var f=St(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),i==-1&&(c.e.r=i=f.e.r+1)}var u=[],h=0,d=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,S=0,A=0,T=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var k=o[m];if(dc(k)){if(n.display)continue;d[p]={hidden:!0}}var b=k.children;for(g=S=0;g<b.length;++g){var W=b[g];if(!(n.display&&dc(W))){var F=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):gm(W.innerHTML),I=W.getAttribute("data-z")||W.getAttribute("z");for(h=0;h<u.length;++h){var R=u[h];R.s.c==S+s&&R.s.r<p+i&&p+i<=R.e.r&&(S=R.e.c+1-s,h=-1)}T=+W.getAttribute("colspan")||1,((A=+W.getAttribute("rowspan")||1)>1||T>1)&&u.push({s:{r:p+i,c:S+s},e:{r:p+i+(A||1)-1,c:S+s+(T||1)-1}});var V={t:"s",v:F},H=W.getAttribute("data-t")||W.getAttribute("t")||"";F!=null&&(F.length==0?V.t=H||"z":n.raw||F.trim().length==0||H=="s"||(F==="TRUE"?V={t:"b",v:!0}:F==="FALSE"?V={t:"b",v:!1}:isNaN(Qt(F))?isNaN(ni(F).getDate())||(V={t:"d",v:dt(F)},n.cellDates||(V={t:"n",v:vt(V.v)}),V.z=n.dateNF||Ue[14]):V={t:"n",v:Qt(F)})),V.z===void 0&&I!=null&&(V.z=I);var z="",te=W.getElementsByTagName("A");if(te&&te.length)for(var _e=0;_e<te.length&&!(te[_e].hasAttribute("href")&&(z=te[_e].getAttribute("href"),z.charAt(0)!="#"));++_e);z&&z.charAt(0)!="#"&&(V.l={Target:z}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][S+s]=V):e[Fe({c:S+s,r:p+i})]=V,c.e.c<S+s&&(c.e.c=S+s),S+=T}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,p-1+i),e["!ref"]=$e(c),p>=l&&(e["!fullref"]=$e((c.e.r=o.length-m+p-1+i,c))),e}function Fu(e,t){var r=t||{},n=r.dense?[]:{};return Cu(n,e,t)}function Uw(e,t){return Ur(Fu(e,t),t)}function dc(e){var t="",r=jw(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function jw(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Vw=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+si({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return We+t}}(),pc=function(){var e=function(s){return Ce(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Ce(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,u=St(s["!ref"]||"A1"),h=s["!merges"]||[],d=0,m=Array.isArray(s);if(s["!cols"])for(f=0;f<=u.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var p="",g=s["!rows"]||[];for(c=0;c<u.s.r;++c)p=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=u.e.r;++c){for(p=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+p+`>
`),f=0;f<u.s.c;++f)l.push(t);for(;f<=u.e.c;++f){var S=!1,A={},T="";for(d=0;d!=h.length;++d)if(!(h[d].s.c>f)&&!(h[d].s.r>c)&&!(h[d].e.c<f)&&!(h[d].e.r<c)){(h[d].s.c!=f||h[d].s.r!=c)&&(S=!0),A["table:number-columns-spanned"]=h[d].e.c-h[d].s.c+1,A["table:number-rows-spanned"]=h[d].e.r-h[d].s.r+1;break}if(S){l.push(r);continue}var k=Fe({r:c,c:f}),b=m?(s[c]||[])[f]:s[k];if(b&&b.f&&(A["table:formula"]=Ce(o_(b.f)),b.F&&b.F.slice(0,k.length)==k)){var W=St(b.F);A["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,A["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!b){l.push(t);continue}switch(b.t){case"b":T=b.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=b.v?"true":"false";break;case"n":T=b.w||String(b.v||0),A["office:value-type"]="float",A["office:value"]=b.v||0;break;case"s":case"str":T=b.v==null?"":b.v,A["office:value-type"]="string";break;case"d":T=b.w||dt(b.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=dt(b.v).toISOString(),A["table:style-name"]="ce1";break;default:l.push(t);continue}var F=e(T);if(b.l&&b.l.Target){var I=b.l.Target;I=I.charAt(0)=="#"?"#"+l_(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),F=J("text:a",F,{"xlink:href":I.replace(/&/g,"&amp;")})}l.push("          "+J("table:table-cell",J("text:p",F,{}),A)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var u=c["!cols"][f];if(u.width==null&&u.wpx==null&&u.wch==null)continue;ao(u),u.ods=o;var h=c["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var u=c["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[We],c=si({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=si({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+f+`>
`),l.push($0().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var u=0;u!=a.SheetNames.length;++u)l.push(n(a.Sheets[a.SheetNames[u]],a,u));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function ku(e,t){if(t.bookType=="fods")return pc(e,t);var r=qa(),n="",i=[],s=[];return n="mimetype",ge(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ge(r,n,pc(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ge(r,n,Vw(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ge(r,n,We+$0()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ge(r,n,Qm(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ge(r,n,Jm(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function fs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function $w(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Mt(ii(e))}function Ww(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function gr(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function Hw(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function ai(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Se(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function mn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function He(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=ai(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=ai(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Je(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Se(n*8+i.type)),i.type==2&&t.push(Se(i.data.length)),t.push(i.data))})}),gr(t)}function Rt(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=ai(e,n),s=He(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:mn(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=He(o.data),c=mn(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=mn(s[3][0].data)>>>0>0),r.push(a)}return r}function en(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Se(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Se(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Se(a.data.length)}],n[2].push({data:Je(a.meta),type:2})});var s=Je(n);t.push(Se(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),gr(t)}function Gw(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ai(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[gr(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var f=gr(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Dt(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Gw(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return gr(t)}function tn(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Se(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return gr(t)}function qs(e,t){var r=new Uint8Array(32),n=fs(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Hw(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Ys(e,t){var r=new Uint8Array(32),n=fs(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function ar(e){var t=He(e);return ai(t[1][0].data)}function Kw(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&mn(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=fs(e[7][0].data),f=0,u=[],h=fs(e[4][0].data),d=0,m=[],p=0;p<t.length;++p){if(t[p]==null){c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}c.setUint16(p*2,f,!0),h.setUint16(p*2,d,!0);var g,S;switch(typeof t[p]){case"string":g=qs({t:"s",v:t[p]},r),S=Ys({t:"s",v:t[p]},r);break;case"number":g=qs({t:"n",v:t[p]},r),S=Ys({t:"n",v:t[p]},r);break;case"boolean":g=qs({t:"b",v:t[p]},r),S=Ys({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}u.push(g),f+=g.length,m.push(S),d+=S.length,++l}for(e[2][0].data=Se(l);p<e[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=gr(u),e[3][0].data=gr(m),l}function zw(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=St(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat($e(n)));var s=us(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(N){return N.forEach(function(O){typeof O=="string"&&a.push(O)})});var o={},l=[],c=ke.read(t.numbers,{type:"base64"});c.FileIndex.map(function(N,O){return[N,c.FullPaths[O]]}).forEach(function(N){var O=N[0],P=N[1];if(O.type==2&&O.name.match(/\.iwa/)){var K=O.content,ce=Dt(K),fe=Rt(ce);fe.forEach(function(ae){l.push(ae.id),o[ae.id]={deps:[],location:P,type:mn(ae.messages[0].meta[1][0].data)}})}}),l.sort(function(N,O){return N-O});var f=l.filter(function(N){return N>1}).map(function(N){return[N,Se(N)]});c.FileIndex.map(function(N,O){return[N,c.FullPaths[O]]}).forEach(function(N){var O=N[0];if(N[1],!!O.name.match(/\.iwa/)){var P=Rt(Dt(O.content));P.forEach(function(K){K.messages.forEach(function(ce){f.forEach(function(fe){K.messages.some(function(ae){return mn(ae.meta[1][0].data)!=11006&&Ww(ae.data,fe[1])})&&o[fe[0]].deps.push(K.id)})})})}});for(var u=ke.find(c,o[1].location),h=Rt(Dt(u.content)),d,m=0;m<h.length;++m){var p=h[m];p.id==1&&(d=p)}var g=ar(He(d.messages[0].data)[1][0].data);for(u=ke.find(c,o[g].location),h=Rt(Dt(u.content)),m=0;m<h.length;++m)p=h[m],p.id==g&&(d=p);for(g=ar(He(d.messages[0].data)[2][0].data),u=ke.find(c,o[g].location),h=Rt(Dt(u.content)),m=0;m<h.length;++m)p=h[m],p.id==g&&(d=p);for(g=ar(He(d.messages[0].data)[2][0].data),u=ke.find(c,o[g].location),h=Rt(Dt(u.content)),m=0;m<h.length;++m)p=h[m],p.id==g&&(d=p);var S=He(d.messages[0].data);{S[6][0].data=Se(n.e.r+1),S[7][0].data=Se(n.e.c+1);var A=ar(S[46][0].data),T=ke.find(c,o[A].location),k=Rt(Dt(T.content));{for(var b=0;b<k.length&&k[b].id!=A;++b);if(k[b].id!=A)throw"Bad ColumnRowUIDMapArchive";var W=He(k[b].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var F=0;F<=n.e.c;++F){var I=[];I[1]=I[2]=[{type:0,data:Se(F+420690)}],W[1].push({type:2,data:Je(I)}),W[2].push({type:0,data:Se(F)}),W[3].push({type:0,data:Se(F)})}W[4]=[],W[5]=[],W[6]=[];for(var R=0;R<=n.e.r;++R)I=[],I[1]=I[2]=[{type:0,data:Se(R+726270)}],W[4].push({type:2,data:Je(I)}),W[5].push({type:0,data:Se(R)}),W[6].push({type:0,data:Se(R)});k[b].messages[0].data=Je(W)}T.content=tn(en(k)),T.size=T.content.length,delete S[46];var V=He(S[4][0].data);{V[7][0].data=Se(n.e.r+1);var H=He(V[1][0].data),z=ar(H[2][0].data);T=ke.find(c,o[z].location),k=Rt(Dt(T.content));{if(k[0].id!=z)throw"Bad HeaderStorageBucket";var te=He(k[0].messages[0].data);for(R=0;R<s.length;++R){var _e=He(te[2][0].data);_e[1][0].data=Se(R),_e[4][0].data=Se(s[R].length),te[2][R]={type:te[2][0].type,data:Je(_e)}}k[0].messages[0].data=Je(te)}T.content=tn(en(k)),T.size=T.content.length;var he=ar(V[2][0].data);T=ke.find(c,o[he].location),k=Rt(Dt(T.content));{if(k[0].id!=he)throw"Bad HeaderStorageBucket";for(te=He(k[0].messages[0].data),F=0;F<=n.e.c;++F)_e=He(te[2][0].data),_e[1][0].data=Se(F),_e[4][0].data=Se(n.e.r+1),te[2][F]={type:te[2][0].type,data:Je(_e)};k[0].messages[0].data=Je(te)}T.content=tn(en(k)),T.size=T.content.length;var Y=ar(V[4][0].data);(function(){for(var N=ke.find(c,o[Y].location),O=Rt(Dt(N.content)),P,K=0;K<O.length;++K){var ce=O[K];ce.id==Y&&(P=ce)}var fe=He(P.messages[0].data);{fe[3]=[];var ae=[];a.forEach(function(ye,ct){ae[1]=[{type:0,data:Se(ct)}],ae[2]=[{type:0,data:Se(1)}],ae[3]=[{type:2,data:$w(ye)}],fe[3].push({type:2,data:Je(ae)})})}P.messages[0].data=Je(fe);var re=en(O),Pe=tn(re);N.content=Pe,N.size=N.content.length})();var ee=He(V[3][0].data);{var oe=ee[1][0];delete ee[2];var de=He(oe.data);{var xe=ar(de[2][0].data);(function(){for(var N=ke.find(c,o[xe].location),O=Rt(Dt(N.content)),P,K=0;K<O.length;++K){var ce=O[K];ce.id==xe&&(P=ce)}var fe=He(P.messages[0].data);{delete fe[6],delete ee[7];var ae=new Uint8Array(fe[5][0].data);fe[5]=[];for(var re=0,Pe=0;Pe<=n.e.r;++Pe){var ye=He(ae);re+=Kw(ye,s[Pe],a),ye[1][0].data=Se(Pe),fe[5].push({data:Je(ye),type:2})}fe[1]=[{type:0,data:Se(n.e.c+1)}],fe[2]=[{type:0,data:Se(n.e.r+1)}],fe[3]=[{type:0,data:Se(re)}],fe[4]=[{type:0,data:Se(n.e.r+1)}]}P.messages[0].data=Je(fe);var ct=en(O),Ee=tn(ct);N.content=Ee,N.size=N.content.length})()}oe.data=Je(de)}V[3][0].data=Je(ee)}S[4][0].data=Je(V)}d.messages[0].data=Je(S);var Ge=en(h),C=tn(Ge);return u.content=C,u.size=u.content.length,c}function Xw(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function uo(e){Xw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function qw(e,t){return t.bookType=="ods"?ku(e,t):t.bookType=="numbers"?zw(e,t):t.bookType=="xlsb"?Yw(e,t):Jw(e,t)}function Yw(e,t){sn=1024,e&&!e.SSF&&(e.SSF=xt(Ue)),e&&e.SSF&&(ys(),_s(e.SSF),t.revssf=ws(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xn?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=fu.indexOf(t.bookType)>-1,i=U0();uo(t=t||{});var s=qa(),a="",o=0;if(t.cellXfs=[],yr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",ge(s,a,W0(e.Props,t)),i.coreprops.push(a),Ae(t.rels,2,a,we.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,ge(s,a,G0(e.Props)),i.extprops.push(a),Ae(t.rels,3,a,we.EXT_PROPS),e.Custprops!==e.Props&&nt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",ge(s,a,K0(e.Custprops)),i.custprops.push(a),Ae(t.rels,4,a,we.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},u=e.Sheets[e.SheetNames[o-1]],h=(u||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ge(s,a,Qy(o-1,a,t,e,f)),i.sheets.push(a),Ae(t.wbrels,-1,"worksheets/sheet"+o+"."+r,we.WS[0])}if(u){var d=u["!comments"],m=!1,p="";d&&d.length>0&&(p="xl/comments"+o+"."+r,ge(s,p,rw(d,p)),i.comments.push(p),Ae(f,-1,"../comments"+o+"."+r,we.CMNT),m=!0),u["!legacy"]&&m&&ge(s,"xl/drawings/vmlDrawing"+o+".vml",lu(o,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&ge(s,V0(a),dn(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,ge(s,a,tw(t.Strings,a,t)),i.strs.push(a),Ae(t.wbrels,-1,"sharedStrings."+r,we.SST)),a="xl/workbook."+r,ge(s,a,Zy(e,a)),i.workbooks.push(a),Ae(t.rels,1,a,we.WB),a="xl/theme/theme1.xml",ge(s,a,au(e.Themes,t)),i.themes.push(a),Ae(t.wbrels,-1,"theme/theme1.xml",we.THEME),a="xl/styles."+r,ge(s,a,ew(e,a,t)),i.styles.push(a),Ae(t.wbrels,-1,"styles."+r,we.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",ge(s,a,e.vbaraw),i.vba.push(a),Ae(t.wbrels,-1,"vbaProject.bin",we.VBA)),a="xl/metadata."+r,ge(s,a,nw(a)),i.metadata.push(a),Ae(t.wbrels,-1,"metadata."+r,we.XLMETA),ge(s,"[Content_Types].xml",j0(i,t)),ge(s,"_rels/.rels",dn(t.rels)),ge(s,"xl/_rels/workbook."+r+".rels",dn(t.wbrels)),delete t.revssf,delete t.ssf,s}function Jw(e,t){sn=1024,e&&!e.SSF&&(e.SSF=xt(Ue)),e&&e.SSF&&(ys(),_s(e.SSF),t.revssf=ws(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Xn?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=fu.indexOf(t.bookType)>-1,i=U0();uo(t=t||{});var s=qa(),a="",o=0;if(t.cellXfs=[],yr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",ge(s,a,W0(e.Props,t)),i.coreprops.push(a),Ae(t.rels,2,a,we.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,ge(s,a,G0(e.Props)),i.extprops.push(a),Ae(t.rels,3,a,we.EXT_PROPS),e.Custprops!==e.Props&&nt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",ge(s,a,K0(e.Custprops)),i.custprops.push(a),Ae(t.rels,4,a,we.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,ge(s,a,_u(o-1,t,e,u)),i.sheets.push(a),Ae(t.wbrels,-1,"worksheets/sheet"+o+"."+r,we.WS[0])}if(h){var m=h["!comments"],p=!1,g="";if(m&&m.length>0){var S=!1;m.forEach(function(A){A[1].forEach(function(T){T.T==!0&&(S=!0)})}),S&&(g="xl/threadedComments/threadedComment"+o+"."+r,ge(s,g,kv(m,f,t)),i.threadedcomments.push(g),Ae(u,-1,"../threadedComments/threadedComment"+o+"."+r,we.TCMNT)),g="xl/comments"+o+"."+r,ge(s,g,cu(m)),i.comments.push(g),Ae(u,-1,"../comments"+o+"."+r,we.CMNT),p=!0}h["!legacy"]&&p&&ge(s,"xl/drawings/vmlDrawing"+o+".vml",lu(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&ge(s,V0(a),dn(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,ge(s,a,eu(t.Strings,t)),i.strs.push(a),Ae(t.wbrels,-1,"sharedStrings."+r,we.SST)),a="xl/workbook."+r,ge(s,a,Tu(e)),i.workbooks.push(a),Ae(t.rels,1,a,we.WB),a="xl/theme/theme1.xml",ge(s,a,au(e.Themes,t)),i.themes.push(a),Ae(t.wbrels,-1,"theme/theme1.xml",we.THEME),a="xl/styles."+r,ge(s,a,iu(e,t)),i.styles.push(a),Ae(t.wbrels,-1,"styles."+r,we.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",ge(s,a,e.vbaraw),i.vba.push(a),Ae(t.wbrels,-1,"vbaProject.bin",we.VBA)),a="xl/metadata."+r,ge(s,a,ou()),i.metadata.push(a),Ae(t.wbrels,-1,"metadata."+r,we.XLMETA),f.length>1&&(a="xl/persons/person.xml",ge(s,a,Pv(f)),i.people.push(a),Ae(t.wbrels,-1,"persons/person.xml",we.PEOPLE)),ge(s,"[Content_Types].xml",j0(i,t)),ge(s,"_rels/.rels",dn(t.rels)),ge(s,"xl/_rels/workbook."+r+".rels",dn(t.wbrels)),delete t.revssf,delete t.ssf,s}function Zw(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=tr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Pu(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return xi(t.file,ke.write(e,{type:Te?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ke.write(e,t)}function Qw(e,t){var r=xt(t||{}),n=qw(e,r);return e2(n,r)}function e2(e,t){var r={},n=Te?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?ke.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(xs(i))}return t.password&&typeof encrypt_agile<"u"?Pu(encrypt_agile(i,t.password),t):t.type==="file"?xi(t.file,i):t.type=="string"?Hn(i):i}function t2(e,t){var r=t||{},n=vw(e,r);return Pu(n,r)}function $t(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return ri(ii(n));case"binary":return ii(n);case"string":return e;case"file":return xi(t.file,n,"utf8");case"buffer":return Te?sr(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):$t(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function r2(e,t){switch(t.type){case"base64":return ri(e);case"binary":return e;case"string":return e;case"file":return xi(t.file,e,"binary");case"buffer":return Te?sr(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $i(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?ri(r):t.type=="string"?Hn(r):r;case"file":return xi(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function n2(e,t){Op(),Vy(e);var r=xt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=n2(e,r);return r.type="array",xs(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return $t(mw(e,r),r);case"slk":case"sylk":return $t(Bg.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return $t(Au(e.Sheets[e.SheetNames[i]],r),r);case"txt":return r2(Ou(e.Sheets[e.SheetNames[i]],r),r);case"csv":return $t(ho(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return $t(Ug.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return $i(Ng.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return $t(jg.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return $t(zg.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return $t(Q0.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return $t(ku(e,r),r);case"wk1":return $i(oc.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return $i(oc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),$i(Su(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),t2(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Qw(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function i2(e,t,r,n,i,s,a,o){var l=rt(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var d=t.s.c;d<=t.e.c;++d){var m=a?e[r][d]:e[n[d]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[d]!=null&&(h[s[d]]=c);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[d]!=null){if(p==null)if(m.t=="e"&&p===null)h[s[d]]=null;else if(c!==void 0)h[s[d]]=c;else if(f&&p===null)h[s[d]]=null;else continue;else h[s[d]]=f&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:rr(m,p,o);p!=null&&(u=!1)}}return{row:h,isempty:u}}function us(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=be(f);break;case"number":l=be(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var u=rt(l.s.r),h=[],d=[],m=0,p=0,g=Array.isArray(e),S=l.s.r,A=0,T={};g&&!e[S]&&(e[S]=[]);var k=c.skipHidden&&e["!cols"]||[],b=c.skipHidden&&e["!rows"]||[];for(A=l.s.c;A<=l.e.c;++A)if(!(k[A]||{}).hidden)switch(h[A]=ot(A),r=g?e[S][A]:e[h[A]+u],n){case 1:s[A]=A-l.s.c;break;case 2:s[A]=h[A];break;case 3:s[A]=c.header[A-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=rr(r,null,c),p=T[a]||0,!p)T[a]=1;else{do o=a+"_"+p++;while(T[o]);T[a]=p,T[o]=1}s[A]=o}for(S=l.s.r+i;S<=l.e.r;++S)if(!(b[S]||{}).hidden){var W=i2(e,l,S,h,n,s,g,c);(W.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[m++]=W.row)}return d.length=m,d}var mc=/"/g;function s2(e,t,r,n,i,s,a,o){for(var l=!0,c=[],f="",u=rt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var d=o.dense?(e[r]||[])[h]:e[n[h]+u];if(d==null)f="";else if(d.v!=null){l=!1,f=""+(o.rawNumbers&&d.t=="n"?d.v:rr(d,null,o));for(var m=0,p=0;m!==f.length;++m)if((p=f.charCodeAt(m))===i||p===s||p===34||o.forceQuotes){f='"'+f.replace(mc,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(l=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(mc,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(a)}function ho(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=be(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",u=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(h[m]||{}).hidden||(u[m]=ot(m));for(var p=0,g=i.s.r;g<=i.e.r;++g)(d[g]||{}).hidden||(f=s2(e,i,g,u,a,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((p++?o:"")+f)));return delete n.dense,r.join("")}function Ou(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=ho(e,t);return r}function a2(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=be(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=ot(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=rt(f),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function bu(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?qe(n.origin):n.origin;a=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var u=be(s["!ref"]);f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),a==-1&&(a=u.e.r+1,f.e.r=a+t.length-1+i)}else a==-1&&(a=0,f.e.r=t.length-1+i);var h=n.header||[],d=0;t.forEach(function(p,g){nt(p).forEach(function(S){(d=h.indexOf(S))==-1&&(h[d=h.length]=S);var A=p[S],T="z",k="",b=Fe({c:o+d,r:a+g+i});c=oi(s,b),A&&typeof A=="object"&&!(A instanceof Date)?s[b]=A:(typeof A=="number"?T="n":typeof A=="boolean"?T="b":typeof A=="string"?T="s":A instanceof Date?(T="d",n.cellDates||(T="n",A=vt(A)),k=n.dateNF||Ue[14]):A===null&&n.nullError&&(T="e",A=0),c?(c.t=T,c.v=A,delete c.w,delete c.R,k&&(c.z=k)):s[b]=c={t:T,v:A},k&&(c.z=k))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var m=rt(a);if(i)for(d=0;d<h.length;++d)s[ot(d+o)+m]={t:"s",v:h[d]};return s["!ref"]=$e(f),s}function o2(e,t){return bu(null,e,t)}function oi(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=qe(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?oi(e,Fe(t)):oi(e,Fe({r:t,c:r||0}))}function l2(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function c2(){return{SheetNames:[],Sheets:{}}}function f2(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(wu(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function u2(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=l2(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function h2(e,t){return e.z=t,e}function Ru(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function d2(e,t,r){return Ru(e,"#"+t,r)}function p2(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function m2(e,t,r,n){for(var i=typeof t!="string"?t:be(t),s=typeof t=="string"?t:$e(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=oi(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var h4={encode_col:ot,encode_row:rt,encode_cell:Fe,encode_range:$e,decode_col:to,decode_row:eo,split_cell:Om,decode_cell:qe,decode_range:St,format_cell:rr,sheet_add_aoa:D0,sheet_add_json:bu,sheet_add_dom:Cu,aoa_to_sheet:En,json_to_sheet:o2,table_to_sheet:Fu,table_to_book:Uw,sheet_to_csv:ho,sheet_to_txt:Ou,sheet_to_json:us,sheet_to_html:Au,sheet_to_formulae:a2,sheet_to_row_object_array:us,sheet_get_cell:oi,book_new:c2,book_append_sheet:f2,book_set_sheet_visibility:u2,cell_set_number_format:h2,cell_set_hyperlink:Ru,cell_set_internal_link:d2,cell_add_comment:p2,sheet_set_array_formula:m2,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},zi={exports:{}},g2=zi.exports,gc;function v2(){return gc||(gc=1,function(e,t){(function(r,n){n()})(g2,function(){function r(c,f){return typeof f>"u"?f={autoBom:!1}:typeof f!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),f={autoBom:!f}),f.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function n(c,f,u){var h=new XMLHttpRequest;h.open("GET",c),h.responseType="blob",h.onload=function(){l(h.response,f,u)},h.onerror=function(){console.error("could not download file")},h.send()}function i(c){var f=new XMLHttpRequest;f.open("HEAD",c,!1);try{f.send()}catch{}return 200<=f.status&&299>=f.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(f)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Pi=="object"&&Pi.global===Pi?Pi:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(c,f,u){var h=a.URL||a.webkitURL,d=document.createElement("a");f=f||c.name||"download",d.download=f,d.rel="noopener",typeof c=="string"?(d.href=c,d.origin===location.origin?s(d):i(d.href)?n(c,f,u):s(d,d.target="_blank")):(d.href=h.createObjectURL(c),setTimeout(function(){h.revokeObjectURL(d.href)},4e4),setTimeout(function(){s(d)},0))}:"msSaveOrOpenBlob"in navigator?function(c,f,u){if(f=f||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,u),f);else if(i(c))n(c,f,u);else{var h=document.createElement("a");h.href=c,h.target="_blank",setTimeout(function(){s(h)})}}:function(c,f,u,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof c=="string")return n(c,f,u);var d=c.type==="application/octet-stream",m=/constructor/i.test(a.HTMLElement)||a.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||d&&m||o)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var T=g.result;T=p?T:T.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=T:location=T,h=null},g.readAsDataURL(c)}else{var S=a.URL||a.webkitURL,A=S.createObjectURL(c);h?h.location=A:location.href=A,h=null,setTimeout(function(){S.revokeObjectURL(A)},4e4)}});a.saveAs=l.saveAs=l,e.exports=l})}(zi)),zi.exports}var d4=v2();const po=le.createContext({});function mo(e){const t=le.useRef(null);return t.current===null&&(t.current=e()),t.current}const go=typeof window<"u",Du=go?le.useLayoutEffect:le.useEffect,Cs=le.createContext(null),vo=le.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class x2 extends le.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,i=n instanceof HTMLElement&&n.offsetWidth||0,s=this.props.sizeRef.current;s.height=r.offsetHeight||0,s.width=r.offsetWidth||0,s.top=r.offsetTop,s.left=r.offsetLeft,s.right=i-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function _2({children:e,isPresent:t,anchorX:r}){const n=le.useId(),i=le.useRef(null),s=le.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=le.useContext(vo);return le.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:f,right:u}=s.current;if(t||!i.current||!o||!l)return;const h=r==="left"?`left: ${f}`:`right: ${u}`;i.current.dataset.motionPopId=n;const d=document.createElement("style");return a&&(d.nonce=a),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),Jt.jsx(x2,{isPresent:t,childRef:i,sizeRef:s,children:le.cloneElement(e,{ref:i})})}const y2=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:i,presenceAffectsLayout:s,mode:a,anchorX:o})=>{const l=mo(w2),c=le.useId();let f=!0,u=le.useMemo(()=>(f=!1,{id:c,initial:t,isPresent:r,custom:i,onExitComplete:h=>{l.set(h,!0);for(const d of l.values())if(!d)return;n&&n()},register:h=>(l.set(h,!1),()=>l.delete(h))}),[r,l,n]);return s&&f&&(u={...u}),le.useMemo(()=>{l.forEach((h,d)=>l.set(d,!1))},[r]),le.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),a==="popLayout"&&(e=Jt.jsx(_2,{isPresent:r,anchorX:o,children:e})),Jt.jsx(Cs.Provider,{value:u,children:e})};function w2(){return new Map}function Iu(e=!0){const t=le.useContext(Cs);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:i}=t,s=le.useId();le.useEffect(()=>{if(e)return i(s)},[e]);const a=le.useCallback(()=>e&&n&&n(s),[s,n,e]);return!r&&n?[!1,a]:[!0]}const Wi=e=>e.key||"";function vc(e){const t=[];return le.Children.forEach(e,r=>{le.isValidElement(r)&&t.push(r)}),t}const p4=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1,anchorX:o="left"})=>{const[l,c]=Iu(a),f=le.useMemo(()=>vc(e),[e]),u=a&&!l?[]:f.map(Wi),h=le.useRef(!0),d=le.useRef(f),m=mo(()=>new Map),[p,g]=le.useState(f),[S,A]=le.useState(f);Du(()=>{h.current=!1,d.current=f;for(let b=0;b<S.length;b++){const W=Wi(S[b]);u.includes(W)?m.delete(W):m.get(W)!==!0&&m.set(W,!1)}},[S,u.length,u.join("-")]);const T=[];if(f!==p){let b=[...f];for(let W=0;W<S.length;W++){const F=S[W],I=Wi(F);u.includes(I)||(b.splice(W,0,F),T.push(F))}return s==="wait"&&T.length&&(b=T),A(vc(b)),g(f),null}const{forceRender:k}=le.useContext(po);return Jt.jsx(Jt.Fragment,{children:S.map(b=>{const W=Wi(b),F=a&&!l?!1:f===S||u.includes(W),I=()=>{if(m.has(W))m.set(W,!0);else return;let R=!0;m.forEach(V=>{V||(R=!1)}),R&&(k==null||k(),A(d.current),a&&(c==null||c()),n&&n())};return Jt.jsx(y2,{isPresent:F,initial:!h.current||r?void 0:!1,custom:t,presenceAffectsLayout:i,mode:s,onExitComplete:F?void 0:I,anchorX:o,children:b},W)})})};function xo(e,t){e.indexOf(t)===-1&&e.push(t)}function _o(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const nr=(e,t,r)=>r>t?t:r<e?e:r;let yo=()=>{};const ir={},Lu=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),Mu=e=>/^0[^.\s]+$/u.test(e);function wo(e){let t;return()=>(t===void 0&&(t=e()),t)}const Ot=e=>e,T2=(e,t)=>r=>t(e(r)),Ei=(...e)=>e.reduce(T2),li=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class To{constructor(){this.subscriptions=[]}add(t){return xo(this.subscriptions,t),()=>_o(this.subscriptions,t)}notify(t,r,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](t,r,n);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Wt=e=>e*1e3,Ht=e=>e/1e3;function Nu(e,t){return t?e*(1e3/t):0}const Bu=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,E2=1e-7,S2=12;function A2(e,t,r,n,i){let s,a,o=0;do a=t+(r-t)/2,s=Bu(a,n,i)-e,s>0?r=a:t=a;while(Math.abs(s)>E2&&++o<S2);return a}function Si(e,t,r,n){if(e===t&&r===n)return Ot;const i=s=>A2(s,0,1,e,r);return s=>s===0||s===1?s:Bu(i(s),t,n)}const Uu=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,ju=e=>t=>1-e(1-t),Vu=Si(.33,1.53,.69,.99),Eo=ju(Vu),$u=Uu(Eo),Wu=e=>(e*=2)<1?.5*Eo(e):.5*(2-Math.pow(2,-10*(e-1))),So=e=>1-Math.sin(Math.acos(e)),Hu=ju(So),Gu=Uu(So),C2=Si(.42,0,1,1),F2=Si(0,0,.58,1),Ku=Si(.42,0,.58,1),k2=e=>Array.isArray(e)&&typeof e[0]!="number",zu=e=>Array.isArray(e)&&typeof e[0]=="number",P2={linear:Ot,easeIn:C2,easeInOut:Ku,easeOut:F2,circIn:So,circInOut:Gu,circOut:Hu,backIn:Eo,backInOut:$u,backOut:Vu,anticipate:Wu},O2=e=>typeof e=="string",xc=e=>{if(zu(e)){yo(e.length===4);const[t,r,n,i]=e;return Si(t,r,n,i)}else if(O2(e))return P2[e];return e},Hi=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],_c={value:null};function b2(e,t){let r=new Set,n=new Set,i=!1,s=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(u){a.has(u)&&(f.schedule(u),e()),l++,u(o)}const f={schedule:(u,h=!1,d=!1)=>{const p=d&&i?r:n;return h&&a.add(u),p.has(u)||p.add(u),u},cancel:u=>{n.delete(u),a.delete(u)},process:u=>{if(o=u,i){s=!0;return}i=!0,[r,n]=[n,r],r.forEach(c),t&&_c.value&&_c.value.frameloop[t].push(l),l=0,r.clear(),i=!1,s&&(s=!1,f.process(u))}};return f}const R2=40;function Xu(e,t){let r=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>r=!0,a=Hi.reduce((T,k)=>(T[k]=b2(s,t?k:void 0),T),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:f,update:u,preRender:h,render:d,postRender:m}=a,p=()=>{const T=ir.useManualTiming?i.timestamp:performance.now();r=!1,ir.useManualTiming||(i.delta=n?1e3/60:Math.max(Math.min(T-i.timestamp,R2),1)),i.timestamp=T,i.isProcessing=!0,o.process(i),l.process(i),c.process(i),f.process(i),u.process(i),h.process(i),d.process(i),m.process(i),i.isProcessing=!1,r&&t&&(n=!1,e(p))},g=()=>{r=!0,n=!0,i.isProcessing||e(p)};return{schedule:Hi.reduce((T,k)=>{const b=a[k];return T[k]=(W,F=!1,I=!1)=>(r||g(),b.schedule(W,F,I)),T},{}),cancel:T=>{for(let k=0;k<Hi.length;k++)a[Hi[k]].cancel(T)},state:i,steps:a}}const{schedule:Le,cancel:vr,state:Ze,steps:Js}=Xu(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ot,!0);let Xi;function D2(){Xi=void 0}const mt={now:()=>(Xi===void 0&&mt.set(Ze.isProcessing||ir.useManualTiming?Ze.timestamp:performance.now()),Xi),set:e=>{Xi=e,queueMicrotask(D2)}},qu=e=>t=>typeof t=="string"&&t.startsWith(e),Ao=qu("--"),I2=qu("var(--"),Co=e=>I2(e)?L2.test(e.split("/*")[0].trim()):!1,L2=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Cn={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},ci={...Cn,transform:e=>nr(0,1,e)},Gi={...Cn,default:1},qn=e=>Math.round(e*1e5)/1e5,Fo=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function M2(e){return e==null}const N2=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,ko=(e,t)=>r=>!!(typeof r=="string"&&N2.test(r)&&r.startsWith(e)||t&&!M2(r)&&Object.prototype.hasOwnProperty.call(r,t)),Yu=(e,t,r)=>n=>{if(typeof n!="string")return n;const[i,s,a,o]=n.match(Fo);return{[e]:parseFloat(i),[t]:parseFloat(s),[r]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},B2=e=>nr(0,255,e),Zs={...Cn,transform:e=>Math.round(B2(e))},br={test:ko("rgb","red"),parse:Yu("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+Zs.transform(e)+", "+Zs.transform(t)+", "+Zs.transform(r)+", "+qn(ci.transform(n))+")"};function U2(e){let t="",r="",n="",i="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),i=e.substring(4,5),t+=t,r+=r,n+=n,i+=i),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const Ta={test:ko("#"),parse:U2,transform:br.transform},Ai=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),cr=Ai("deg"),Gt=Ai("%"),ue=Ai("px"),j2=Ai("vh"),V2=Ai("vw"),yc={...Gt,parse:e=>Gt.parse(e)/100,transform:e=>Gt.transform(e*100)},an={test:ko("hsl","hue"),parse:Yu("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Gt.transform(qn(t))+", "+Gt.transform(qn(r))+", "+qn(ci.transform(n))+")"},st={test:e=>br.test(e)||Ta.test(e)||an.test(e),parse:e=>br.test(e)?br.parse(e):an.test(e)?an.parse(e):Ta.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?br.transform(e):an.transform(e)},$2=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function W2(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Fo))==null?void 0:t.length)||0)+(((r=e.match($2))==null?void 0:r.length)||0)>0}const Ju="number",Zu="color",H2="var",G2="var(",wc="${}",K2=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function fi(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},i=[];let s=0;const o=t.replace(K2,l=>(st.test(l)?(n.color.push(s),i.push(Zu),r.push(st.parse(l))):l.startsWith(G2)?(n.var.push(s),i.push(H2),r.push(l)):(n.number.push(s),i.push(Ju),r.push(parseFloat(l))),++s,wc)).split(wc);return{values:r,split:o,indexes:n,types:i}}function Qu(e){return fi(e).values}function eh(e){const{split:t,types:r}=fi(e),n=t.length;return i=>{let s="";for(let a=0;a<n;a++)if(s+=t[a],i[a]!==void 0){const o=r[a];o===Ju?s+=qn(i[a]):o===Zu?s+=st.transform(i[a]):s+=i[a]}return s}}const z2=e=>typeof e=="number"?0:e;function X2(e){const t=Qu(e);return eh(e)(t.map(z2))}const xr={test:W2,parse:Qu,createTransformer:eh,getAnimatableNone:X2};function Qs(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function q2({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let i=0,s=0,a=0;if(!t)i=s=a=r;else{const o=r<.5?r*(1+t):r+t-r*t,l=2*r-o;i=Qs(l,o,e+1/3),s=Qs(l,o,e),a=Qs(l,o,e-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:n}}function hs(e,t){return r=>r>0?t:e}const Ie=(e,t,r)=>e+(t-e)*r,ea=(e,t,r)=>{const n=e*e,i=r*(t*t-n)+n;return i<0?0:Math.sqrt(i)},Y2=[Ta,br,an],J2=e=>Y2.find(t=>t.test(e));function Tc(e){const t=J2(e);if(!t)return!1;let r=t.parse(e);return t===an&&(r=q2(r)),r}const Ec=(e,t)=>{const r=Tc(e),n=Tc(t);if(!r||!n)return hs(e,t);const i={...r};return s=>(i.red=ea(r.red,n.red,s),i.green=ea(r.green,n.green,s),i.blue=ea(r.blue,n.blue,s),i.alpha=Ie(r.alpha,n.alpha,s),br.transform(i))},Ea=new Set(["none","hidden"]);function Z2(e,t){return Ea.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function Q2(e,t){return r=>Ie(e,t,r)}function Po(e){return typeof e=="number"?Q2:typeof e=="string"?Co(e)?hs:st.test(e)?Ec:rT:Array.isArray(e)?th:typeof e=="object"?st.test(e)?Ec:eT:hs}function th(e,t){const r=[...e],n=r.length,i=e.map((s,a)=>Po(s)(s,t[a]));return s=>{for(let a=0;a<n;a++)r[a]=i[a](s);return r}}function eT(e,t){const r={...e,...t},n={};for(const i in r)e[i]!==void 0&&t[i]!==void 0&&(n[i]=Po(e[i])(e[i],t[i]));return i=>{for(const s in n)r[s]=n[s](i);return r}}function tT(e,t){const r=[],n={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const s=t.types[i],a=e.indexes[s][n[s]],o=e.values[a]??0;r[i]=o,n[s]++}return r}const rT=(e,t)=>{const r=xr.createTransformer(t),n=fi(e),i=fi(t);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?Ea.has(e)&&!i.values.length||Ea.has(t)&&!n.values.length?Z2(e,t):Ei(th(tT(n,i),i.values),r):hs(e,t)};function rh(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?Ie(e,t,r):Po(e)(e,t)}const nT=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Le.update(t,!0),stop:()=>vr(t),now:()=>Ze.isProcessing?Ze.timestamp:mt.now()}},nh=(e,t,r=10)=>{let n="";const i=Math.max(Math.round(t/r),2);for(let s=0;s<i;s++)n+=e(s/(i-1))+", ";return`linear(${n.substring(0,n.length-2)})`},ds=2e4;function Oo(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<ds;)t+=r,n=e.next(t);return t>=ds?1/0:t}function iT(e,t=100,r){const n=r({...e,keyframes:[0,t]}),i=Math.min(Oo(n),ds);return{type:"keyframes",ease:s=>n.next(i*s).value/t,duration:Ht(i)}}const sT=5;function ih(e,t,r){const n=Math.max(t-sT,0);return Nu(r-e(n),t-n)}const Ne={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Sc=.001;function aT({duration:e=Ne.duration,bounce:t=Ne.bounce,velocity:r=Ne.velocity,mass:n=Ne.mass}){let i,s,a=1-t;a=nr(Ne.minDamping,Ne.maxDamping,a),e=nr(Ne.minDuration,Ne.maxDuration,Ht(e)),a<1?(i=c=>{const f=c*a,u=f*e,h=f-r,d=Sa(c,a),m=Math.exp(-u);return Sc-h/d*m},s=c=>{const u=c*a*e,h=u*r+r,d=Math.pow(a,2)*Math.pow(c,2)*e,m=Math.exp(-u),p=Sa(Math.pow(c,2),a);return(-i(c)+Sc>0?-1:1)*((h-d)*m)/p}):(i=c=>{const f=Math.exp(-c*e),u=(c-r)*e+1;return-.001+f*u},s=c=>{const f=Math.exp(-c*e),u=(r-c)*(e*e);return f*u});const o=5/e,l=lT(i,s,o);if(e=Wt(e),isNaN(l))return{stiffness:Ne.stiffness,damping:Ne.damping,duration:e};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:a*2*Math.sqrt(n*c),duration:e}}}const oT=12;function lT(e,t,r){let n=r;for(let i=1;i<oT;i++)n=n-e(n)/t(n);return n}function Sa(e,t){return e*Math.sqrt(1-t*t)}const cT=["duration","bounce"],fT=["stiffness","damping","mass"];function Ac(e,t){return t.some(r=>e[r]!==void 0)}function uT(e){let t={velocity:Ne.velocity,stiffness:Ne.stiffness,damping:Ne.damping,mass:Ne.mass,isResolvedFromDuration:!1,...e};if(!Ac(e,fT)&&Ac(e,cT))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),i=n*n,s=2*nr(.05,1,1-(e.bounce||0))*Math.sqrt(i);t={...t,mass:Ne.mass,stiffness:i,damping:s}}else{const r=aT(e);t={...t,...r,mass:Ne.mass},t.isResolvedFromDuration=!0}return t}function ps(e=Ne.visualDuration,t=Ne.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:i}=r;const s=r.keyframes[0],a=r.keyframes[r.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:f,duration:u,velocity:h,isResolvedFromDuration:d}=uT({...r,velocity:-Ht(r.velocity||0)}),m=h||0,p=c/(2*Math.sqrt(l*f)),g=a-s,S=Ht(Math.sqrt(l/f)),A=Math.abs(g)<5;n||(n=A?Ne.restSpeed.granular:Ne.restSpeed.default),i||(i=A?Ne.restDelta.granular:Ne.restDelta.default);let T;if(p<1){const b=Sa(S,p);T=W=>{const F=Math.exp(-p*S*W);return a-F*((m+p*S*g)/b*Math.sin(b*W)+g*Math.cos(b*W))}}else if(p===1)T=b=>a-Math.exp(-S*b)*(g+(m+S*g)*b);else{const b=S*Math.sqrt(p*p-1);T=W=>{const F=Math.exp(-p*S*W),I=Math.min(b*W,300);return a-F*((m+p*S*g)*Math.sinh(I)+b*g*Math.cosh(I))/b}}const k={calculatedDuration:d&&u||null,next:b=>{const W=T(b);if(d)o.done=b>=u;else{let F=b===0?m:0;p<1&&(F=b===0?Wt(m):ih(T,b,W));const I=Math.abs(F)<=n,R=Math.abs(a-W)<=i;o.done=I&&R}return o.value=o.done?a:W,o},toString:()=>{const b=Math.min(Oo(k),ds),W=nh(F=>k.next(b*F).value,b,30);return b+"ms "+W},toTransition:()=>{}};return k}ps.applyToOptions=e=>{const t=iT(e,100,ps);return e.ease=t.ease,e.duration=Wt(t.duration),e.type="keyframes",e};function Aa({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:f}){const u=e[0],h={done:!1,value:u},d=I=>o!==void 0&&I<o||l!==void 0&&I>l,m=I=>o===void 0?l:l===void 0||Math.abs(o-I)<Math.abs(l-I)?o:l;let p=r*t;const g=u+p,S=a===void 0?g:a(g);S!==g&&(p=S-u);const A=I=>-p*Math.exp(-I/n),T=I=>S+A(I),k=I=>{const R=A(I),V=T(I);h.done=Math.abs(R)<=c,h.value=h.done?S:V};let b,W;const F=I=>{d(h.value)&&(b=I,W=ps({keyframes:[h.value,m(h.value)],velocity:ih(T,I,h.value),damping:i,stiffness:s,restDelta:c,restSpeed:f}))};return F(0),{calculatedDuration:null,next:I=>{let R=!1;return!W&&b===void 0&&(R=!0,k(I),F(I)),b!==void 0&&I>=b?W.next(I-b):(!R&&k(I),h)}}}function hT(e,t,r){const n=[],i=r||ir.mix||rh,s=e.length-1;for(let a=0;a<s;a++){let o=i(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||Ot:t;o=Ei(l,o)}n.push(o)}return n}function dT(e,t,{clamp:r=!0,ease:n,mixer:i}={}){const s=e.length;if(yo(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=hT(t,n,i),l=o.length,c=f=>{if(a&&f<e[0])return t[0];let u=0;if(l>1)for(;u<e.length-2&&!(f<e[u+1]);u++);const h=li(e[u],e[u+1],f);return o[u](h)};return r?f=>c(nr(e[0],e[s-1],f)):c}function pT(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const i=li(0,t,n);e.push(Ie(r,1,i))}}function mT(e){const t=[0];return pT(t,e.length-1),t}function gT(e,t){return e.map(r=>r*t)}function vT(e,t){return e.map(()=>t||Ku).splice(0,e.length-1)}function Yn({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const i=k2(n)?n.map(xc):xc(n),s={done:!1,value:t[0]},a=gT(r&&r.length===t.length?r:mT(t),e),o=dT(a,t,{ease:Array.isArray(i)?i:vT(t,i)});return{calculatedDuration:e,next:l=>(s.value=o(l),s.done=l>=e,s)}}const xT=e=>e!==null;function bo(e,{repeat:t,repeatType:r="loop"},n,i=1){const s=e.filter(xT),o=i<0||t&&r!=="loop"&&t%2===1?0:s.length-1;return!o||n===void 0?s[o]:n}const _T={decay:Aa,inertia:Aa,tween:Yn,keyframes:Yn,spring:ps};function sh(e){typeof e.type=="string"&&(e.type=_T[e.type])}class Ro{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const yT=e=>e/100;class ah extends Ro{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;if(r&&r.updatedAt!==mt.now()&&this.tick(mt.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:n}=this.options;n&&n()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;sh(t);const{type:r=Yn,repeat:n=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=t;let{keyframes:o}=t;const l=r||Yn;l!==Yn&&typeof o[0]!="number"&&(this.mixKeyframes=Ei(yT,rh(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});s==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=Oo(c));const{calculatedDuration:f}=c;this.calculatedDuration=f,this.resolvedDuration=f+i,this.totalDuration=this.resolvedDuration*(n+1)-i,this.generator=c}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:i,mixKeyframes:s,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return n.next(0);const{delay:c=0,keyframes:f,repeat:u,repeatType:h,repeatDelay:d,type:m,onUpdate:p,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-i/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const S=this.currentTime-c*(this.playbackSpeed>=0?1:-1),A=this.playbackSpeed>=0?S<0:S>i;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let T=this.currentTime,k=n;if(u){const I=Math.min(this.currentTime,i)/o;let R=Math.floor(I),V=I%1;!V&&I>=1&&(V=1),V===1&&R--,R=Math.min(R,u+1),!!(R%2)&&(h==="reverse"?(V=1-V,d&&(V-=d/o)):h==="mirror"&&(k=a)),T=nr(0,1,V)*o}const b=A?{done:!1,value:f[0]}:k.next(T);s&&(b.value=s(b.value));let{done:W}=b;!A&&l!==null&&(W=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const F=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&W);return F&&m!==Aa&&(b.value=bo(f,this.options,g,this.speed)),p&&p(b.value),F&&this.finish(),b}then(t,r){return this.finished.then(t,r)}get duration(){return Ht(this.calculatedDuration)}get time(){return Ht(this.currentTime)}set time(t){t=Wt(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(mt.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Ht(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=nT,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),r&&r();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(mt.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function wT(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Rr=e=>e*180/Math.PI,Ca=e=>{const t=Rr(Math.atan2(e[1],e[0]));return Fa(t)},TT={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Ca,rotateZ:Ca,skewX:e=>Rr(Math.atan(e[1])),skewY:e=>Rr(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Fa=e=>(e=e%360,e<0&&(e+=360),e),Cc=Ca,Fc=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),kc=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),ET={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Fc,scaleY:kc,scale:e=>(Fc(e)+kc(e))/2,rotateX:e=>Fa(Rr(Math.atan2(e[6],e[5]))),rotateY:e=>Fa(Rr(Math.atan2(-e[2],e[0]))),rotateZ:Cc,rotate:Cc,skewX:e=>Rr(Math.atan(e[4])),skewY:e=>Rr(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Pc(e){return e.includes("scale")?1:0}function ka(e,t){if(!e||e==="none")return Pc(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,i;if(r)n=ET,i=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=TT,i=o}if(!i)return Pc(t);const s=n[t],a=i[1].split(",").map(AT);return typeof s=="function"?s(a):a[s]}const ST=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return ka(r,t)};function AT(e){return parseFloat(e.trim())}const Fn=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],kn=new Set(Fn),Oc=e=>e===Cn||e===ue,CT=new Set(["x","y","z"]),FT=Fn.filter(e=>!CT.has(e));function kT(e){const t=[];return FT.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const _n={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>ka(t,"x"),y:(e,{transform:t})=>ka(t,"y")};_n.translateX=_n.x;_n.translateY=_n.y;const Ir=new Set;let Pa=!1,Oa=!1,ba=!1;function oh(){if(Oa){const e=Array.from(Ir).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const i=kT(n);i.length&&(r.set(n,i),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const i=r.get(n);i&&i.forEach(([s,a])=>{var o;(o=n.getValue(s))==null||o.set(a)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Oa=!1,Pa=!1,Ir.forEach(e=>e.complete(ba)),Ir.clear()}function lh(){Ir.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Oa=!0)})}function PT(){ba=!0,lh(),oh(),ba=!1}class Do{constructor(t,r,n,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Ir.add(this),Pa||(Pa=!0,Le.read(lh),Le.resolveKeyframes(oh))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:i}=this;if(t[0]===null){const s=i==null?void 0:i.get(),a=t[t.length-1];if(s!==void 0)t[0]=s;else if(n&&r){const o=n.readValue(r,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),i&&s===void 0&&i.set(t[0])}wT(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Ir.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Ir.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const OT=e=>e.startsWith("--");function bT(e,t,r){OT(t)?e.style.setProperty(t,r):e.style[t]=r}const RT=wo(()=>window.ScrollTimeline!==void 0),DT={};function IT(e,t){const r=wo(e);return()=>DT[t]??r()}const ch=IT(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Bn=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,bc={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Bn([0,.65,.55,1]),circOut:Bn([.55,0,1,.45]),backIn:Bn([.31,.01,.66,-.59]),backOut:Bn([.33,1.53,.69,.99])};function fh(e,t){if(e)return typeof e=="function"?ch()?nh(e,t):"ease-out":zu(e)?Bn(e):Array.isArray(e)?e.map(r=>fh(r,t)||bc.easeOut):bc[e]}function LT(e,t,r,{delay:n=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const f={[t]:r};l&&(f.offset=l);const u=fh(o,i);Array.isArray(u)&&(f.easing=u);const h={delay:n,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),e.animate(f,h)}function uh(e){return typeof e=="function"&&"applyToOptions"in e}function MT({type:e,...t}){return uh(e)&&ch()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class NT extends Ro{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:i,pseudoElement:s,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!s,this.allowFlatten=a,this.options=t,yo(typeof t.type!="string");const c=MT(t);this.animation=LT(r,n,i,c,s),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const f=bo(i,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(f):bT(r,n,f),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,n;const t=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return Ht(Number(t))}get time(){return Ht(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Wt(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&RT()?(this.animation.timeline=t,Ot):r(this)}}const hh={anticipate:Wu,backInOut:$u,circInOut:Gu};function BT(e){return e in hh}function UT(e){typeof e.ease=="string"&&BT(e.ease)&&(e.ease=hh[e.ease])}const Rc=10;class jT extends NT{constructor(t){UT(t),sh(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:i,element:s,...a}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new ah({...a,autoplay:!1}),l=Wt(this.finishedTime??this.time);r.setWithVelocity(o.sample(l-Rc).value,o.sample(l).value,Rc),o.stop()}}const Dc=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(xr.test(e)||e==="0")&&!e.startsWith("url("));function VT(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function $T(e,t,r,n){const i=e[0];if(i===null)return!1;if(t==="display"||t==="visibility")return!0;const s=e[e.length-1],a=Dc(i,t),o=Dc(s,t);return!a||!o?!1:VT(e)||(r==="spring"||uh(r))&&n}const WT=new Set(["opacity","clipPath","filter","transform"]),HT=wo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function GT(e){const{motionValue:t,name:r,repeatDelay:n,repeatType:i,damping:s,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return HT()&&r&&WT.has(r)&&(r!=="transform"||!l)&&!o&&!n&&i!=="mirror"&&s!==0&&a!=="inertia"}const KT=40;class zT extends Ro{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:f,...u}){var m;super(),this.stop=()=>{var p,g;this._animation?(this._animation.stop(),(p=this.stopTimeline)==null||p.call(this)):(g=this.keyframeResolver)==null||g.cancel()},this.createdAt=mt.now();const h={autoplay:t,delay:r,type:n,repeat:i,repeatDelay:s,repeatType:a,name:l,motionValue:c,element:f,...u},d=(f==null?void 0:f.KeyframeResolver)||Do;this.keyframeResolver=new d(o,(p,g,S)=>this.onKeyframesResolved(p,g,h,!S),l,c,f),(m=this.keyframeResolver)==null||m.scheduleResolve()}onKeyframesResolved(t,r,n,i){this.keyframeResolver=void 0;const{name:s,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:f}=n;this.resolvedAt=mt.now(),$T(t,s,a,o)||((ir.instantAnimations||!l)&&(f==null||f(bo(t,n,r))),t[0]=t[t.length-1],n.duration=0,n.repeat=0);const h={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>KT?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},d=!c&&GT(h)?new jT({...h,element:h.motionValue.owner.current}):new ah(h);d.finished.then(()=>this.notifyFinished()).catch(Ot),this.pendingTimeline&&(this.stopTimeline=d.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=d}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||PT(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const XT=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function qT(e){const t=XT.exec(e);if(!t)return[,];const[,r,n,i]=t;return[`--${r??n}`,i]}function dh(e,t,r=1){const[n,i]=qT(e);if(!n)return;const s=window.getComputedStyle(t).getPropertyValue(n);if(s){const a=s.trim();return Lu(a)?parseFloat(a):a}return Co(i)?dh(i,t,r+1):i}function Io(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const ph=new Set(["width","height","top","left","right","bottom",...Fn]),YT={test:e=>e==="auto",parse:e=>e},mh=e=>t=>t.test(e),gh=[Cn,ue,Gt,cr,V2,j2,YT],Ic=e=>gh.find(mh(e));function JT(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Mu(e):!0}const ZT=new Set(["brightness","contrast","saturate","opacity"]);function QT(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(Fo)||[];if(!n)return e;const i=r.replace(n,"");let s=ZT.has(t)?1:0;return n!==r&&(s*=100),t+"("+s+i+")"}const eE=/\b([a-z-]*)\(.*?\)/gu,Ra={...xr,getAnimatableNone:e=>{const t=e.match(eE);return t?t.map(QT).join(" "):e}},Lc={...Cn,transform:Math.round},tE={rotate:cr,rotateX:cr,rotateY:cr,rotateZ:cr,scale:Gi,scaleX:Gi,scaleY:Gi,scaleZ:Gi,skew:cr,skewX:cr,skewY:cr,distance:ue,translateX:ue,translateY:ue,translateZ:ue,x:ue,y:ue,z:ue,perspective:ue,transformPerspective:ue,opacity:ci,originX:yc,originY:yc,originZ:ue},Lo={borderWidth:ue,borderTopWidth:ue,borderRightWidth:ue,borderBottomWidth:ue,borderLeftWidth:ue,borderRadius:ue,radius:ue,borderTopLeftRadius:ue,borderTopRightRadius:ue,borderBottomRightRadius:ue,borderBottomLeftRadius:ue,width:ue,maxWidth:ue,height:ue,maxHeight:ue,top:ue,right:ue,bottom:ue,left:ue,padding:ue,paddingTop:ue,paddingRight:ue,paddingBottom:ue,paddingLeft:ue,margin:ue,marginTop:ue,marginRight:ue,marginBottom:ue,marginLeft:ue,backgroundPositionX:ue,backgroundPositionY:ue,...tE,zIndex:Lc,fillOpacity:ci,strokeOpacity:ci,numOctaves:Lc},rE={...Lo,color:st,backgroundColor:st,outlineColor:st,fill:st,stroke:st,borderColor:st,borderTopColor:st,borderRightColor:st,borderBottomColor:st,borderLeftColor:st,filter:Ra,WebkitFilter:Ra},vh=e=>rE[e];function xh(e,t){let r=vh(e);return r!==Ra&&(r=xr),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const nE=new Set(["auto","none","0"]);function iE(e,t,r){let n=0,i;for(;n<e.length&&!i;){const s=e[n];typeof s=="string"&&!nE.has(s)&&fi(s).values.length&&(i=e[n]),n++}if(i&&r)for(const s of t)e[s]=xh(r,i)}class sE extends Do{constructor(t,r,n,i,s){super(t,r,n,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),Co(c))){const f=dh(c,r.current);f!==void 0&&(t[l]=f),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!ph.has(n)||t.length!==2)return;const[i,s]=t,a=Ic(i),o=Ic(s);if(a!==o)if(Oc(a)&&Oc(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let i=0;i<t.length;i++)(t[i]===null||JT(t[i]))&&n.push(i);n.length&&iE(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=_n[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const i=r[r.length-1];i!==void 0&&t.getValue(n,i).jump(i,!1)}measureEndState(){var o;const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const i=t.getValue(r);i&&i.jump(this.measuredOrigin,!1);const s=n.length-1,a=n[s];n[s]=_n[r](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function aE(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const i=(r==null?void 0:r[e])??n.querySelectorAll(e);return i?Array.from(i):[]}return Array.from(e)}const{schedule:Mo}=Xu(queueMicrotask,!1),It={x:!1,y:!1};function _h(){return It.x||It.y}function oE(e){return e==="x"||e==="y"?It[e]?null:(It[e]=!0,()=>{It[e]=!1}):It.x||It.y?null:(It.x=It.y=!0,()=>{It.x=It.y=!1})}function yh(e,t){const r=aE(e),n=new AbortController,i={passive:!0,...t,signal:n.signal};return[r,i,()=>n.abort()]}function Mc(e){return!(e.pointerType==="touch"||_h())}function lE(e,t,r={}){const[n,i,s]=yh(e,r),a=o=>{if(!Mc(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const f=u=>{Mc(u)&&(c(u),l.removeEventListener("pointerleave",f))};l.addEventListener("pointerleave",f,i)};return n.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const wh=(e,t)=>t?e===t?!0:wh(e,t.parentElement):!1,No=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,cE=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function fE(e){return cE.has(e.tagName)||e.tabIndex!==-1}const Un=new WeakSet;function Nc(e){return t=>{t.key==="Enter"&&e(t)}}function ta(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const uE=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=Nc(()=>{if(Un.has(r))return;ta(r,"down");const i=Nc(()=>{ta(r,"up")}),s=()=>ta(r,"cancel");r.addEventListener("keyup",i,t),r.addEventListener("blur",s,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function Bc(e){return No(e)&&!_h()}function hE(e,t,r={}){const[n,i,s]=yh(e,r),a=o=>{const l=o.currentTarget;if(!Bc(o)||Un.has(l))return;Un.add(l);const c=t(l,o),f=(d,m)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",h),!(!Bc(d)||!Un.has(l))&&(Un.delete(l),typeof c=="function"&&c(d,{success:m}))},u=d=>{f(d,l===window||l===document||r.useGlobalTarget||wh(l,d.target))},h=d=>{f(d,!1)};window.addEventListener("pointerup",u,i),window.addEventListener("pointercancel",h,i)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o instanceof HTMLElement&&(o.addEventListener("focus",c=>uE(c,i)),!fE(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),s}const Uc=30,dE=e=>!isNaN(parseFloat(e));class pE{constructor(t,r={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,i=!0)=>{var a,o;const s=mt.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current)),i&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=mt.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=dE(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new To);const n=this.events[t].add(r);return t==="change"?()=>{n(),Le.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=mt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Uc)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Uc);return Nu(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ui(e,t){return new pE(e,t)}const mE=[...gh,st,xr],gE=e=>mE.find(mh(e)),Th=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Eh=le.createContext({strict:!1}),jc={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},yn={};for(const e in jc)yn[e]={isEnabled:t=>jc[e].some(r=>!!t[r])};function vE(e){for(const t in e)yn[t]={...yn[t],...e[t]}}const xE=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ms(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||xE.has(e)}let Sh=e=>!ms(e);function _E(e){e&&(Sh=t=>t.startsWith("on")?!ms(t):e(t))}try{_E(require("@emotion/is-prop-valid").default)}catch{}function yE(e,t,r){const n={};for(const i in e)i==="values"&&typeof e.values=="object"||(Sh(i)||r===!0&&ms(i)||!t&&!ms(i)||e.draggable&&i.startsWith("onDrag"))&&(n[i]=e[i]);return n}function wE(e){if(typeof Proxy>"u")return e;const t=new Map,r=(...n)=>e(...n);return new Proxy(r,{get:(n,i)=>i==="create"?e:(t.has(i)||t.set(i,e(i)),t.get(i))})}const Fs=le.createContext({});function ks(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function hi(e){return typeof e=="string"||Array.isArray(e)}const Bo=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Uo=["initial",...Bo];function Ps(e){return ks(e.animate)||Uo.some(t=>hi(e[t]))}function Ah(e){return!!(Ps(e)||e.variants)}function TE(e,t){if(Ps(e)){const{initial:r,animate:n}=e;return{initial:r===!1||hi(r)?r:void 0,animate:hi(n)?n:void 0}}return e.inherit!==!1?t:{}}function EE(e){const{initial:t,animate:r}=TE(e,le.useContext(Fs));return le.useMemo(()=>({initial:t,animate:r}),[Vc(t),Vc(r)])}function Vc(e){return Array.isArray(e)?e.join(" "):e}const SE=Symbol.for("motionComponentSymbol");function on(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function AE(e,t,r){return le.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):on(r)&&(r.current=n))},[t])}const jo=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),CE="framerAppearId",Ch="data-"+jo(CE),Fh=le.createContext({});function FE(e,t,r,n,i){var p,g;const{visualElement:s}=le.useContext(Fs),a=le.useContext(Eh),o=le.useContext(Cs),l=le.useContext(vo).reducedMotion,c=le.useRef(null);n=n||a.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:s,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const f=c.current,u=le.useContext(Fh);f&&!f.projection&&i&&(f.type==="html"||f.type==="svg")&&kE(c.current,r,i,u);const h=le.useRef(!1);le.useInsertionEffect(()=>{f&&h.current&&f.update(r,o)});const d=r[Ch],m=le.useRef(!!d&&!((p=window.MotionHandoffIsComplete)!=null&&p.call(window,d))&&((g=window.MotionHasOptimisedAnimation)==null?void 0:g.call(window,d)));return Du(()=>{f&&(h.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),Mo.render(f.render),m.current&&f.animationState&&f.animationState.animateChanges())}),le.useEffect(()=>{f&&(!m.current&&f.animationState&&f.animationState.animateChanges(),m.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)==null||S.call(window,d)}),m.current=!1))}),f}function kE(e,t,r,n){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:f}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:kh(e.parent)),e.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&on(o),visualElement:e,animationType:typeof s=="string"?s:"both",initialPromotionConfig:n,crossfade:f,layoutScroll:l,layoutRoot:c})}function kh(e){if(e)return e.options.allowProjection!==!1?e.projection:kh(e.parent)}function PE({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:i}){e&&vE(e);function s(o,l){let c;const f={...le.useContext(vo),...o,layoutId:OE(o)},{isStatic:u}=f,h=EE(o),d=n(o,u);if(!u&&go){bE();const m=RE(f);c=m.MeasureLayout,h.visualElement=FE(i,d,f,t,m.ProjectionNode)}return Jt.jsxs(Fs.Provider,{value:h,children:[c&&h.visualElement?Jt.jsx(c,{visualElement:h.visualElement,...f}):null,r(i,o,AE(d,h.visualElement,l),d,u,h.visualElement)]})}s.displayName=`motion.${typeof i=="string"?i:`create(${i.displayName??i.name??""})`}`;const a=le.forwardRef(s);return a[SE]=i,a}function OE({layoutId:e}){const t=le.useContext(po).id;return t&&e!==void 0?t+"-"+e:e}function bE(e,t){le.useContext(Eh).strict}function RE(e){const{drag:t,layout:r}=yn;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const di={};function DE(e){for(const t in e)di[t]=e[t],Ao(t)&&(di[t].isCSSVariable=!0)}function Ph(e,{layout:t,layoutId:r}){return kn.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!di[e]||e==="opacity")}const at=e=>!!(e&&e.getVelocity),IE={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},LE=Fn.length;function ME(e,t,r){let n="",i=!0;for(let s=0;s<LE;s++){const a=Fn[s],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||r){const c=Th(o,Lo[a]);if(!l){i=!1;const f=IE[a]||a;n+=`${f}(${c}) `}r&&(t[a]=c)}}return n=n.trim(),r?n=r(t,i?"":n):i&&(n="none"),n}function Vo(e,t,r){const{style:n,vars:i,transformOrigin:s}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(kn.has(l)){a=!0;continue}else if(Ao(l)){i[l]=c;continue}else{const f=Th(c,Lo[l]);l.startsWith("origin")?(o=!0,s[l]=f):n[l]=f}}if(t.transform||(a||r?n.transform=ME(t,e.transform,r):n.transform&&(n.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:f=0}=s;n.transformOrigin=`${l} ${c} ${f}`}}const $o=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Oh(e,t,r){for(const n in t)!at(t[n])&&!Ph(n,r)&&(e[n]=t[n])}function NE({transformTemplate:e},t){return le.useMemo(()=>{const r=$o();return Vo(r,t,e),Object.assign({},r.vars,r.style)},[t])}function BE(e,t){const r=e.style||{},n={};return Oh(n,r,e),Object.assign(n,NE(e,t)),n}function UE(e,t){const r={},n=BE(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const jE=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Wo(e){return typeof e!="string"||e.includes("-")?!1:!!(jE.indexOf(e)>-1||/[A-Z]/u.test(e))}const VE={offset:"stroke-dashoffset",array:"stroke-dasharray"},$E={offset:"strokeDashoffset",array:"strokeDasharray"};function WE(e,t,r=1,n=0,i=!0){e.pathLength=1;const s=i?VE:$E;e[s.offset]=ue.transform(-n);const a=ue.transform(t),o=ue.transform(r);e[s.array]=`${a} ${o}`}function bh(e,{attrX:t,attrY:r,attrScale:n,pathLength:i,pathSpacing:s=1,pathOffset:a=0,...o},l,c){if(Vo(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:u}=e;f.transform&&(u.transform=f.transform,delete f.transform),(u.transform||f.transformOrigin)&&(u.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),u.transform&&(u.transformBox="fill-box",delete f.transformBox),t!==void 0&&(f.x=t),r!==void 0&&(f.y=r),n!==void 0&&(f.scale=n),i!==void 0&&WE(f,i,s,a,!1)}const Rh=()=>({...$o(),attrs:{}}),Dh=e=>typeof e=="string"&&e.toLowerCase()==="svg";function HE(e,t,r,n){const i=le.useMemo(()=>{const s=Rh();return bh(s,t,Dh(n),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};Oh(s,e.style,e),i.style={...s,...i.style}}return i}function GE(e=!1){return(r,n,i,{latestValues:s},a)=>{const l=(Wo(r)?HE:UE)(n,s,a,r),c=yE(n,typeof r=="string",e),f=r!==le.Fragment?{...c,...l,ref:i}:{},{children:u}=n,h=le.useMemo(()=>at(u)?u.get():u,[u]);return le.createElement(r,{...f,children:h})}}function $c(e){const t=[{},{}];return e==null||e.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function Ho(e,t,r,n){if(typeof t=="function"){const[i,s]=$c(n);t=t(r!==void 0?r:e.custom,i,s)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[i,s]=$c(n);t=t(r!==void 0?r:e.custom,i,s)}return t}function qi(e){return at(e)?e.get():e}function KE({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,i){return{latestValues:zE(r,n,i,e),renderState:t()}}const Ih=e=>(t,r)=>{const n=le.useContext(Fs),i=le.useContext(Cs),s=()=>KE(e,t,n,i);return r?s():mo(s)};function zE(e,t,r,n){const i={},s=n(e,{});for(const h in s)i[h]=qi(s[h]);let{initial:a,animate:o}=e;const l=Ps(e),c=Ah(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let f=r?r.initial===!1:!1;f=f||a===!1;const u=f?o:a;if(u&&typeof u!="boolean"&&!ks(u)){const h=Array.isArray(u)?u:[u];for(let d=0;d<h.length;d++){const m=Ho(e,h[d]);if(m){const{transitionEnd:p,transition:g,...S}=m;for(const A in S){let T=S[A];if(Array.isArray(T)){const k=f?T.length-1:0;T=T[k]}T!==null&&(i[A]=T)}for(const A in p)i[A]=p[A]}}}return i}function Go(e,t,r){var s;const{style:n}=e,i={};for(const a in n)(at(n[a])||t.style&&at(t.style[a])||Ph(a,e)||((s=r==null?void 0:r.getValue(a))==null?void 0:s.liveStyle)!==void 0)&&(i[a]=n[a]);return i}const XE={useVisualState:Ih({scrapeMotionValuesFromProps:Go,createRenderState:$o})};function Lh(e,t,r){const n=Go(e,t,r);for(const i in e)if(at(e[i])||at(t[i])){const s=Fn.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[s]=e[i]}return n}const qE={useVisualState:Ih({scrapeMotionValuesFromProps:Lh,createRenderState:Rh})};function YE(e,t){return function(n,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...Wo(n)?qE:XE,preloadedFeatures:e,useRender:GE(i),createVisualElement:t,Component:n};return PE(a)}}function pi(e,t,r){const n=e.getProps();return Ho(n,t,r!==void 0?r:n.custom,e)}const Da=e=>Array.isArray(e);function JE(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,ui(r))}function ZE(e){return Da(e)?e[e.length-1]||0:e}function QE(e,t){const r=pi(e,t);let{transitionEnd:n={},transition:i={},...s}=r||{};s={...s,...n};for(const a in s){const o=ZE(s[a]);JE(e,a,o)}}function eS(e){return!!(at(e)&&e.add)}function Ia(e,t){const r=e.getValue("willChange");if(eS(r))return r.add(t);if(!r&&ir.WillChange){const n=new ir.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function Mh(e){return e.props[Ch]}const tS=e=>e!==null;function rS(e,{repeat:t,repeatType:r="loop"},n){const i=e.filter(tS),s=t&&r!=="loop"&&t%2===1?0:i.length-1;return i[s]}const nS={type:"spring",stiffness:500,damping:25,restSpeed:10},iS=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),sS={type:"keyframes",duration:.8},aS={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},oS=(e,{keyframes:t})=>t.length>2?sS:kn.has(e)?e.startsWith("scale")?iS(t[1]):nS:aS;function lS({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...f}){return!!Object.keys(f).length}const Ko=(e,t,r,n={},i,s)=>a=>{const o=Io(n,e)||{},l=o.delay||n.delay||0;let{elapsed:c=0}=n;c=c-Wt(l);const f={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:s?void 0:i};lS(o)||Object.assign(f,oS(e,f)),f.duration&&(f.duration=Wt(f.duration)),f.repeatDelay&&(f.repeatDelay=Wt(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let u=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f.duration=0,f.delay===0&&(u=!0)),(ir.instantAnimations||ir.skipAnimations)&&(u=!0,f.duration=0,f.delay=0),f.allowFlatten=!o.type&&!o.ease,u&&!s&&t.get()!==void 0){const h=rS(f.keyframes,o);if(h!==void 0){Le.update(()=>{f.onUpdate(h),f.onComplete()});return}}return new zT(f)};function cS({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function Nh(e,t,{delay:r=0,transitionOverride:n,type:i}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:a,...o}=t;n&&(s=n);const l=[],c=i&&e.animationState&&e.animationState.getState()[i];for(const f in o){const u=e.getValue(f,e.latestValues[f]??null),h=o[f];if(h===void 0||c&&cS(c,f))continue;const d={delay:r,...Io(s||{},f)},m=u.get();if(m!==void 0&&!u.isAnimating&&!Array.isArray(h)&&h===m&&!d.velocity)continue;let p=!1;if(window.MotionHandoffAnimation){const S=Mh(e);if(S){const A=window.MotionHandoffAnimation(S,f,Le);A!==null&&(d.startTime=A,p=!0)}}Ia(e,f),u.start(Ko(f,u,h,e.shouldReduceMotion&&ph.has(f)?{type:!1}:d,e,p));const g=u.animation;g&&l.push(g)}return a&&Promise.all(l).then(()=>{Le.update(()=>{a&&QE(e,a)})}),l}function La(e,t,r={}){var l;const n=pi(e,t,r.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(i=r.transitionOverride);const s=n?()=>Promise.all(Nh(e,n,r)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:f=0,staggerChildren:u,staggerDirection:h}=i;return fS(e,t,f+c,u,h,r)}:()=>Promise.resolve(),{when:o}=i;if(o){const[c,f]=o==="beforeChildren"?[s,a]:[a,s];return c().then(()=>f())}else return Promise.all([s(),a(r.delay)])}function fS(e,t,r=0,n=0,i=1,s){const a=[],o=(e.variantChildren.size-1)*n,l=i===1?(c=0)=>c*n:(c=0)=>o-c*n;return Array.from(e.variantChildren).sort(uS).forEach((c,f)=>{c.notify("AnimationStart",t),a.push(La(c,t,{...s,delay:r+l(f)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function uS(e,t){return e.sortNodePosition(t)}function hS(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const i=t.map(s=>La(e,s,r));n=Promise.all(i)}else if(typeof t=="string")n=La(e,t,r);else{const i=typeof t=="function"?pi(e,t,r.custom):t;n=Promise.all(Nh(e,i,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function Bh(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const dS=Uo.length;function Uh(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?Uh(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<dS;r++){const n=Uo[r],i=e.props[n];(hi(i)||i===!1)&&(t[n]=i)}return t}const pS=[...Bo].reverse(),mS=Bo.length;function gS(e){return t=>Promise.all(t.map(({animation:r,options:n})=>hS(e,r,n)))}function vS(e){let t=gS(e),r=Wc(),n=!0;const i=l=>(c,f)=>{var h;const u=pi(e,f,l==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(u){const{transition:d,transitionEnd:m,...p}=u;c={...c,...p,...m}}return c};function s(l){t=l(e)}function a(l){const{props:c}=e,f=Uh(e.parent)||{},u=[],h=new Set;let d={},m=1/0;for(let g=0;g<mS;g++){const S=pS[g],A=r[S],T=c[S]!==void 0?c[S]:f[S],k=hi(T),b=S===l?A.isActive:null;b===!1&&(m=g);let W=T===f[S]&&T!==c[S]&&k;if(W&&n&&e.manuallyAnimateOnMount&&(W=!1),A.protectedKeys={...d},!A.isActive&&b===null||!T&&!A.prevProp||ks(T)||typeof T=="boolean")continue;const F=xS(A.prevProp,T);let I=F||S===l&&A.isActive&&!W&&k||g>m&&k,R=!1;const V=Array.isArray(T)?T:[T];let H=V.reduce(i(S),{});b===!1&&(H={});const{prevResolvedValues:z={}}=A,te={...z,...H},_e=ee=>{I=!0,h.has(ee)&&(R=!0,h.delete(ee)),A.needsAnimating[ee]=!0;const oe=e.getValue(ee);oe&&(oe.liveStyle=!1)};for(const ee in te){const oe=H[ee],de=z[ee];if(d.hasOwnProperty(ee))continue;let xe=!1;Da(oe)&&Da(de)?xe=!Bh(oe,de):xe=oe!==de,xe?oe!=null?_e(ee):h.add(ee):oe!==void 0&&h.has(ee)?_e(ee):A.protectedKeys[ee]=!0}A.prevProp=T,A.prevResolvedValues=H,A.isActive&&(d={...d,...H}),n&&e.blockInitialAnimation&&(I=!1),I&&(!(W&&F)||R)&&u.push(...V.map(ee=>({animation:ee,options:{type:S}})))}if(h.size){const g={};if(typeof c.initial!="boolean"){const S=pi(e,Array.isArray(c.initial)?c.initial[0]:c.initial);S&&S.transition&&(g.transition=S.transition)}h.forEach(S=>{const A=e.getBaseTarget(S),T=e.getValue(S);T&&(T.liveStyle=!0),g[S]=A??null}),u.push({animation:g})}let p=!!u.length;return n&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(p=!1),n=!1,p?t(u):Promise.resolve()}function o(l,c){var u;if(r[l].isActive===c)return Promise.resolve();(u=e.variantChildren)==null||u.forEach(h=>{var d;return(d=h.animationState)==null?void 0:d.setActive(l,c)}),r[l].isActive=c;const f=a(l);for(const h in r)r[h].protectedKeys={};return f}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>r,reset:()=>{r=Wc(),n=!0}}}function xS(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Bh(t,e):!1}function Cr(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Wc(){return{animate:Cr(!0),whileInView:Cr(),whileHover:Cr(),whileTap:Cr(),whileDrag:Cr(),whileFocus:Cr(),exit:Cr()}}class wr{constructor(t){this.isMounted=!1,this.node=t}update(){}}class _S extends wr{constructor(t){super(t),t.animationState||(t.animationState=vS(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();ks(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let yS=0;class wS extends wr{constructor(){super(...arguments),this.id=yS++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const i=this.node.animationState.setActive("exit",!t);r&&!t&&i.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const TS={animation:{Feature:_S},exit:{Feature:wS}};function mi(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function Ci(e){return{point:{x:e.pageX,y:e.pageY}}}const ES=e=>t=>No(t)&&e(t,Ci(t));function Jn(e,t,r,n){return mi(e,t,ES(r),n)}function jh({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function SS({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function AS(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}const Vh=1e-4,CS=1-Vh,FS=1+Vh,$h=.01,kS=0-$h,PS=0+$h;function ht(e){return e.max-e.min}function OS(e,t,r){return Math.abs(e-t)<=r}function Hc(e,t,r,n=.5){e.origin=n,e.originPoint=Ie(t.min,t.max,e.origin),e.scale=ht(r)/ht(t),e.translate=Ie(r.min,r.max,e.origin)-e.originPoint,(e.scale>=CS&&e.scale<=FS||isNaN(e.scale))&&(e.scale=1),(e.translate>=kS&&e.translate<=PS||isNaN(e.translate))&&(e.translate=0)}function Zn(e,t,r,n){Hc(e.x,t.x,r.x,n?n.originX:void 0),Hc(e.y,t.y,r.y,n?n.originY:void 0)}function Gc(e,t,r){e.min=r.min+t.min,e.max=e.min+ht(t)}function bS(e,t,r){Gc(e.x,t.x,r.x),Gc(e.y,t.y,r.y)}function Kc(e,t,r){e.min=t.min-r.min,e.max=e.min+ht(t)}function Qn(e,t,r){Kc(e.x,t.x,r.x),Kc(e.y,t.y,r.y)}const zc=()=>({translate:0,scale:1,origin:0,originPoint:0}),ln=()=>({x:zc(),y:zc()}),Xc=()=>({min:0,max:0}),je=()=>({x:Xc(),y:Xc()});function kt(e){return[e("x"),e("y")]}function ra(e){return e===void 0||e===1}function Ma({scale:e,scaleX:t,scaleY:r}){return!ra(e)||!ra(t)||!ra(r)}function kr(e){return Ma(e)||Wh(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Wh(e){return qc(e.x)||qc(e.y)}function qc(e){return e&&e!=="0%"}function gs(e,t,r){const n=e-r,i=t*n;return r+i}function Yc(e,t,r,n,i){return i!==void 0&&(e=gs(e,i,n)),gs(e,r,n)+t}function Na(e,t=0,r=1,n,i){e.min=Yc(e.min,t,r,n,i),e.max=Yc(e.max,t,r,n,i)}function Hh(e,{x:t,y:r}){Na(e.x,t.translate,t.scale,t.originPoint),Na(e.y,r.translate,r.scale,r.originPoint)}const Jc=.999999999999,Zc=1.0000000000001;function RS(e,t,r,n=!1){const i=r.length;if(!i)return;t.x=t.y=1;let s,a;for(let o=0;o<i;o++){s=r[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&fn(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,Hh(e,a)),n&&kr(s.latestValues)&&fn(e,s.latestValues))}t.x<Zc&&t.x>Jc&&(t.x=1),t.y<Zc&&t.y>Jc&&(t.y=1)}function cn(e,t){e.min=e.min+t,e.max=e.max+t}function Qc(e,t,r,n,i=.5){const s=Ie(e.min,e.max,i);Na(e,t,r,s,n)}function fn(e,t){Qc(e.x,t.x,t.scaleX,t.scale,t.originX),Qc(e.y,t.y,t.scaleY,t.scale,t.originY)}function Gh(e,t){return jh(AS(e.getBoundingClientRect(),t))}function DS(e,t,r){const n=Gh(e,r),{scroll:i}=t;return i&&(cn(n.x,i.offset.x),cn(n.y,i.offset.y)),n}const Kh=({current:e})=>e?e.ownerDocument.defaultView:null,ef=(e,t)=>Math.abs(e-t);function IS(e,t){const r=ef(e.x,t.x),n=ef(e.y,t.y);return Math.sqrt(r**2+n**2)}class zh{constructor(t,r,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const u=ia(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,d=IS(u.offset,{x:0,y:0})>=3;if(!h&&!d)return;const{point:m}=u,{timestamp:p}=Ze;this.history.push({...m,timestamp:p});const{onStart:g,onMove:S}=this.handlers;h||(g&&g(this.lastMoveEvent,u),this.startEvent=this.lastMoveEvent),S&&S(this.lastMoveEvent,u)},this.handlePointerMove=(u,h)=>{this.lastMoveEvent=u,this.lastMoveEventInfo=na(h,this.transformPagePoint),Le.update(this.updatePoint,!0)},this.handlePointerUp=(u,h)=>{this.end();const{onEnd:d,onSessionEnd:m,resumeAnimation:p}=this.handlers;if(this.dragSnapToOrigin&&p&&p(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=ia(u.type==="pointercancel"?this.lastMoveEventInfo:na(h,this.transformPagePoint),this.history);this.startEvent&&d&&d(u,g),m&&m(u,g)},!No(t))return;this.dragSnapToOrigin=s,this.handlers=r,this.transformPagePoint=n,this.contextWindow=i||window;const a=Ci(t),o=na(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=Ze;this.history=[{...l,timestamp:c}];const{onSessionStart:f}=r;f&&f(t,ia(o,this.history)),this.removeListeners=Ei(Jn(this.contextWindow,"pointermove",this.handlePointerMove),Jn(this.contextWindow,"pointerup",this.handlePointerUp),Jn(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),vr(this.updatePoint)}}function na(e,t){return t?{point:t(e.point)}:e}function tf(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ia({point:e},t){return{point:e,delta:tf(e,Xh(t)),offset:tf(e,LS(t)),velocity:MS(t,.1)}}function LS(e){return e[0]}function Xh(e){return e[e.length-1]}function MS(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const i=Xh(e);for(;r>=0&&(n=e[r],!(i.timestamp-n.timestamp>Wt(t)));)r--;if(!n)return{x:0,y:0};const s=Ht(i.timestamp-n.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-n.x)/s,y:(i.y-n.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function NS(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?Ie(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?Ie(r,e,n.max):Math.min(e,r)),e}function rf(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function BS(e,{top:t,left:r,bottom:n,right:i}){return{x:rf(e.x,r,i),y:rf(e.y,t,n)}}function nf(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function US(e,t){return{x:nf(e.x,t.x),y:nf(e.y,t.y)}}function jS(e,t){let r=.5;const n=ht(e),i=ht(t);return i>n?r=li(t.min,t.max-n,e.min):n>i&&(r=li(e.min,e.max-i,t.min)),nr(0,1,r)}function VS(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Ba=.35;function $S(e=Ba){return e===!1?e=0:e===!0&&(e=Ba),{x:sf(e,"left","right"),y:sf(e,"top","bottom")}}function sf(e,t,r){return{min:af(e,t),max:af(e,r)}}function af(e,t){return typeof e=="number"?e:e[t]||0}const WS=new WeakMap;class HS{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=je(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=f=>{const{dragSnapToOrigin:u}=this.getProps();u?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Ci(f).point)},s=(f,u)=>{const{drag:h,dragPropagation:d,onDragStart:m}=this.getProps();if(h&&!d&&(this.openDragLock&&this.openDragLock(),this.openDragLock=oE(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),kt(g=>{let S=this.getAxisMotionValue(g).get()||0;if(Gt.test(S)){const{projection:A}=this.visualElement;if(A&&A.layout){const T=A.layout.layoutBox[g];T&&(S=ht(T)*(parseFloat(S)/100))}}this.originPoint[g]=S}),m&&Le.postRender(()=>m(f,u)),Ia(this.visualElement,"transform");const{animationState:p}=this.visualElement;p&&p.setActive("whileDrag",!0)},a=(f,u)=>{const{dragPropagation:h,dragDirectionLock:d,onDirectionLock:m,onDrag:p}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:g}=u;if(d&&this.currentDirection===null){this.currentDirection=GS(g),this.currentDirection!==null&&m&&m(this.currentDirection);return}this.updateAxis("x",u.point,g),this.updateAxis("y",u.point,g),this.visualElement.render(),p&&p(f,u)},o=(f,u)=>this.stop(f,u),l=()=>kt(f=>{var u;return this.getAnimationState(f)==="paused"&&((u=this.getAxisMotionValue(f).animation)==null?void 0:u.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new zh(t,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:Kh(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=r;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&Le.postRender(()=>s(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:i}=this.getProps();if(!n||!Ki(t,i,this.currentDirection))return;const s=this.getAxisMotionValue(t);let a=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(a=NS(a,this.constraints[t],this.elastic[t])),s.set(a)}resolveConstraints(){var s;const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,i=this.constraints;t&&on(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=BS(n.layoutBox,t):this.constraints=!1,this.elastic=$S(r),i!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&kt(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=VS(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!on(t))return!1;const n=t.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=DS(n,i.root,this.visualElement.getTransformPagePoint());let a=US(i.layout.layoutBox,s);if(r){const o=r(SS(a));this.hasMutatedConstraints=!!o,o&&(a=jh(o))}return a}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=kt(f=>{if(!Ki(f,r,this.currentDirection))return;let u=l&&l[f]||{};a&&(u={min:0,max:0});const h=i?200:1e6,d=i?40:1e7,m={type:"inertia",velocity:n?t[f]:0,bounceStiffness:h,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10,...s,...u};return this.startAxisValueAnimation(f,m)});return Promise.all(c).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return Ia(this.visualElement,t),n.start(Ko(t,n,0,r,this.visualElement,!1))}stopAnimation(){kt(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){kt(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),i=n[r];return i||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){kt(r=>{const{drag:n}=this.getProps();if(!Ki(r,n,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(r);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[r];s.set(t[r]-Ie(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!on(r)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};kt(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=jS({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),kt(a=>{if(!Ki(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(Ie(l,c,i[a]))})}addListeners(){if(!this.visualElement.current)return;WS.set(this.visualElement,this);const t=this.visualElement.current,r=Jn(t,"pointerdown",l=>{const{drag:c,dragListener:f=!0}=this.getProps();c&&f&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();on(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Le.read(n);const a=mi(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(kt(f=>{const u=this.getAxisMotionValue(f);u&&(this.originPoint[f]+=l[f].translate,u.set(u.get()+l[f].translate))}),this.visualElement.render())});return()=>{a(),r(),s(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=Ba,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function Ki(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function GS(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class KS extends wr{constructor(t){super(t),this.removeGroupControls=Ot,this.removeListeners=Ot,this.controls=new HS(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ot}unmount(){this.removeGroupControls(),this.removeListeners()}}const of=e=>(t,r)=>{e&&Le.postRender(()=>e(t,r))};class zS extends wr{constructor(){super(...arguments),this.removePointerDownListener=Ot}onPointerDown(t){this.session=new zh(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Kh(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:of(t),onStart:of(r),onMove:n,onEnd:(s,a)=>{delete this.session,i&&Le.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=Jn(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Yi={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function lf(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Ln={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ue.test(e))e=parseFloat(e);else return e;const r=lf(e,t.target.x),n=lf(e,t.target.y);return`${r}% ${n}%`}},XS={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,i=xr.parse(e);if(i.length>5)return n;const s=xr.createTransformer(e),a=typeof i[0]!="number"?1:0,o=r.x.scale*t.x,l=r.y.scale*t.y;i[0+a]/=o,i[1+a]/=l;const c=Ie(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=c),typeof i[3+a]=="number"&&(i[3+a]/=c),s(i)}};class qS extends le.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:i}=this.props,{projection:s}=t;DE(YS),s&&(r.group&&r.group.add(s),n&&n.register&&i&&n.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Yi.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:i,isPresent:s}=this.props,a=n.projection;return a&&(a.isPresent=s,i||t.layoutDependency!==r||r===void 0||t.isPresent!==s?a.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?a.promote():a.relegate()||Le.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Mo.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:i}=t;i&&(i.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function qh(e){const[t,r]=Iu(),n=le.useContext(po);return Jt.jsx(qS,{...e,layoutGroup:n,switchLayoutGroup:le.useContext(Fh),isPresent:t,safeToRemove:r})}const YS={borderRadius:{...Ln,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ln,borderTopRightRadius:Ln,borderBottomLeftRadius:Ln,borderBottomRightRadius:Ln,boxShadow:XS};function JS(e,t,r){const n=at(e)?e:ui(e);return n.start(Ko("",n,t,r)),n.animation}function ZS(e){return e instanceof SVGElement&&e.tagName!=="svg"}const QS=(e,t)=>e.depth-t.depth;class eA{constructor(){this.children=[],this.isDirty=!1}add(t){xo(this.children,t),this.isDirty=!0}remove(t){_o(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(QS),this.isDirty=!1,this.children.forEach(t)}}function tA(e,t){const r=mt.now(),n=({timestamp:i})=>{const s=i-r;s>=t&&(vr(n),e(s-t))};return Le.setup(n,!0),()=>vr(n)}const Yh=["TopLeft","TopRight","BottomLeft","BottomRight"],rA=Yh.length,cf=e=>typeof e=="string"?parseFloat(e):e,ff=e=>typeof e=="number"||ue.test(e);function nA(e,t,r,n,i,s){i?(e.opacity=Ie(0,r.opacity??1,iA(n)),e.opacityExit=Ie(t.opacity??1,0,sA(n))):s&&(e.opacity=Ie(t.opacity??1,r.opacity??1,n));for(let a=0;a<rA;a++){const o=`border${Yh[a]}Radius`;let l=uf(t,o),c=uf(r,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||ff(l)===ff(c)?(e[o]=Math.max(Ie(cf(l),cf(c),n),0),(Gt.test(c)||Gt.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||r.rotate)&&(e.rotate=Ie(t.rotate||0,r.rotate||0,n))}function uf(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const iA=Jh(0,.5,Hu),sA=Jh(.5,.95,Ot);function Jh(e,t,r){return n=>n<e?0:n>t?1:r(li(e,t,n))}function hf(e,t){e.min=t.min,e.max=t.max}function Ct(e,t){hf(e.x,t.x),hf(e.y,t.y)}function df(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function pf(e,t,r,n,i){return e-=t,e=gs(e,1/r,n),i!==void 0&&(e=gs(e,1/i,n)),e}function aA(e,t=0,r=1,n=.5,i,s=e,a=e){if(Gt.test(t)&&(t=parseFloat(t),t=Ie(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=Ie(s.min,s.max,n);e===s&&(o-=t),e.min=pf(e.min,t,r,o,i),e.max=pf(e.max,t,r,o,i)}function mf(e,t,[r,n,i],s,a){aA(e,t[r],t[n],t[i],t.scale,s,a)}const oA=["x","scaleX","originX"],lA=["y","scaleY","originY"];function gf(e,t,r,n){mf(e.x,t,oA,r?r.x:void 0,n?n.x:void 0),mf(e.y,t,lA,r?r.y:void 0,n?n.y:void 0)}function vf(e){return e.translate===0&&e.scale===1}function Zh(e){return vf(e.x)&&vf(e.y)}function xf(e,t){return e.min===t.min&&e.max===t.max}function cA(e,t){return xf(e.x,t.x)&&xf(e.y,t.y)}function _f(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Qh(e,t){return _f(e.x,t.x)&&_f(e.y,t.y)}function yf(e){return ht(e.x)/ht(e.y)}function wf(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class fA{constructor(){this.members=[]}add(t){xo(this.members,t),t.scheduleRender()}remove(t){if(_o(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(i=>t===i);if(r===0)return!1;let n;for(let i=r;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:i}=t.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function uA(e,t,r){let n="";const i=e.x.translate/t.x,s=e.y.translate/t.y,a=(r==null?void 0:r.z)||0;if((i||s||a)&&(n=`translate3d(${i}px, ${s}px, ${a}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:c,rotate:f,rotateX:u,rotateY:h,skewX:d,skewY:m}=r;c&&(n=`perspective(${c}px) ${n}`),f&&(n+=`rotate(${f}deg) `),u&&(n+=`rotateX(${u}deg) `),h&&(n+=`rotateY(${h}deg) `),d&&(n+=`skewX(${d}deg) `),m&&(n+=`skewY(${m}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(n+=`scale(${o}, ${l})`),n||"none"}const sa=["","X","Y","Z"],hA={visibility:"hidden"},Tf=1e3;let dA=0;function aa(e,t,r,n){const{latestValues:i}=t;i[e]&&(r[e]=i[e],t.setStaticValue(e,0),n&&(n[e]=0))}function ed(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=Mh(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:i,layoutId:s}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Le,!(i||s))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&ed(n)}function td({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(a={},o=t==null?void 0:t()){this.id=dA++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(gA),this.nodes.forEach(wA),this.nodes.forEach(TA),this.nodes.forEach(vA)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new eA)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new To),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=ZS(a),this.instance=a;const{layoutId:l,layout:c,visualElement:f}=this.options;if(f&&!f.current&&f.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),e){let u;const h=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=tA(h,250),Yi.hasAnimatedSinceResize&&(Yi.hasAnimatedSinceResize=!1,this.nodes.forEach(Sf))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&f&&(l||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:d,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||f.getDefaultTransition()||FA,{onLayoutAnimationStart:g,onLayoutAnimationComplete:S}=f.getProps(),A=!this.targetLayout||!Qh(this.targetLayout,m),T=!h&&d;if(this.options.layoutRoot||this.resumeFrom||T||h&&(A||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,T);const k={...Io(p,"layout"),onPlay:g,onComplete:S};(f.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k)}else h||Sf(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),vr(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(EA),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&ed(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const u=this.path[f];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ef);return}this.isUpdating||this.nodes.forEach(_A),this.isUpdating=!1,this.nodes.forEach(yA),this.nodes.forEach(pA),this.nodes.forEach(mA),this.clearAllSnapshots();const o=mt.now();Ze.delta=nr(0,1e3/60,o-Ze.timestamp),Ze.timestamp=o,Ze.isProcessing=!0,Js.update.process(Ze),Js.preRender.process(Ze),Js.render.process(Ze),Ze.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Mo.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(xA),this.sharedNodes.forEach(SA)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Le.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Le.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ht(this.snapshot.measuredBox.x)&&!ht(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=je(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!Zh(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,f=c!==this.prevTransformTemplateValue;a&&(o||kr(this.latestValues)||f)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),kA(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return je();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(PA))){const{scroll:f}=this.root;f&&(cn(o.x,f.offset.x),cn(o.y,f.offset.y))}return o}removeElementScroll(a){var l;const o=je();if(Ct(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const f=this.path[c],{scroll:u,options:h}=f;f!==this.root&&u&&h.layoutScroll&&(u.wasRoot&&Ct(o,a),cn(o.x,u.offset.x),cn(o.y,u.offset.y))}return o}applyTransform(a,o=!1){const l=je();Ct(l,a);for(let c=0;c<this.path.length;c++){const f=this.path[c];!o&&f.options.layoutScroll&&f.scroll&&f!==f.root&&fn(l,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),kr(f.latestValues)&&fn(l,f.latestValues)}return kr(this.latestValues)&&fn(l,this.latestValues),l}removeTransform(a){const o=je();Ct(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!kr(c.latestValues))continue;Ma(c.latestValues)&&c.updateSnapshot();const f=je(),u=c.measurePageBox();Ct(f,u),gf(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,f)}return kr(this.latestValues)&&gf(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ze.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:u}=this.options;if(!(!this.layout||!(f||u))){if(this.resolvedRelativeTargetAt=Ze.timestamp,!this.targetDelta&&!this.relativeTarget){const d=this.getClosestProjectingParent();d&&d.layout&&this.animationProgress!==1?(this.relativeParent=d,this.forceRelativeParentToResolveTarget(),this.relativeTarget=je(),this.relativeTargetOrigin=je(),Qn(this.relativeTargetOrigin,this.layout.layoutBox,d.layout.layoutBox),Ct(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=je(),this.targetWithTransforms=je()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),bS(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ct(this.target,this.layout.layoutBox),Hh(this.target,this.targetDelta)):Ct(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const d=this.getClosestProjectingParent();d&&!!d.resumingFrom==!!this.resumingFrom&&!d.options.layoutScroll&&d.target&&this.animationProgress!==1?(this.relativeParent=d,this.forceRelativeParentToResolveTarget(),this.relativeTarget=je(),this.relativeTargetOrigin=je(),Qn(this.relativeTargetOrigin,this.target,d.target),Ct(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Ma(this.parent.latestValues)||Wh(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var m;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Ze.timestamp&&(l=!1),l)return;const{layout:c,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||f))return;Ct(this.layoutCorrected,this.layout.layoutBox);const u=this.treeScale.x,h=this.treeScale.y;RS(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=je());const{target:d}=a;if(!d){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(df(this.prevProjectionDelta.x,this.projectionDelta.x),df(this.prevProjectionDelta.y,this.projectionDelta.y)),Zn(this.projectionDelta,this.layoutCorrected,d,this.latestValues),(this.treeScale.x!==u||this.treeScale.y!==h||!wf(this.projectionDelta.x,this.prevProjectionDelta.x)||!wf(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",d))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ln(),this.projectionDelta=ln(),this.projectionDeltaWithTransform=ln()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},f={...this.latestValues},u=ln();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=je(),d=l?l.source:void 0,m=this.layout?this.layout.source:void 0,p=d!==m,g=this.getStack(),S=!g||g.members.length<=1,A=!!(p&&!S&&this.options.crossfade===!0&&!this.path.some(CA));this.animationProgress=0;let T;this.mixTargetDelta=k=>{const b=k/1e3;Af(u.x,a.x,b),Af(u.y,a.y,b),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Qn(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),AA(this.relativeTarget,this.relativeTargetOrigin,h,b),T&&cA(this.relativeTarget,T)&&(this.isProjectionDirty=!1),T||(T=je()),Ct(T,this.relativeTarget)),p&&(this.animationValues=f,nA(f,c,this.latestValues,b,A,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=b},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(vr(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Le.update(()=>{Yi.hasAnimatedSinceResize=!0,this.currentAnimation=JS(0,Tf,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Tf),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:f}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&rd(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||je();const u=ht(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+u;const h=ht(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}Ct(o,l),fn(o,f),Zn(this.projectionDeltaWithTransform,this.layoutCorrected,o,f)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new fA),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&aa("z",a,c,this.animationValues);for(let f=0;f<sa.length;f++)aa(`rotate${sa[f]}`,a,c,this.animationValues),aa(`skew${sa[f]}`,a,c,this.animationValues);a.render();for(const f in c)a.setStaticValue(f,c[f]),this.animationValues&&(this.animationValues[f]=c[f]);a.scheduleRender()}getProjectionStyles(a){if(!this.instance||this.isSVG)return;if(!this.isVisible)return hA;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=qi(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const d={};return this.options.layoutId&&(d.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,d.pointerEvents=qi(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!kr(this.latestValues)&&(d.transform=l?l({},""):"none",this.hasProjected=!1),d}const f=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=uA(this.projectionDeltaWithTransform,this.treeScale,f),l&&(o.transform=l(f,o.transform));const{x:u,y:h}=this.projectionDelta;o.transformOrigin=`${u.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?f.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:o.opacity=c===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const d in di){if(f[d]===void 0)continue;const{correct:m,applyTo:p,isCSSVariable:g}=di[d],S=o.transform==="none"?f[d]:m(f[d],c);if(p){const A=p.length;for(let T=0;T<A;T++)o[p[T]]=S}else g?this.options.visualElement.renderState.vars[d]=S:o[d]=S}return this.options.layoutId&&(o.pointerEvents=c===this?qi(a==null?void 0:a.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(Ef),this.root.sharedNodes.clear()}}}function pA(e){e.updateLayout()}function mA(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=e.layout,{animationType:s}=e.options,a=t.source!==e.layout.source;s==="size"?kt(u=>{const h=a?t.measuredBox[u]:t.layoutBox[u],d=ht(h);h.min=n[u].min,h.max=h.min+d}):rd(s,t.layoutBox,n)&&kt(u=>{const h=a?t.measuredBox[u]:t.layoutBox[u],d=ht(n[u]);h.max=h.min+d,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[u].max=e.relativeTarget[u].min+d)});const o=ln();Zn(o,n,t.layoutBox);const l=ln();a?Zn(l,e.applyTransform(i,!0),t.measuredBox):Zn(l,n,t.layoutBox);const c=!Zh(o);let f=!1;if(!e.resumeFrom){const u=e.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:h,layout:d}=u;if(h&&d){const m=je();Qn(m,t.layoutBox,h.layoutBox);const p=je();Qn(p,n,d.layoutBox),Qh(m,p)||(f=!0),u.options.layoutRoot&&(e.relativeTarget=p,e.relativeTargetOrigin=m,e.relativeParent=u)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:f})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function gA(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function vA(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function xA(e){e.clearSnapshot()}function Ef(e){e.clearMeasurements()}function _A(e){e.isLayoutDirty=!1}function yA(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Sf(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function wA(e){e.resolveTargetDelta()}function TA(e){e.calcProjection()}function EA(e){e.resetSkewAndRotation()}function SA(e){e.removeLeadSnapshot()}function Af(e,t,r){e.translate=Ie(t.translate,0,r),e.scale=Ie(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Cf(e,t,r,n){e.min=Ie(t.min,r.min,n),e.max=Ie(t.max,r.max,n)}function AA(e,t,r,n){Cf(e.x,t.x,r.x,n),Cf(e.y,t.y,r.y,n)}function CA(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const FA={duration:.45,ease:[.4,0,.1,1]},Ff=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),kf=Ff("applewebkit/")&&!Ff("chrome/")?Math.round:Ot;function Pf(e){e.min=kf(e.min),e.max=kf(e.max)}function kA(e){Pf(e.x),Pf(e.y)}function rd(e,t,r){return e==="position"||e==="preserve-aspect"&&!OS(yf(t),yf(r),.2)}function PA(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const OA=td({attachResizeListener:(e,t)=>mi(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),oa={current:void 0},nd=td({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!oa.current){const e=new OA({});e.mount(window),e.setOptions({layoutScroll:!0}),oa.current=e}return oa.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),bA={pan:{Feature:zS},drag:{Feature:KS,ProjectionNode:nd,MeasureLayout:qh}};function Of(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const i="onHover"+r,s=n[i];s&&Le.postRender(()=>s(t,Ci(t)))}class RA extends wr{mount(){const{current:t}=this.node;t&&(this.unmount=lE(t,(r,n)=>(Of(this.node,n,"Start"),i=>Of(this.node,i,"End"))))}unmount(){}}class DA extends wr{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ei(mi(this.node.current,"focus",()=>this.onFocus()),mi(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function bf(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const i="onTap"+(r==="End"?"":r),s=n[i];s&&Le.postRender(()=>s(t,Ci(t)))}class IA extends wr{mount(){const{current:t}=this.node;t&&(this.unmount=hE(t,(r,n)=>(bf(this.node,n,"Start"),(i,{success:s})=>bf(this.node,i,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Ua=new WeakMap,la=new WeakMap,LA=e=>{const t=Ua.get(e.target);t&&t(e)},MA=e=>{e.forEach(LA)};function NA({root:e,...t}){const r=e||document;la.has(r)||la.set(r,{});const n=la.get(r),i=JSON.stringify(t);return n[i]||(n[i]=new IntersectionObserver(MA,{root:e,...t})),n[i]}function BA(e,t,r){const n=NA(t);return Ua.set(e,r),n.observe(e),()=>{Ua.delete(e),n.unobserve(e)}}const UA={some:0,all:1};class jA extends wr{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:i="some",once:s}=t,a={root:r?r.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:UA[i]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:f,onViewportLeave:u}=this.node.getProps(),h=c?f:u;h&&h(l)};return BA(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(VA(t,r))&&this.startObserver()}unmount(){}}function VA({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const $A={inView:{Feature:jA},tap:{Feature:IA},focus:{Feature:DA},hover:{Feature:RA}},WA={layout:{ProjectionNode:nd,MeasureLayout:qh}},ja={current:null},id={current:!1};function HA(){if(id.current=!0,!!go)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>ja.current=e.matches;e.addListener(t),t()}else ja.current=!1}const GA=new WeakMap;function KA(e,t,r){for(const n in t){const i=t[n],s=r[n];if(at(i))e.addValue(n,i);else if(at(s))e.addValue(n,ui(i,{owner:e}));else if(s!==i)if(e.hasValue(n)){const a=e.getValue(n);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=e.getStaticValue(n);e.addValue(n,ui(a!==void 0?a:i,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const Rf=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class zA{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Do,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=mt.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,Le.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=Ps(r),this.isVariantNode=Ah(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:f,...u}=this.scrapeMotionValuesFromProps(r,{},this);for(const h in u){const d=u[h];l[h]!==void 0&&at(d)&&d.set(l[h],!1)}}mount(t){this.current=t,GA.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),id.current||HA(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:ja.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),this.projection=void 0,vr(this.notifyUpdate),vr(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=kn.has(t);n&&this.onBindTransform&&this.onBindTransform();const i=r.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&Le.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),s=r.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{i(),s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in yn){const r=yn[t];if(!r)continue;const{isEnabled:n,Feature:i}=r;if(!this.features[t]&&i&&n(this.props)&&(this.features[t]=new i(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):je()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<Rf.length;n++){const i=Rf[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=t[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=KA(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=ui(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(Lu(n)||Mu(n))?n=parseFloat(n):!gE(n)&&xr.test(r)&&(n=xh(t,r)),this.setBaseTarget(t,at(n)?n.get():n)),at(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var s;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=Ho(this.props,r,(s=this.presenceContext)==null?void 0:s.custom);a&&(n=a[t])}if(r&&n!==void 0)return n;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!at(i)?i:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new To),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class sd extends zA{constructor(){super(...arguments),this.KeyframeResolver=sE}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;at(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function ad(e,{style:t,vars:r},n,i){Object.assign(e.style,t,i&&i.getProjectionStyles(n));for(const s in r)e.style.setProperty(s,r[s])}function XA(e){return window.getComputedStyle(e)}class qA extends sd{constructor(){super(...arguments),this.type="html",this.renderInstance=ad}readValueFromInstance(t,r){if(kn.has(r))return ST(t,r);{const n=XA(t),i=(Ao(r)?n.getPropertyValue(r):n[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:r}){return Gh(t,r)}build(t,r,n){Vo(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return Go(t,r,n)}}const od=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function YA(e,t,r,n){ad(e,t,void 0,n);for(const i in t.attrs)e.setAttribute(od.has(i)?i:jo(i),t.attrs[i])}class JA extends sd{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=je}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(kn.has(r)){const n=vh(r);return n&&n.default||0}return r=od.has(r)?r:jo(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return Lh(t,r,n)}build(t,r,n){bh(t,r,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,n,i){YA(t,r,n,i)}mount(t){this.isSVGTag=Dh(t.tagName),super.mount(t)}}const ZA=(e,t)=>Wo(e)?new JA(t):new qA(t,{allowProjection:e!==le.Fragment}),QA=YE({...TS,...$A,...bA,...WA},ZA),g4=wE(QA);var ca,Df;function e4(){return Df||(Df=1,ca=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}),ca}var t4=e4();const r4=If(t4),n4=Object.freeze(Object.defineProperty({__proto__:null,default:r4},Symbol.toStringTag,{value:"Module"}));export{p4 as A,d4 as F,u4 as c,If as g,g4 as m,s4 as r,h4 as u,n2 as w};
